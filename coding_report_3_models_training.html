<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />

<title>temp-160925670874324111</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>



<style type="text/css">
    /*!
*
* Twitter Bootstrap
*
*/
/*!
 * Bootstrap v3.3.7 (http://getbootstrap.com)
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */
/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */
html {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
}
body {
  margin: 0;
}
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
menu,
nav,
section,
summary {
  display: block;
}
audio,
canvas,
progress,
video {
  display: inline-block;
  vertical-align: baseline;
}
audio:not([controls]) {
  display: none;
  height: 0;
}
[hidden],
template {
  display: none;
}
a {
  background-color: transparent;
}
a:active,
a:hover {
  outline: 0;
}
abbr[title] {
  border-bottom: 1px dotted;
}
b,
strong {
  font-weight: bold;
}
dfn {
  font-style: italic;
}
h1 {
  font-size: 2em;
  margin: 0.67em 0;
}
mark {
  background: #ff0;
  color: #000;
}
small {
  font-size: 80%;
}
sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sup {
  top: -0.5em;
}
sub {
  bottom: -0.25em;
}
img {
  border: 0;
}
svg:not(:root) {
  overflow: hidden;
}
figure {
  margin: 1em 40px;
}
hr {
  box-sizing: content-box;
  height: 0;
}
pre {
  overflow: auto;
}
code,
kbd,
pre,
samp {
  font-family: monospace, monospace;
  font-size: 1em;
}
button,
input,
optgroup,
select,
textarea {
  color: inherit;
  font: inherit;
  margin: 0;
}
button {
  overflow: visible;
}
button,
select {
  text-transform: none;
}
button,
html input[type="button"],
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button;
  cursor: pointer;
}
button[disabled],
html input[disabled] {
  cursor: default;
}
button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}
input {
  line-height: normal;
}
input[type="checkbox"],
input[type="radio"] {
  box-sizing: border-box;
  padding: 0;
}
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: textfield;
  box-sizing: content-box;
}
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}
fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}
legend {
  border: 0;
  padding: 0;
}
textarea {
  overflow: auto;
}
optgroup {
  font-weight: bold;
}
table {
  border-collapse: collapse;
  border-spacing: 0;
}
td,
th {
  padding: 0;
}
/*! Source: https://github.com/h5bp/html5-boilerplate/blob/master/src/css/main.css */
@media print {
  *,
  *:before,
  *:after {
    background: transparent !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }
  a,
  a:visited {
    text-decoration: underline;
  }
  a[href]:after {
    content: " (" attr(href) ")";
  }
  abbr[title]:after {
    content: " (" attr(title) ")";
  }
  a[href^="#"]:after,
  a[href^="javascript:"]:after {
    content: "";
  }
  pre,
  blockquote {
    border: 1px solid #999;
    page-break-inside: avoid;
  }
  thead {
    display: table-header-group;
  }
  tr,
  img {
    page-break-inside: avoid;
  }
  img {
    max-width: 100% !important;
  }
  p,
  h2,
  h3 {
    orphans: 3;
    widows: 3;
  }
  h2,
  h3 {
    page-break-after: avoid;
  }
  .navbar {
    display: none;
  }
  .btn > .caret,
  .dropup > .btn > .caret {
    border-top-color: #000 !important;
  }
  .label {
    border: 1px solid #000;
  }
  .table {
    border-collapse: collapse !important;
  }
  .table td,
  .table th {
    background-color: #fff !important;
  }
  .table-bordered th,
  .table-bordered td {
    border: 1px solid #ddd !important;
  }
}
@font-face {
  font-family: 'Glyphicons Halflings';
  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot');
  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot?#iefix') format('embedded-opentype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff2') format('woff2'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff') format('woff'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.ttf') format('truetype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular') format('svg');
}
.glyphicon {
  position: relative;
  top: 1px;
  display: inline-block;
  font-family: 'Glyphicons Halflings';
  font-style: normal;
  font-weight: normal;
  line-height: 1;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
.glyphicon-asterisk:before {
  content: "\002a";
}
.glyphicon-plus:before {
  content: "\002b";
}
.glyphicon-euro:before,
.glyphicon-eur:before {
  content: "\20ac";
}
.glyphicon-minus:before {
  content: "\2212";
}
.glyphicon-cloud:before {
  content: "\2601";
}
.glyphicon-envelope:before {
  content: "\2709";
}
.glyphicon-pencil:before {
  content: "\270f";
}
.glyphicon-glass:before {
  content: "\e001";
}
.glyphicon-music:before {
  content: "\e002";
}
.glyphicon-search:before {
  content: "\e003";
}
.glyphicon-heart:before {
  content: "\e005";
}
.glyphicon-star:before {
  content: "\e006";
}
.glyphicon-star-empty:before {
  content: "\e007";
}
.glyphicon-user:before {
  content: "\e008";
}
.glyphicon-film:before {
  content: "\e009";
}
.glyphicon-th-large:before {
  content: "\e010";
}
.glyphicon-th:before {
  content: "\e011";
}
.glyphicon-th-list:before {
  content: "\e012";
}
.glyphicon-ok:before {
  content: "\e013";
}
.glyphicon-remove:before {
  content: "\e014";
}
.glyphicon-zoom-in:before {
  content: "\e015";
}
.glyphicon-zoom-out:before {
  content: "\e016";
}
.glyphicon-off:before {
  content: "\e017";
}
.glyphicon-signal:before {
  content: "\e018";
}
.glyphicon-cog:before {
  content: "\e019";
}
.glyphicon-trash:before {
  content: "\e020";
}
.glyphicon-home:before {
  content: "\e021";
}
.glyphicon-file:before {
  content: "\e022";
}
.glyphicon-time:before {
  content: "\e023";
}
.glyphicon-road:before {
  content: "\e024";
}
.glyphicon-download-alt:before {
  content: "\e025";
}
.glyphicon-download:before {
  content: "\e026";
}
.glyphicon-upload:before {
  content: "\e027";
}
.glyphicon-inbox:before {
  content: "\e028";
}
.glyphicon-play-circle:before {
  content: "\e029";
}
.glyphicon-repeat:before {
  content: "\e030";
}
.glyphicon-refresh:before {
  content: "\e031";
}
.glyphicon-list-alt:before {
  content: "\e032";
}
.glyphicon-lock:before {
  content: "\e033";
}
.glyphicon-flag:before {
  content: "\e034";
}
.glyphicon-headphones:before {
  content: "\e035";
}
.glyphicon-volume-off:before {
  content: "\e036";
}
.glyphicon-volume-down:before {
  content: "\e037";
}
.glyphicon-volume-up:before {
  content: "\e038";
}
.glyphicon-qrcode:before {
  content: "\e039";
}
.glyphicon-barcode:before {
  content: "\e040";
}
.glyphicon-tag:before {
  content: "\e041";
}
.glyphicon-tags:before {
  content: "\e042";
}
.glyphicon-book:before {
  content: "\e043";
}
.glyphicon-bookmark:before {
  content: "\e044";
}
.glyphicon-print:before {
  content: "\e045";
}
.glyphicon-camera:before {
  content: "\e046";
}
.glyphicon-font:before {
  content: "\e047";
}
.glyphicon-bold:before {
  content: "\e048";
}
.glyphicon-italic:before {
  content: "\e049";
}
.glyphicon-text-height:before {
  content: "\e050";
}
.glyphicon-text-width:before {
  content: "\e051";
}
.glyphicon-align-left:before {
  content: "\e052";
}
.glyphicon-align-center:before {
  content: "\e053";
}
.glyphicon-align-right:before {
  content: "\e054";
}
.glyphicon-align-justify:before {
  content: "\e055";
}
.glyphicon-list:before {
  content: "\e056";
}
.glyphicon-indent-left:before {
  content: "\e057";
}
.glyphicon-indent-right:before {
  content: "\e058";
}
.glyphicon-facetime-video:before {
  content: "\e059";
}
.glyphicon-picture:before {
  content: "\e060";
}
.glyphicon-map-marker:before {
  content: "\e062";
}
.glyphicon-adjust:before {
  content: "\e063";
}
.glyphicon-tint:before {
  content: "\e064";
}
.glyphicon-edit:before {
  content: "\e065";
}
.glyphicon-share:before {
  content: "\e066";
}
.glyphicon-check:before {
  content: "\e067";
}
.glyphicon-move:before {
  content: "\e068";
}
.glyphicon-step-backward:before {
  content: "\e069";
}
.glyphicon-fast-backward:before {
  content: "\e070";
}
.glyphicon-backward:before {
  content: "\e071";
}
.glyphicon-play:before {
  content: "\e072";
}
.glyphicon-pause:before {
  content: "\e073";
}
.glyphicon-stop:before {
  content: "\e074";
}
.glyphicon-forward:before {
  content: "\e075";
}
.glyphicon-fast-forward:before {
  content: "\e076";
}
.glyphicon-step-forward:before {
  content: "\e077";
}
.glyphicon-eject:before {
  content: "\e078";
}
.glyphicon-chevron-left:before {
  content: "\e079";
}
.glyphicon-chevron-right:before {
  content: "\e080";
}
.glyphicon-plus-sign:before {
  content: "\e081";
}
.glyphicon-minus-sign:before {
  content: "\e082";
}
.glyphicon-remove-sign:before {
  content: "\e083";
}
.glyphicon-ok-sign:before {
  content: "\e084";
}
.glyphicon-question-sign:before {
  content: "\e085";
}
.glyphicon-info-sign:before {
  content: "\e086";
}
.glyphicon-screenshot:before {
  content: "\e087";
}
.glyphicon-remove-circle:before {
  content: "\e088";
}
.glyphicon-ok-circle:before {
  content: "\e089";
}
.glyphicon-ban-circle:before {
  content: "\e090";
}
.glyphicon-arrow-left:before {
  content: "\e091";
}
.glyphicon-arrow-right:before {
  content: "\e092";
}
.glyphicon-arrow-up:before {
  content: "\e093";
}
.glyphicon-arrow-down:before {
  content: "\e094";
}
.glyphicon-share-alt:before {
  content: "\e095";
}
.glyphicon-resize-full:before {
  content: "\e096";
}
.glyphicon-resize-small:before {
  content: "\e097";
}
.glyphicon-exclamation-sign:before {
  content: "\e101";
}
.glyphicon-gift:before {
  content: "\e102";
}
.glyphicon-leaf:before {
  content: "\e103";
}
.glyphicon-fire:before {
  content: "\e104";
}
.glyphicon-eye-open:before {
  content: "\e105";
}
.glyphicon-eye-close:before {
  content: "\e106";
}
.glyphicon-warning-sign:before {
  content: "\e107";
}
.glyphicon-plane:before {
  content: "\e108";
}
.glyphicon-calendar:before {
  content: "\e109";
}
.glyphicon-random:before {
  content: "\e110";
}
.glyphicon-comment:before {
  content: "\e111";
}
.glyphicon-magnet:before {
  content: "\e112";
}
.glyphicon-chevron-up:before {
  content: "\e113";
}
.glyphicon-chevron-down:before {
  content: "\e114";
}
.glyphicon-retweet:before {
  content: "\e115";
}
.glyphicon-shopping-cart:before {
  content: "\e116";
}
.glyphicon-folder-close:before {
  content: "\e117";
}
.glyphicon-folder-open:before {
  content: "\e118";
}
.glyphicon-resize-vertical:before {
  content: "\e119";
}
.glyphicon-resize-horizontal:before {
  content: "\e120";
}
.glyphicon-hdd:before {
  content: "\e121";
}
.glyphicon-bullhorn:before {
  content: "\e122";
}
.glyphicon-bell:before {
  content: "\e123";
}
.glyphicon-certificate:before {
  content: "\e124";
}
.glyphicon-thumbs-up:before {
  content: "\e125";
}
.glyphicon-thumbs-down:before {
  content: "\e126";
}
.glyphicon-hand-right:before {
  content: "\e127";
}
.glyphicon-hand-left:before {
  content: "\e128";
}
.glyphicon-hand-up:before {
  content: "\e129";
}
.glyphicon-hand-down:before {
  content: "\e130";
}
.glyphicon-circle-arrow-right:before {
  content: "\e131";
}
.glyphicon-circle-arrow-left:before {
  content: "\e132";
}
.glyphicon-circle-arrow-up:before {
  content: "\e133";
}
.glyphicon-circle-arrow-down:before {
  content: "\e134";
}
.glyphicon-globe:before {
  content: "\e135";
}
.glyphicon-wrench:before {
  content: "\e136";
}
.glyphicon-tasks:before {
  content: "\e137";
}
.glyphicon-filter:before {
  content: "\e138";
}
.glyphicon-briefcase:before {
  content: "\e139";
}
.glyphicon-fullscreen:before {
  content: "\e140";
}
.glyphicon-dashboard:before {
  content: "\e141";
}
.glyphicon-paperclip:before {
  content: "\e142";
}
.glyphicon-heart-empty:before {
  content: "\e143";
}
.glyphicon-link:before {
  content: "\e144";
}
.glyphicon-phone:before {
  content: "\e145";
}
.glyphicon-pushpin:before {
  content: "\e146";
}
.glyphicon-usd:before {
  content: "\e148";
}
.glyphicon-gbp:before {
  content: "\e149";
}
.glyphicon-sort:before {
  content: "\e150";
}
.glyphicon-sort-by-alphabet:before {
  content: "\e151";
}
.glyphicon-sort-by-alphabet-alt:before {
  content: "\e152";
}
.glyphicon-sort-by-order:before {
  content: "\e153";
}
.glyphicon-sort-by-order-alt:before {
  content: "\e154";
}
.glyphicon-sort-by-attributes:before {
  content: "\e155";
}
.glyphicon-sort-by-attributes-alt:before {
  content: "\e156";
}
.glyphicon-unchecked:before {
  content: "\e157";
}
.glyphicon-expand:before {
  content: "\e158";
}
.glyphicon-collapse-down:before {
  content: "\e159";
}
.glyphicon-collapse-up:before {
  content: "\e160";
}
.glyphicon-log-in:before {
  content: "\e161";
}
.glyphicon-flash:before {
  content: "\e162";
}
.glyphicon-log-out:before {
  content: "\e163";
}
.glyphicon-new-window:before {
  content: "\e164";
}
.glyphicon-record:before {
  content: "\e165";
}
.glyphicon-save:before {
  content: "\e166";
}
.glyphicon-open:before {
  content: "\e167";
}
.glyphicon-saved:before {
  content: "\e168";
}
.glyphicon-import:before {
  content: "\e169";
}
.glyphicon-export:before {
  content: "\e170";
}
.glyphicon-send:before {
  content: "\e171";
}
.glyphicon-floppy-disk:before {
  content: "\e172";
}
.glyphicon-floppy-saved:before {
  content: "\e173";
}
.glyphicon-floppy-remove:before {
  content: "\e174";
}
.glyphicon-floppy-save:before {
  content: "\e175";
}
.glyphicon-floppy-open:before {
  content: "\e176";
}
.glyphicon-credit-card:before {
  content: "\e177";
}
.glyphicon-transfer:before {
  content: "\e178";
}
.glyphicon-cutlery:before {
  content: "\e179";
}
.glyphicon-header:before {
  content: "\e180";
}
.glyphicon-compressed:before {
  content: "\e181";
}
.glyphicon-earphone:before {
  content: "\e182";
}
.glyphicon-phone-alt:before {
  content: "\e183";
}
.glyphicon-tower:before {
  content: "\e184";
}
.glyphicon-stats:before {
  content: "\e185";
}
.glyphicon-sd-video:before {
  content: "\e186";
}
.glyphicon-hd-video:before {
  content: "\e187";
}
.glyphicon-subtitles:before {
  content: "\e188";
}
.glyphicon-sound-stereo:before {
  content: "\e189";
}
.glyphicon-sound-dolby:before {
  content: "\e190";
}
.glyphicon-sound-5-1:before {
  content: "\e191";
}
.glyphicon-sound-6-1:before {
  content: "\e192";
}
.glyphicon-sound-7-1:before {
  content: "\e193";
}
.glyphicon-copyright-mark:before {
  content: "\e194";
}
.glyphicon-registration-mark:before {
  content: "\e195";
}
.glyphicon-cloud-download:before {
  content: "\e197";
}
.glyphicon-cloud-upload:before {
  content: "\e198";
}
.glyphicon-tree-conifer:before {
  content: "\e199";
}
.glyphicon-tree-deciduous:before {
  content: "\e200";
}
.glyphicon-cd:before {
  content: "\e201";
}
.glyphicon-save-file:before {
  content: "\e202";
}
.glyphicon-open-file:before {
  content: "\e203";
}
.glyphicon-level-up:before {
  content: "\e204";
}
.glyphicon-copy:before {
  content: "\e205";
}
.glyphicon-paste:before {
  content: "\e206";
}
.glyphicon-alert:before {
  content: "\e209";
}
.glyphicon-equalizer:before {
  content: "\e210";
}
.glyphicon-king:before {
  content: "\e211";
}
.glyphicon-queen:before {
  content: "\e212";
}
.glyphicon-pawn:before {
  content: "\e213";
}
.glyphicon-bishop:before {
  content: "\e214";
}
.glyphicon-knight:before {
  content: "\e215";
}
.glyphicon-baby-formula:before {
  content: "\e216";
}
.glyphicon-tent:before {
  content: "\26fa";
}
.glyphicon-blackboard:before {
  content: "\e218";
}
.glyphicon-bed:before {
  content: "\e219";
}
.glyphicon-apple:before {
  content: "\f8ff";
}
.glyphicon-erase:before {
  content: "\e221";
}
.glyphicon-hourglass:before {
  content: "\231b";
}
.glyphicon-lamp:before {
  content: "\e223";
}
.glyphicon-duplicate:before {
  content: "\e224";
}
.glyphicon-piggy-bank:before {
  content: "\e225";
}
.glyphicon-scissors:before {
  content: "\e226";
}
.glyphicon-bitcoin:before {
  content: "\e227";
}
.glyphicon-btc:before {
  content: "\e227";
}
.glyphicon-xbt:before {
  content: "\e227";
}
.glyphicon-yen:before {
  content: "\00a5";
}
.glyphicon-jpy:before {
  content: "\00a5";
}
.glyphicon-ruble:before {
  content: "\20bd";
}
.glyphicon-rub:before {
  content: "\20bd";
}
.glyphicon-scale:before {
  content: "\e230";
}
.glyphicon-ice-lolly:before {
  content: "\e231";
}
.glyphicon-ice-lolly-tasted:before {
  content: "\e232";
}
.glyphicon-education:before {
  content: "\e233";
}
.glyphicon-option-horizontal:before {
  content: "\e234";
}
.glyphicon-option-vertical:before {
  content: "\e235";
}
.glyphicon-menu-hamburger:before {
  content: "\e236";
}
.glyphicon-modal-window:before {
  content: "\e237";
}
.glyphicon-oil:before {
  content: "\e238";
}
.glyphicon-grain:before {
  content: "\e239";
}
.glyphicon-sunglasses:before {
  content: "\e240";
}
.glyphicon-text-size:before {
  content: "\e241";
}
.glyphicon-text-color:before {
  content: "\e242";
}
.glyphicon-text-background:before {
  content: "\e243";
}
.glyphicon-object-align-top:before {
  content: "\e244";
}
.glyphicon-object-align-bottom:before {
  content: "\e245";
}
.glyphicon-object-align-horizontal:before {
  content: "\e246";
}
.glyphicon-object-align-left:before {
  content: "\e247";
}
.glyphicon-object-align-vertical:before {
  content: "\e248";
}
.glyphicon-object-align-right:before {
  content: "\e249";
}
.glyphicon-triangle-right:before {
  content: "\e250";
}
.glyphicon-triangle-left:before {
  content: "\e251";
}
.glyphicon-triangle-bottom:before {
  content: "\e252";
}
.glyphicon-triangle-top:before {
  content: "\e253";
}
.glyphicon-console:before {
  content: "\e254";
}
.glyphicon-superscript:before {
  content: "\e255";
}
.glyphicon-subscript:before {
  content: "\e256";
}
.glyphicon-menu-left:before {
  content: "\e257";
}
.glyphicon-menu-right:before {
  content: "\e258";
}
.glyphicon-menu-down:before {
  content: "\e259";
}
.glyphicon-menu-up:before {
  content: "\e260";
}
* {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
*:before,
*:after {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
html {
  font-size: 10px;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}
body {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 13px;
  line-height: 1.42857143;
  color: #000;
  background-color: #fff;
}
input,
button,
select,
textarea {
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}
a {
  color: #337ab7;
  text-decoration: none;
}
a:hover,
a:focus {
  color: #23527c;
  text-decoration: underline;
}
a:focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
figure {
  margin: 0;
}
img {
  vertical-align: middle;
}
.img-responsive,
.thumbnail > img,
.thumbnail a > img,
.carousel-inner > .item > img,
.carousel-inner > .item > a > img {
  display: block;
  max-width: 100%;
  height: auto;
}
.img-rounded {
  border-radius: 3px;
}
.img-thumbnail {
  padding: 4px;
  line-height: 1.42857143;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 2px;
  -webkit-transition: all 0.2s ease-in-out;
  -o-transition: all 0.2s ease-in-out;
  transition: all 0.2s ease-in-out;
  display: inline-block;
  max-width: 100%;
  height: auto;
}
.img-circle {
  border-radius: 50%;
}
hr {
  margin-top: 18px;
  margin-bottom: 18px;
  border: 0;
  border-top: 1px solid #eeeeee;
}
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  margin: -1px;
  padding: 0;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  border: 0;
}
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  clip: auto;
}
[role="button"] {
  cursor: pointer;
}
h1,
h2,
h3,
h4,
h5,
h6,
.h1,
.h2,
.h3,
.h4,
.h5,
.h6 {
  font-family: inherit;
  font-weight: 500;
  line-height: 1.1;
  color: inherit;
}
h1 small,
h2 small,
h3 small,
h4 small,
h5 small,
h6 small,
.h1 small,
.h2 small,
.h3 small,
.h4 small,
.h5 small,
.h6 small,
h1 .small,
h2 .small,
h3 .small,
h4 .small,
h5 .small,
h6 .small,
.h1 .small,
.h2 .small,
.h3 .small,
.h4 .small,
.h5 .small,
.h6 .small {
  font-weight: normal;
  line-height: 1;
  color: #777777;
}
h1,
.h1,
h2,
.h2,
h3,
.h3 {
  margin-top: 18px;
  margin-bottom: 9px;
}
h1 small,
.h1 small,
h2 small,
.h2 small,
h3 small,
.h3 small,
h1 .small,
.h1 .small,
h2 .small,
.h2 .small,
h3 .small,
.h3 .small {
  font-size: 65%;
}
h4,
.h4,
h5,
.h5,
h6,
.h6 {
  margin-top: 9px;
  margin-bottom: 9px;
}
h4 small,
.h4 small,
h5 small,
.h5 small,
h6 small,
.h6 small,
h4 .small,
.h4 .small,
h5 .small,
.h5 .small,
h6 .small,
.h6 .small {
  font-size: 75%;
}
h1,
.h1 {
  font-size: 33px;
}
h2,
.h2 {
  font-size: 27px;
}
h3,
.h3 {
  font-size: 23px;
}
h4,
.h4 {
  font-size: 17px;
}
h5,
.h5 {
  font-size: 13px;
}
h6,
.h6 {
  font-size: 12px;
}
p {
  margin: 0 0 9px;
}
.lead {
  margin-bottom: 18px;
  font-size: 14px;
  font-weight: 300;
  line-height: 1.4;
}
@media (min-width: 768px) {
  .lead {
    font-size: 19.5px;
  }
}
small,
.small {
  font-size: 92%;
}
mark,
.mark {
  background-color: #fcf8e3;
  padding: .2em;
}
.text-left {
  text-align: left;
}
.text-right {
  text-align: right;
}
.text-center {
  text-align: center;
}
.text-justify {
  text-align: justify;
}
.text-nowrap {
  white-space: nowrap;
}
.text-lowercase {
  text-transform: lowercase;
}
.text-uppercase {
  text-transform: uppercase;
}
.text-capitalize {
  text-transform: capitalize;
}
.text-muted {
  color: #777777;
}
.text-primary {
  color: #337ab7;
}
a.text-primary:hover,
a.text-primary:focus {
  color: #286090;
}
.text-success {
  color: #3c763d;
}
a.text-success:hover,
a.text-success:focus {
  color: #2b542c;
}
.text-info {
  color: #31708f;
}
a.text-info:hover,
a.text-info:focus {
  color: #245269;
}
.text-warning {
  color: #8a6d3b;
}
a.text-warning:hover,
a.text-warning:focus {
  color: #66512c;
}
.text-danger {
  color: #a94442;
}
a.text-danger:hover,
a.text-danger:focus {
  color: #843534;
}
.bg-primary {
  color: #fff;
  background-color: #337ab7;
}
a.bg-primary:hover,
a.bg-primary:focus {
  background-color: #286090;
}
.bg-success {
  background-color: #dff0d8;
}
a.bg-success:hover,
a.bg-success:focus {
  background-color: #c1e2b3;
}
.bg-info {
  background-color: #d9edf7;
}
a.bg-info:hover,
a.bg-info:focus {
  background-color: #afd9ee;
}
.bg-warning {
  background-color: #fcf8e3;
}
a.bg-warning:hover,
a.bg-warning:focus {
  background-color: #f7ecb5;
}
.bg-danger {
  background-color: #f2dede;
}
a.bg-danger:hover,
a.bg-danger:focus {
  background-color: #e4b9b9;
}
.page-header {
  padding-bottom: 8px;
  margin: 36px 0 18px;
  border-bottom: 1px solid #eeeeee;
}
ul,
ol {
  margin-top: 0;
  margin-bottom: 9px;
}
ul ul,
ol ul,
ul ol,
ol ol {
  margin-bottom: 0;
}
.list-unstyled {
  padding-left: 0;
  list-style: none;
}
.list-inline {
  padding-left: 0;
  list-style: none;
  margin-left: -5px;
}
.list-inline > li {
  display: inline-block;
  padding-left: 5px;
  padding-right: 5px;
}
dl {
  margin-top: 0;
  margin-bottom: 18px;
}
dt,
dd {
  line-height: 1.42857143;
}
dt {
  font-weight: bold;
}
dd {
  margin-left: 0;
}
@media (min-width: 541px) {
  .dl-horizontal dt {
    float: left;
    width: 160px;
    clear: left;
    text-align: right;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .dl-horizontal dd {
    margin-left: 180px;
  }
}
abbr[title],
abbr[data-original-title] {
  cursor: help;
  border-bottom: 1px dotted #777777;
}
.initialism {
  font-size: 90%;
  text-transform: uppercase;
}
blockquote {
  padding: 9px 18px;
  margin: 0 0 18px;
  font-size: inherit;
  border-left: 5px solid #eeeeee;
}
blockquote p:last-child,
blockquote ul:last-child,
blockquote ol:last-child {
  margin-bottom: 0;
}
blockquote footer,
blockquote small,
blockquote .small {
  display: block;
  font-size: 80%;
  line-height: 1.42857143;
  color: #777777;
}
blockquote footer:before,
blockquote small:before,
blockquote .small:before {
  content: '\2014 \00A0';
}
.blockquote-reverse,
blockquote.pull-right {
  padding-right: 15px;
  padding-left: 0;
  border-right: 5px solid #eeeeee;
  border-left: 0;
  text-align: right;
}
.blockquote-reverse footer:before,
blockquote.pull-right footer:before,
.blockquote-reverse small:before,
blockquote.pull-right small:before,
.blockquote-reverse .small:before,
blockquote.pull-right .small:before {
  content: '';
}
.blockquote-reverse footer:after,
blockquote.pull-right footer:after,
.blockquote-reverse small:after,
blockquote.pull-right small:after,
.blockquote-reverse .small:after,
blockquote.pull-right .small:after {
  content: '\00A0 \2014';
}
address {
  margin-bottom: 18px;
  font-style: normal;
  line-height: 1.42857143;
}
code,
kbd,
pre,
samp {
  font-family: monospace;
}
code {
  padding: 2px 4px;
  font-size: 90%;
  color: #c7254e;
  background-color: #f9f2f4;
  border-radius: 2px;
}
kbd {
  padding: 2px 4px;
  font-size: 90%;
  color: #888;
  background-color: transparent;
  border-radius: 1px;
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.25);
}
kbd kbd {
  padding: 0;
  font-size: 100%;
  font-weight: bold;
  box-shadow: none;
}
pre {
  display: block;
  padding: 8.5px;
  margin: 0 0 9px;
  font-size: 12px;
  line-height: 1.42857143;
  word-break: break-all;
  word-wrap: break-word;
  color: #333333;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 2px;
}
pre code {
  padding: 0;
  font-size: inherit;
  color: inherit;
  white-space: pre-wrap;
  background-color: transparent;
  border-radius: 0;
}
.pre-scrollable {
  max-height: 340px;
  overflow-y: scroll;
}
.container {
  margin-right: auto;
  margin-left: auto;
  padding-left: 0px;
  padding-right: 0px;
}
@media (min-width: 768px) {
  .container {
    width: 768px;
  }
}
@media (min-width: 992px) {
  .container {
    width: 940px;
  }
}
@media (min-width: 1200px) {
  .container {
    width: 1140px;
  }
}
.container-fluid {
  margin-right: auto;
  margin-left: auto;
  padding-left: 0px;
  padding-right: 0px;
}
.row {
  margin-left: 0px;
  margin-right: 0px;
}
.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12 {
  position: relative;
  min-height: 1px;
  padding-left: 0px;
  padding-right: 0px;
}
.col-xs-1, .col-xs-2, .col-xs-3, .col-xs-4, .col-xs-5, .col-xs-6, .col-xs-7, .col-xs-8, .col-xs-9, .col-xs-10, .col-xs-11, .col-xs-12 {
  float: left;
}
.col-xs-12 {
  width: 100%;
}
.col-xs-11 {
  width: 91.66666667%;
}
.col-xs-10 {
  width: 83.33333333%;
}
.col-xs-9 {
  width: 75%;
}
.col-xs-8 {
  width: 66.66666667%;
}
.col-xs-7 {
  width: 58.33333333%;
}
.col-xs-6 {
  width: 50%;
}
.col-xs-5 {
  width: 41.66666667%;
}
.col-xs-4 {
  width: 33.33333333%;
}
.col-xs-3 {
  width: 25%;
}
.col-xs-2 {
  width: 16.66666667%;
}
.col-xs-1 {
  width: 8.33333333%;
}
.col-xs-pull-12 {
  right: 100%;
}
.col-xs-pull-11 {
  right: 91.66666667%;
}
.col-xs-pull-10 {
  right: 83.33333333%;
}
.col-xs-pull-9 {
  right: 75%;
}
.col-xs-pull-8 {
  right: 66.66666667%;
}
.col-xs-pull-7 {
  right: 58.33333333%;
}
.col-xs-pull-6 {
  right: 50%;
}
.col-xs-pull-5 {
  right: 41.66666667%;
}
.col-xs-pull-4 {
  right: 33.33333333%;
}
.col-xs-pull-3 {
  right: 25%;
}
.col-xs-pull-2 {
  right: 16.66666667%;
}
.col-xs-pull-1 {
  right: 8.33333333%;
}
.col-xs-pull-0 {
  right: auto;
}
.col-xs-push-12 {
  left: 100%;
}
.col-xs-push-11 {
  left: 91.66666667%;
}
.col-xs-push-10 {
  left: 83.33333333%;
}
.col-xs-push-9 {
  left: 75%;
}
.col-xs-push-8 {
  left: 66.66666667%;
}
.col-xs-push-7 {
  left: 58.33333333%;
}
.col-xs-push-6 {
  left: 50%;
}
.col-xs-push-5 {
  left: 41.66666667%;
}
.col-xs-push-4 {
  left: 33.33333333%;
}
.col-xs-push-3 {
  left: 25%;
}
.col-xs-push-2 {
  left: 16.66666667%;
}
.col-xs-push-1 {
  left: 8.33333333%;
}
.col-xs-push-0 {
  left: auto;
}
.col-xs-offset-12 {
  margin-left: 100%;
}
.col-xs-offset-11 {
  margin-left: 91.66666667%;
}
.col-xs-offset-10 {
  margin-left: 83.33333333%;
}
.col-xs-offset-9 {
  margin-left: 75%;
}
.col-xs-offset-8 {
  margin-left: 66.66666667%;
}
.col-xs-offset-7 {
  margin-left: 58.33333333%;
}
.col-xs-offset-6 {
  margin-left: 50%;
}
.col-xs-offset-5 {
  margin-left: 41.66666667%;
}
.col-xs-offset-4 {
  margin-left: 33.33333333%;
}
.col-xs-offset-3 {
  margin-left: 25%;
}
.col-xs-offset-2 {
  margin-left: 16.66666667%;
}
.col-xs-offset-1 {
  margin-left: 8.33333333%;
}
.col-xs-offset-0 {
  margin-left: 0%;
}
@media (min-width: 768px) {
  .col-sm-1, .col-sm-2, .col-sm-3, .col-sm-4, .col-sm-5, .col-sm-6, .col-sm-7, .col-sm-8, .col-sm-9, .col-sm-10, .col-sm-11, .col-sm-12 {
    float: left;
  }
  .col-sm-12 {
    width: 100%;
  }
  .col-sm-11 {
    width: 91.66666667%;
  }
  .col-sm-10 {
    width: 83.33333333%;
  }
  .col-sm-9 {
    width: 75%;
  }
  .col-sm-8 {
    width: 66.66666667%;
  }
  .col-sm-7 {
    width: 58.33333333%;
  }
  .col-sm-6 {
    width: 50%;
  }
  .col-sm-5 {
    width: 41.66666667%;
  }
  .col-sm-4 {
    width: 33.33333333%;
  }
  .col-sm-3 {
    width: 25%;
  }
  .col-sm-2 {
    width: 16.66666667%;
  }
  .col-sm-1 {
    width: 8.33333333%;
  }
  .col-sm-pull-12 {
    right: 100%;
  }
  .col-sm-pull-11 {
    right: 91.66666667%;
  }
  .col-sm-pull-10 {
    right: 83.33333333%;
  }
  .col-sm-pull-9 {
    right: 75%;
  }
  .col-sm-pull-8 {
    right: 66.66666667%;
  }
  .col-sm-pull-7 {
    right: 58.33333333%;
  }
  .col-sm-pull-6 {
    right: 50%;
  }
  .col-sm-pull-5 {
    right: 41.66666667%;
  }
  .col-sm-pull-4 {
    right: 33.33333333%;
  }
  .col-sm-pull-3 {
    right: 25%;
  }
  .col-sm-pull-2 {
    right: 16.66666667%;
  }
  .col-sm-pull-1 {
    right: 8.33333333%;
  }
  .col-sm-pull-0 {
    right: auto;
  }
  .col-sm-push-12 {
    left: 100%;
  }
  .col-sm-push-11 {
    left: 91.66666667%;
  }
  .col-sm-push-10 {
    left: 83.33333333%;
  }
  .col-sm-push-9 {
    left: 75%;
  }
  .col-sm-push-8 {
    left: 66.66666667%;
  }
  .col-sm-push-7 {
    left: 58.33333333%;
  }
  .col-sm-push-6 {
    left: 50%;
  }
  .col-sm-push-5 {
    left: 41.66666667%;
  }
  .col-sm-push-4 {
    left: 33.33333333%;
  }
  .col-sm-push-3 {
    left: 25%;
  }
  .col-sm-push-2 {
    left: 16.66666667%;
  }
  .col-sm-push-1 {
    left: 8.33333333%;
  }
  .col-sm-push-0 {
    left: auto;
  }
  .col-sm-offset-12 {
    margin-left: 100%;
  }
  .col-sm-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-sm-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-sm-offset-9 {
    margin-left: 75%;
  }
  .col-sm-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-sm-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-sm-offset-6 {
    margin-left: 50%;
  }
  .col-sm-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-sm-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-sm-offset-3 {
    margin-left: 25%;
  }
  .col-sm-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-sm-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-sm-offset-0 {
    margin-left: 0%;
  }
}
@media (min-width: 992px) {
  .col-md-1, .col-md-2, .col-md-3, .col-md-4, .col-md-5, .col-md-6, .col-md-7, .col-md-8, .col-md-9, .col-md-10, .col-md-11, .col-md-12 {
    float: left;
  }
  .col-md-12 {
    width: 100%;
  }
  .col-md-11 {
    width: 91.66666667%;
  }
  .col-md-10 {
    width: 83.33333333%;
  }
  .col-md-9 {
    width: 75%;
  }
  .col-md-8 {
    width: 66.66666667%;
  }
  .col-md-7 {
    width: 58.33333333%;
  }
  .col-md-6 {
    width: 50%;
  }
  .col-md-5 {
    width: 41.66666667%;
  }
  .col-md-4 {
    width: 33.33333333%;
  }
  .col-md-3 {
    width: 25%;
  }
  .col-md-2 {
    width: 16.66666667%;
  }
  .col-md-1 {
    width: 8.33333333%;
  }
  .col-md-pull-12 {
    right: 100%;
  }
  .col-md-pull-11 {
    right: 91.66666667%;
  }
  .col-md-pull-10 {
    right: 83.33333333%;
  }
  .col-md-pull-9 {
    right: 75%;
  }
  .col-md-pull-8 {
    right: 66.66666667%;
  }
  .col-md-pull-7 {
    right: 58.33333333%;
  }
  .col-md-pull-6 {
    right: 50%;
  }
  .col-md-pull-5 {
    right: 41.66666667%;
  }
  .col-md-pull-4 {
    right: 33.33333333%;
  }
  .col-md-pull-3 {
    right: 25%;
  }
  .col-md-pull-2 {
    right: 16.66666667%;
  }
  .col-md-pull-1 {
    right: 8.33333333%;
  }
  .col-md-pull-0 {
    right: auto;
  }
  .col-md-push-12 {
    left: 100%;
  }
  .col-md-push-11 {
    left: 91.66666667%;
  }
  .col-md-push-10 {
    left: 83.33333333%;
  }
  .col-md-push-9 {
    left: 75%;
  }
  .col-md-push-8 {
    left: 66.66666667%;
  }
  .col-md-push-7 {
    left: 58.33333333%;
  }
  .col-md-push-6 {
    left: 50%;
  }
  .col-md-push-5 {
    left: 41.66666667%;
  }
  .col-md-push-4 {
    left: 33.33333333%;
  }
  .col-md-push-3 {
    left: 25%;
  }
  .col-md-push-2 {
    left: 16.66666667%;
  }
  .col-md-push-1 {
    left: 8.33333333%;
  }
  .col-md-push-0 {
    left: auto;
  }
  .col-md-offset-12 {
    margin-left: 100%;
  }
  .col-md-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-md-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-md-offset-9 {
    margin-left: 75%;
  }
  .col-md-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-md-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-md-offset-6 {
    margin-left: 50%;
  }
  .col-md-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-md-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-md-offset-3 {
    margin-left: 25%;
  }
  .col-md-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-md-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-md-offset-0 {
    margin-left: 0%;
  }
}
@media (min-width: 1200px) {
  .col-lg-1, .col-lg-2, .col-lg-3, .col-lg-4, .col-lg-5, .col-lg-6, .col-lg-7, .col-lg-8, .col-lg-9, .col-lg-10, .col-lg-11, .col-lg-12 {
    float: left;
  }
  .col-lg-12 {
    width: 100%;
  }
  .col-lg-11 {
    width: 91.66666667%;
  }
  .col-lg-10 {
    width: 83.33333333%;
  }
  .col-lg-9 {
    width: 75%;
  }
  .col-lg-8 {
    width: 66.66666667%;
  }
  .col-lg-7 {
    width: 58.33333333%;
  }
  .col-lg-6 {
    width: 50%;
  }
  .col-lg-5 {
    width: 41.66666667%;
  }
  .col-lg-4 {
    width: 33.33333333%;
  }
  .col-lg-3 {
    width: 25%;
  }
  .col-lg-2 {
    width: 16.66666667%;
  }
  .col-lg-1 {
    width: 8.33333333%;
  }
  .col-lg-pull-12 {
    right: 100%;
  }
  .col-lg-pull-11 {
    right: 91.66666667%;
  }
  .col-lg-pull-10 {
    right: 83.33333333%;
  }
  .col-lg-pull-9 {
    right: 75%;
  }
  .col-lg-pull-8 {
    right: 66.66666667%;
  }
  .col-lg-pull-7 {
    right: 58.33333333%;
  }
  .col-lg-pull-6 {
    right: 50%;
  }
  .col-lg-pull-5 {
    right: 41.66666667%;
  }
  .col-lg-pull-4 {
    right: 33.33333333%;
  }
  .col-lg-pull-3 {
    right: 25%;
  }
  .col-lg-pull-2 {
    right: 16.66666667%;
  }
  .col-lg-pull-1 {
    right: 8.33333333%;
  }
  .col-lg-pull-0 {
    right: auto;
  }
  .col-lg-push-12 {
    left: 100%;
  }
  .col-lg-push-11 {
    left: 91.66666667%;
  }
  .col-lg-push-10 {
    left: 83.33333333%;
  }
  .col-lg-push-9 {
    left: 75%;
  }
  .col-lg-push-8 {
    left: 66.66666667%;
  }
  .col-lg-push-7 {
    left: 58.33333333%;
  }
  .col-lg-push-6 {
    left: 50%;
  }
  .col-lg-push-5 {
    left: 41.66666667%;
  }
  .col-lg-push-4 {
    left: 33.33333333%;
  }
  .col-lg-push-3 {
    left: 25%;
  }
  .col-lg-push-2 {
    left: 16.66666667%;
  }
  .col-lg-push-1 {
    left: 8.33333333%;
  }
  .col-lg-push-0 {
    left: auto;
  }
  .col-lg-offset-12 {
    margin-left: 100%;
  }
  .col-lg-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-lg-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-lg-offset-9 {
    margin-left: 75%;
  }
  .col-lg-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-lg-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-lg-offset-6 {
    margin-left: 50%;
  }
  .col-lg-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-lg-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-lg-offset-3 {
    margin-left: 25%;
  }
  .col-lg-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-lg-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-lg-offset-0 {
    margin-left: 0%;
  }
}
table {
  background-color: transparent;
}
caption {
  padding-top: 8px;
  padding-bottom: 8px;
  color: #777777;
  text-align: left;
}
th {
  text-align: left;
}
.table {
  width: 100%;
  max-width: 100%;
  margin-bottom: 18px;
}
.table > thead > tr > th,
.table > tbody > tr > th,
.table > tfoot > tr > th,
.table > thead > tr > td,
.table > tbody > tr > td,
.table > tfoot > tr > td {
  padding: 8px;
  line-height: 1.42857143;
  vertical-align: top;
  border-top: 1px solid #ddd;
}
.table > thead > tr > th {
  vertical-align: bottom;
  border-bottom: 2px solid #ddd;
}
.table > caption + thead > tr:first-child > th,
.table > colgroup + thead > tr:first-child > th,
.table > thead:first-child > tr:first-child > th,
.table > caption + thead > tr:first-child > td,
.table > colgroup + thead > tr:first-child > td,
.table > thead:first-child > tr:first-child > td {
  border-top: 0;
}
.table > tbody + tbody {
  border-top: 2px solid #ddd;
}
.table .table {
  background-color: #fff;
}
.table-condensed > thead > tr > th,
.table-condensed > tbody > tr > th,
.table-condensed > tfoot > tr > th,
.table-condensed > thead > tr > td,
.table-condensed > tbody > tr > td,
.table-condensed > tfoot > tr > td {
  padding: 5px;
}
.table-bordered {
  border: 1px solid #ddd;
}
.table-bordered > thead > tr > th,
.table-bordered > tbody > tr > th,
.table-bordered > tfoot > tr > th,
.table-bordered > thead > tr > td,
.table-bordered > tbody > tr > td,
.table-bordered > tfoot > tr > td {
  border: 1px solid #ddd;
}
.table-bordered > thead > tr > th,
.table-bordered > thead > tr > td {
  border-bottom-width: 2px;
}
.table-striped > tbody > tr:nth-of-type(odd) {
  background-color: #f9f9f9;
}
.table-hover > tbody > tr:hover {
  background-color: #f5f5f5;
}
table col[class*="col-"] {
  position: static;
  float: none;
  display: table-column;
}
table td[class*="col-"],
table th[class*="col-"] {
  position: static;
  float: none;
  display: table-cell;
}
.table > thead > tr > td.active,
.table > tbody > tr > td.active,
.table > tfoot > tr > td.active,
.table > thead > tr > th.active,
.table > tbody > tr > th.active,
.table > tfoot > tr > th.active,
.table > thead > tr.active > td,
.table > tbody > tr.active > td,
.table > tfoot > tr.active > td,
.table > thead > tr.active > th,
.table > tbody > tr.active > th,
.table > tfoot > tr.active > th {
  background-color: #f5f5f5;
}
.table-hover > tbody > tr > td.active:hover,
.table-hover > tbody > tr > th.active:hover,
.table-hover > tbody > tr.active:hover > td,
.table-hover > tbody > tr:hover > .active,
.table-hover > tbody > tr.active:hover > th {
  background-color: #e8e8e8;
}
.table > thead > tr > td.success,
.table > tbody > tr > td.success,
.table > tfoot > tr > td.success,
.table > thead > tr > th.success,
.table > tbody > tr > th.success,
.table > tfoot > tr > th.success,
.table > thead > tr.success > td,
.table > tbody > tr.success > td,
.table > tfoot > tr.success > td,
.table > thead > tr.success > th,
.table > tbody > tr.success > th,
.table > tfoot > tr.success > th {
  background-color: #dff0d8;
}
.table-hover > tbody > tr > td.success:hover,
.table-hover > tbody > tr > th.success:hover,
.table-hover > tbody > tr.success:hover > td,
.table-hover > tbody > tr:hover > .success,
.table-hover > tbody > tr.success:hover > th {
  background-color: #d0e9c6;
}
.table > thead > tr > td.info,
.table > tbody > tr > td.info,
.table > tfoot > tr > td.info,
.table > thead > tr > th.info,
.table > tbody > tr > th.info,
.table > tfoot > tr > th.info,
.table > thead > tr.info > td,
.table > tbody > tr.info > td,
.table > tfoot > tr.info > td,
.table > thead > tr.info > th,
.table > tbody > tr.info > th,
.table > tfoot > tr.info > th {
  background-color: #d9edf7;
}
.table-hover > tbody > tr > td.info:hover,
.table-hover > tbody > tr > th.info:hover,
.table-hover > tbody > tr.info:hover > td,
.table-hover > tbody > tr:hover > .info,
.table-hover > tbody > tr.info:hover > th {
  background-color: #c4e3f3;
}
.table > thead > tr > td.warning,
.table > tbody > tr > td.warning,
.table > tfoot > tr > td.warning,
.table > thead > tr > th.warning,
.table > tbody > tr > th.warning,
.table > tfoot > tr > th.warning,
.table > thead > tr.warning > td,
.table > tbody > tr.warning > td,
.table > tfoot > tr.warning > td,
.table > thead > tr.warning > th,
.table > tbody > tr.warning > th,
.table > tfoot > tr.warning > th {
  background-color: #fcf8e3;
}
.table-hover > tbody > tr > td.warning:hover,
.table-hover > tbody > tr > th.warning:hover,
.table-hover > tbody > tr.warning:hover > td,
.table-hover > tbody > tr:hover > .warning,
.table-hover > tbody > tr.warning:hover > th {
  background-color: #faf2cc;
}
.table > thead > tr > td.danger,
.table > tbody > tr > td.danger,
.table > tfoot > tr > td.danger,
.table > thead > tr > th.danger,
.table > tbody > tr > th.danger,
.table > tfoot > tr > th.danger,
.table > thead > tr.danger > td,
.table > tbody > tr.danger > td,
.table > tfoot > tr.danger > td,
.table > thead > tr.danger > th,
.table > tbody > tr.danger > th,
.table > tfoot > tr.danger > th {
  background-color: #f2dede;
}
.table-hover > tbody > tr > td.danger:hover,
.table-hover > tbody > tr > th.danger:hover,
.table-hover > tbody > tr.danger:hover > td,
.table-hover > tbody > tr:hover > .danger,
.table-hover > tbody > tr.danger:hover > th {
  background-color: #ebcccc;
}
.table-responsive {
  overflow-x: auto;
  min-height: 0.01%;
}
@media screen and (max-width: 767px) {
  .table-responsive {
    width: 100%;
    margin-bottom: 13.5px;
    overflow-y: hidden;
    -ms-overflow-style: -ms-autohiding-scrollbar;
    border: 1px solid #ddd;
  }
  .table-responsive > .table {
    margin-bottom: 0;
  }
  .table-responsive > .table > thead > tr > th,
  .table-responsive > .table > tbody > tr > th,
  .table-responsive > .table > tfoot > tr > th,
  .table-responsive > .table > thead > tr > td,
  .table-responsive > .table > tbody > tr > td,
  .table-responsive > .table > tfoot > tr > td {
    white-space: nowrap;
  }
  .table-responsive > .table-bordered {
    border: 0;
  }
  .table-responsive > .table-bordered > thead > tr > th:first-child,
  .table-responsive > .table-bordered > tbody > tr > th:first-child,
  .table-responsive > .table-bordered > tfoot > tr > th:first-child,
  .table-responsive > .table-bordered > thead > tr > td:first-child,
  .table-responsive > .table-bordered > tbody > tr > td:first-child,
  .table-responsive > .table-bordered > tfoot > tr > td:first-child {
    border-left: 0;
  }
  .table-responsive > .table-bordered > thead > tr > th:last-child,
  .table-responsive > .table-bordered > tbody > tr > th:last-child,
  .table-responsive > .table-bordered > tfoot > tr > th:last-child,
  .table-responsive > .table-bordered > thead > tr > td:last-child,
  .table-responsive > .table-bordered > tbody > tr > td:last-child,
  .table-responsive > .table-bordered > tfoot > tr > td:last-child {
    border-right: 0;
  }
  .table-responsive > .table-bordered > tbody > tr:last-child > th,
  .table-responsive > .table-bordered > tfoot > tr:last-child > th,
  .table-responsive > .table-bordered > tbody > tr:last-child > td,
  .table-responsive > .table-bordered > tfoot > tr:last-child > td {
    border-bottom: 0;
  }
}
fieldset {
  padding: 0;
  margin: 0;
  border: 0;
  min-width: 0;
}
legend {
  display: block;
  width: 100%;
  padding: 0;
  margin-bottom: 18px;
  font-size: 19.5px;
  line-height: inherit;
  color: #333333;
  border: 0;
  border-bottom: 1px solid #e5e5e5;
}
label {
  display: inline-block;
  max-width: 100%;
  margin-bottom: 5px;
  font-weight: bold;
}
input[type="search"] {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
input[type="radio"],
input[type="checkbox"] {
  margin: 4px 0 0;
  margin-top: 1px \9;
  line-height: normal;
}
input[type="file"] {
  display: block;
}
input[type="range"] {
  display: block;
  width: 100%;
}
select[multiple],
select[size] {
  height: auto;
}
input[type="file"]:focus,
input[type="radio"]:focus,
input[type="checkbox"]:focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
output {
  display: block;
  padding-top: 7px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
}
.form-control {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
}
.form-control:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.form-control::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.form-control:-ms-input-placeholder {
  color: #999;
}
.form-control::-webkit-input-placeholder {
  color: #999;
}
.form-control::-ms-expand {
  border: 0;
  background-color: transparent;
}
.form-control[disabled],
.form-control[readonly],
fieldset[disabled] .form-control {
  background-color: #eeeeee;
  opacity: 1;
}
.form-control[disabled],
fieldset[disabled] .form-control {
  cursor: not-allowed;
}
textarea.form-control {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: none;
}
@media screen and (-webkit-min-device-pixel-ratio: 0) {
  input[type="date"].form-control,
  input[type="time"].form-control,
  input[type="datetime-local"].form-control,
  input[type="month"].form-control {
    line-height: 32px;
  }
  input[type="date"].input-sm,
  input[type="time"].input-sm,
  input[type="datetime-local"].input-sm,
  input[type="month"].input-sm,
  .input-group-sm input[type="date"],
  .input-group-sm input[type="time"],
  .input-group-sm input[type="datetime-local"],
  .input-group-sm input[type="month"] {
    line-height: 30px;
  }
  input[type="date"].input-lg,
  input[type="time"].input-lg,
  input[type="datetime-local"].input-lg,
  input[type="month"].input-lg,
  .input-group-lg input[type="date"],
  .input-group-lg input[type="time"],
  .input-group-lg input[type="datetime-local"],
  .input-group-lg input[type="month"] {
    line-height: 45px;
  }
}
.form-group {
  margin-bottom: 15px;
}
.radio,
.checkbox {
  position: relative;
  display: block;
  margin-top: 10px;
  margin-bottom: 10px;
}
.radio label,
.checkbox label {
  min-height: 18px;
  padding-left: 20px;
  margin-bottom: 0;
  font-weight: normal;
  cursor: pointer;
}
.radio input[type="radio"],
.radio-inline input[type="radio"],
.checkbox input[type="checkbox"],
.checkbox-inline input[type="checkbox"] {
  position: absolute;
  margin-left: -20px;
  margin-top: 4px \9;
}
.radio + .radio,
.checkbox + .checkbox {
  margin-top: -5px;
}
.radio-inline,
.checkbox-inline {
  position: relative;
  display: inline-block;
  padding-left: 20px;
  margin-bottom: 0;
  vertical-align: middle;
  font-weight: normal;
  cursor: pointer;
}
.radio-inline + .radio-inline,
.checkbox-inline + .checkbox-inline {
  margin-top: 0;
  margin-left: 10px;
}
input[type="radio"][disabled],
input[type="checkbox"][disabled],
input[type="radio"].disabled,
input[type="checkbox"].disabled,
fieldset[disabled] input[type="radio"],
fieldset[disabled] input[type="checkbox"] {
  cursor: not-allowed;
}
.radio-inline.disabled,
.checkbox-inline.disabled,
fieldset[disabled] .radio-inline,
fieldset[disabled] .checkbox-inline {
  cursor: not-allowed;
}
.radio.disabled label,
.checkbox.disabled label,
fieldset[disabled] .radio label,
fieldset[disabled] .checkbox label {
  cursor: not-allowed;
}
.form-control-static {
  padding-top: 7px;
  padding-bottom: 7px;
  margin-bottom: 0;
  min-height: 31px;
}
.form-control-static.input-lg,
.form-control-static.input-sm {
  padding-left: 0;
  padding-right: 0;
}
.input-sm {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
select.input-sm {
  height: 30px;
  line-height: 30px;
}
textarea.input-sm,
select[multiple].input-sm {
  height: auto;
}
.form-group-sm .form-control {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.form-group-sm select.form-control {
  height: 30px;
  line-height: 30px;
}
.form-group-sm textarea.form-control,
.form-group-sm select[multiple].form-control {
  height: auto;
}
.form-group-sm .form-control-static {
  height: 30px;
  min-height: 30px;
  padding: 6px 10px;
  font-size: 12px;
  line-height: 1.5;
}
.input-lg {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
select.input-lg {
  height: 45px;
  line-height: 45px;
}
textarea.input-lg,
select[multiple].input-lg {
  height: auto;
}
.form-group-lg .form-control {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
.form-group-lg select.form-control {
  height: 45px;
  line-height: 45px;
}
.form-group-lg textarea.form-control,
.form-group-lg select[multiple].form-control {
  height: auto;
}
.form-group-lg .form-control-static {
  height: 45px;
  min-height: 35px;
  padding: 11px 16px;
  font-size: 17px;
  line-height: 1.3333333;
}
.has-feedback {
  position: relative;
}
.has-feedback .form-control {
  padding-right: 40px;
}
.form-control-feedback {
  position: absolute;
  top: 0;
  right: 0;
  z-index: 2;
  display: block;
  width: 32px;
  height: 32px;
  line-height: 32px;
  text-align: center;
  pointer-events: none;
}
.input-lg + .form-control-feedback,
.input-group-lg + .form-control-feedback,
.form-group-lg .form-control + .form-control-feedback {
  width: 45px;
  height: 45px;
  line-height: 45px;
}
.input-sm + .form-control-feedback,
.input-group-sm + .form-control-feedback,
.form-group-sm .form-control + .form-control-feedback {
  width: 30px;
  height: 30px;
  line-height: 30px;
}
.has-success .help-block,
.has-success .control-label,
.has-success .radio,
.has-success .checkbox,
.has-success .radio-inline,
.has-success .checkbox-inline,
.has-success.radio label,
.has-success.checkbox label,
.has-success.radio-inline label,
.has-success.checkbox-inline label {
  color: #3c763d;
}
.has-success .form-control {
  border-color: #3c763d;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-success .form-control:focus {
  border-color: #2b542c;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
}
.has-success .input-group-addon {
  color: #3c763d;
  border-color: #3c763d;
  background-color: #dff0d8;
}
.has-success .form-control-feedback {
  color: #3c763d;
}
.has-warning .help-block,
.has-warning .control-label,
.has-warning .radio,
.has-warning .checkbox,
.has-warning .radio-inline,
.has-warning .checkbox-inline,
.has-warning.radio label,
.has-warning.checkbox label,
.has-warning.radio-inline label,
.has-warning.checkbox-inline label {
  color: #8a6d3b;
}
.has-warning .form-control {
  border-color: #8a6d3b;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-warning .form-control:focus {
  border-color: #66512c;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;
}
.has-warning .input-group-addon {
  color: #8a6d3b;
  border-color: #8a6d3b;
  background-color: #fcf8e3;
}
.has-warning .form-control-feedback {
  color: #8a6d3b;
}
.has-error .help-block,
.has-error .control-label,
.has-error .radio,
.has-error .checkbox,
.has-error .radio-inline,
.has-error .checkbox-inline,
.has-error.radio label,
.has-error.checkbox label,
.has-error.radio-inline label,
.has-error.checkbox-inline label {
  color: #a94442;
}
.has-error .form-control {
  border-color: #a94442;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-error .form-control:focus {
  border-color: #843534;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
}
.has-error .input-group-addon {
  color: #a94442;
  border-color: #a94442;
  background-color: #f2dede;
}
.has-error .form-control-feedback {
  color: #a94442;
}
.has-feedback label ~ .form-control-feedback {
  top: 23px;
}
.has-feedback label.sr-only ~ .form-control-feedback {
  top: 0;
}
.help-block {
  display: block;
  margin-top: 5px;
  margin-bottom: 10px;
  color: #404040;
}
@media (min-width: 768px) {
  .form-inline .form-group {
    display: inline-block;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .form-control {
    display: inline-block;
    width: auto;
    vertical-align: middle;
  }
  .form-inline .form-control-static {
    display: inline-block;
  }
  .form-inline .input-group {
    display: inline-table;
    vertical-align: middle;
  }
  .form-inline .input-group .input-group-addon,
  .form-inline .input-group .input-group-btn,
  .form-inline .input-group .form-control {
    width: auto;
  }
  .form-inline .input-group > .form-control {
    width: 100%;
  }
  .form-inline .control-label {
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .radio,
  .form-inline .checkbox {
    display: inline-block;
    margin-top: 0;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .radio label,
  .form-inline .checkbox label {
    padding-left: 0;
  }
  .form-inline .radio input[type="radio"],
  .form-inline .checkbox input[type="checkbox"] {
    position: relative;
    margin-left: 0;
  }
  .form-inline .has-feedback .form-control-feedback {
    top: 0;
  }
}
.form-horizontal .radio,
.form-horizontal .checkbox,
.form-horizontal .radio-inline,
.form-horizontal .checkbox-inline {
  margin-top: 0;
  margin-bottom: 0;
  padding-top: 7px;
}
.form-horizontal .radio,
.form-horizontal .checkbox {
  min-height: 25px;
}
.form-horizontal .form-group {
  margin-left: 0px;
  margin-right: 0px;
}
@media (min-width: 768px) {
  .form-horizontal .control-label {
    text-align: right;
    margin-bottom: 0;
    padding-top: 7px;
  }
}
.form-horizontal .has-feedback .form-control-feedback {
  right: 0px;
}
@media (min-width: 768px) {
  .form-horizontal .form-group-lg .control-label {
    padding-top: 11px;
    font-size: 17px;
  }
}
@media (min-width: 768px) {
  .form-horizontal .form-group-sm .control-label {
    padding-top: 6px;
    font-size: 12px;
  }
}
.btn {
  display: inline-block;
  margin-bottom: 0;
  font-weight: normal;
  text-align: center;
  vertical-align: middle;
  touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  white-space: nowrap;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  border-radius: 2px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #333;
  text-decoration: none;
}
.btn:active,
.btn.active {
  outline: 0;
  background-image: none;
  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  opacity: 0.65;
  filter: alpha(opacity=65);
  -webkit-box-shadow: none;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
.btn-default:focus,
.btn-default.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
.btn-default:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.btn-default:active:hover,
.btn-default.active:hover,
.open > .dropdown-toggle.btn-default:hover,
.btn-default:active:focus,
.btn-default.active:focus,
.open > .dropdown-toggle.btn-default:focus,
.btn-default:active.focus,
.btn-default.active.focus,
.open > .dropdown-toggle.btn-default.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
  background-image: none;
}
.btn-default.disabled:hover,
.btn-default[disabled]:hover,
fieldset[disabled] .btn-default:hover,
.btn-default.disabled:focus,
.btn-default[disabled]:focus,
fieldset[disabled] .btn-default:focus,
.btn-default.disabled.focus,
.btn-default[disabled].focus,
fieldset[disabled] .btn-default.focus {
  background-color: #fff;
  border-color: #ccc;
}
.btn-default .badge {
  color: #fff;
  background-color: #333;
}
.btn-primary {
  color: #fff;
  background-color: #337ab7;
  border-color: #2e6da4;
}
.btn-primary:focus,
.btn-primary.focus {
  color: #fff;
  background-color: #286090;
  border-color: #122b40;
}
.btn-primary:hover {
  color: #fff;
  background-color: #286090;
  border-color: #204d74;
}
.btn-primary:active,
.btn-primary.active,
.open > .dropdown-toggle.btn-primary {
  color: #fff;
  background-color: #286090;
  border-color: #204d74;
}
.btn-primary:active:hover,
.btn-primary.active:hover,
.open > .dropdown-toggle.btn-primary:hover,
.btn-primary:active:focus,
.btn-primary.active:focus,
.open > .dropdown-toggle.btn-primary:focus,
.btn-primary:active.focus,
.btn-primary.active.focus,
.open > .dropdown-toggle.btn-primary.focus {
  color: #fff;
  background-color: #204d74;
  border-color: #122b40;
}
.btn-primary:active,
.btn-primary.active,
.open > .dropdown-toggle.btn-primary {
  background-image: none;
}
.btn-primary.disabled:hover,
.btn-primary[disabled]:hover,
fieldset[disabled] .btn-primary:hover,
.btn-primary.disabled:focus,
.btn-primary[disabled]:focus,
fieldset[disabled] .btn-primary:focus,
.btn-primary.disabled.focus,
.btn-primary[disabled].focus,
fieldset[disabled] .btn-primary.focus {
  background-color: #337ab7;
  border-color: #2e6da4;
}
.btn-primary .badge {
  color: #337ab7;
  background-color: #fff;
}
.btn-success {
  color: #fff;
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.btn-success:focus,
.btn-success.focus {
  color: #fff;
  background-color: #449d44;
  border-color: #255625;
}
.btn-success:hover {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.btn-success:active,
.btn-success.active,
.open > .dropdown-toggle.btn-success {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.btn-success:active:hover,
.btn-success.active:hover,
.open > .dropdown-toggle.btn-success:hover,
.btn-success:active:focus,
.btn-success.active:focus,
.open > .dropdown-toggle.btn-success:focus,
.btn-success:active.focus,
.btn-success.active.focus,
.open > .dropdown-toggle.btn-success.focus {
  color: #fff;
  background-color: #398439;
  border-color: #255625;
}
.btn-success:active,
.btn-success.active,
.open > .dropdown-toggle.btn-success {
  background-image: none;
}
.btn-success.disabled:hover,
.btn-success[disabled]:hover,
fieldset[disabled] .btn-success:hover,
.btn-success.disabled:focus,
.btn-success[disabled]:focus,
fieldset[disabled] .btn-success:focus,
.btn-success.disabled.focus,
.btn-success[disabled].focus,
fieldset[disabled] .btn-success.focus {
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.btn-success .badge {
  color: #5cb85c;
  background-color: #fff;
}
.btn-info {
  color: #fff;
  background-color: #5bc0de;
  border-color: #46b8da;
}
.btn-info:focus,
.btn-info.focus {
  color: #fff;
  background-color: #31b0d5;
  border-color: #1b6d85;
}
.btn-info:hover {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.btn-info:active,
.btn-info.active,
.open > .dropdown-toggle.btn-info {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.btn-info:active:hover,
.btn-info.active:hover,
.open > .dropdown-toggle.btn-info:hover,
.btn-info:active:focus,
.btn-info.active:focus,
.open > .dropdown-toggle.btn-info:focus,
.btn-info:active.focus,
.btn-info.active.focus,
.open > .dropdown-toggle.btn-info.focus {
  color: #fff;
  background-color: #269abc;
  border-color: #1b6d85;
}
.btn-info:active,
.btn-info.active,
.open > .dropdown-toggle.btn-info {
  background-image: none;
}
.btn-info.disabled:hover,
.btn-info[disabled]:hover,
fieldset[disabled] .btn-info:hover,
.btn-info.disabled:focus,
.btn-info[disabled]:focus,
fieldset[disabled] .btn-info:focus,
.btn-info.disabled.focus,
.btn-info[disabled].focus,
fieldset[disabled] .btn-info.focus {
  background-color: #5bc0de;
  border-color: #46b8da;
}
.btn-info .badge {
  color: #5bc0de;
  background-color: #fff;
}
.btn-warning {
  color: #fff;
  background-color: #f0ad4e;
  border-color: #eea236;
}
.btn-warning:focus,
.btn-warning.focus {
  color: #fff;
  background-color: #ec971f;
  border-color: #985f0d;
}
.btn-warning:hover {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.btn-warning:active,
.btn-warning.active,
.open > .dropdown-toggle.btn-warning {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.btn-warning:active:hover,
.btn-warning.active:hover,
.open > .dropdown-toggle.btn-warning:hover,
.btn-warning:active:focus,
.btn-warning.active:focus,
.open > .dropdown-toggle.btn-warning:focus,
.btn-warning:active.focus,
.btn-warning.active.focus,
.open > .dropdown-toggle.btn-warning.focus {
  color: #fff;
  background-color: #d58512;
  border-color: #985f0d;
}
.btn-warning:active,
.btn-warning.active,
.open > .dropdown-toggle.btn-warning {
  background-image: none;
}
.btn-warning.disabled:hover,
.btn-warning[disabled]:hover,
fieldset[disabled] .btn-warning:hover,
.btn-warning.disabled:focus,
.btn-warning[disabled]:focus,
fieldset[disabled] .btn-warning:focus,
.btn-warning.disabled.focus,
.btn-warning[disabled].focus,
fieldset[disabled] .btn-warning.focus {
  background-color: #f0ad4e;
  border-color: #eea236;
}
.btn-warning .badge {
  color: #f0ad4e;
  background-color: #fff;
}
.btn-danger {
  color: #fff;
  background-color: #d9534f;
  border-color: #d43f3a;
}
.btn-danger:focus,
.btn-danger.focus {
  color: #fff;
  background-color: #c9302c;
  border-color: #761c19;
}
.btn-danger:hover {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.btn-danger:active,
.btn-danger.active,
.open > .dropdown-toggle.btn-danger {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.btn-danger:active:hover,
.btn-danger.active:hover,
.open > .dropdown-toggle.btn-danger:hover,
.btn-danger:active:focus,
.btn-danger.active:focus,
.open > .dropdown-toggle.btn-danger:focus,
.btn-danger:active.focus,
.btn-danger.active.focus,
.open > .dropdown-toggle.btn-danger.focus {
  color: #fff;
  background-color: #ac2925;
  border-color: #761c19;
}
.btn-danger:active,
.btn-danger.active,
.open > .dropdown-toggle.btn-danger {
  background-image: none;
}
.btn-danger.disabled:hover,
.btn-danger[disabled]:hover,
fieldset[disabled] .btn-danger:hover,
.btn-danger.disabled:focus,
.btn-danger[disabled]:focus,
fieldset[disabled] .btn-danger:focus,
.btn-danger.disabled.focus,
.btn-danger[disabled].focus,
fieldset[disabled] .btn-danger.focus {
  background-color: #d9534f;
  border-color: #d43f3a;
}
.btn-danger .badge {
  color: #d9534f;
  background-color: #fff;
}
.btn-link {
  color: #337ab7;
  font-weight: normal;
  border-radius: 0;
}
.btn-link,
.btn-link:active,
.btn-link.active,
.btn-link[disabled],
fieldset[disabled] .btn-link {
  background-color: transparent;
  -webkit-box-shadow: none;
  box-shadow: none;
}
.btn-link,
.btn-link:hover,
.btn-link:focus,
.btn-link:active {
  border-color: transparent;
}
.btn-link:hover,
.btn-link:focus {
  color: #23527c;
  text-decoration: underline;
  background-color: transparent;
}
.btn-link[disabled]:hover,
fieldset[disabled] .btn-link:hover,
.btn-link[disabled]:focus,
fieldset[disabled] .btn-link:focus {
  color: #777777;
  text-decoration: none;
}
.btn-lg,
.btn-group-lg > .btn {
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
.btn-sm,
.btn-group-sm > .btn {
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.btn-xs,
.btn-group-xs > .btn {
  padding: 1px 5px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.btn-block {
  display: block;
  width: 100%;
}
.btn-block + .btn-block {
  margin-top: 5px;
}
input[type="submit"].btn-block,
input[type="reset"].btn-block,
input[type="button"].btn-block {
  width: 100%;
}
.fade {
  opacity: 0;
  -webkit-transition: opacity 0.15s linear;
  -o-transition: opacity 0.15s linear;
  transition: opacity 0.15s linear;
}
.fade.in {
  opacity: 1;
}
.collapse {
  display: none;
}
.collapse.in {
  display: block;
}
tr.collapse.in {
  display: table-row;
}
tbody.collapse.in {
  display: table-row-group;
}
.collapsing {
  position: relative;
  height: 0;
  overflow: hidden;
  -webkit-transition-property: height, visibility;
  transition-property: height, visibility;
  -webkit-transition-duration: 0.35s;
  transition-duration: 0.35s;
  -webkit-transition-timing-function: ease;
  transition-timing-function: ease;
}
.caret {
  display: inline-block;
  width: 0;
  height: 0;
  margin-left: 2px;
  vertical-align: middle;
  border-top: 4px dashed;
  border-top: 4px solid \9;
  border-right: 4px solid transparent;
  border-left: 4px solid transparent;
}
.dropup,
.dropdown {
  position: relative;
}
.dropdown-toggle:focus {
  outline: 0;
}
.dropdown-menu {
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 1000;
  display: none;
  float: left;
  min-width: 160px;
  padding: 5px 0;
  margin: 2px 0 0;
  list-style: none;
  font-size: 13px;
  text-align: left;
  background-color: #fff;
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.15);
  border-radius: 2px;
  -webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
  background-clip: padding-box;
}
.dropdown-menu.pull-right {
  right: 0;
  left: auto;
}
.dropdown-menu .divider {
  height: 1px;
  margin: 8px 0;
  overflow: hidden;
  background-color: #e5e5e5;
}
.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: normal;
  line-height: 1.42857143;
  color: #333333;
  white-space: nowrap;
}
.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  text-decoration: none;
  color: #262626;
  background-color: #f5f5f5;
}
.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #fff;
  text-decoration: none;
  outline: 0;
  background-color: #337ab7;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #777777;
}
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
  cursor: not-allowed;
}
.open > .dropdown-menu {
  display: block;
}
.open > a {
  outline: 0;
}
.dropdown-menu-right {
  left: auto;
  right: 0;
}
.dropdown-menu-left {
  left: 0;
  right: auto;
}
.dropdown-header {
  display: block;
  padding: 3px 20px;
  font-size: 12px;
  line-height: 1.42857143;
  color: #777777;
  white-space: nowrap;
}
.dropdown-backdrop {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  top: 0;
  z-index: 990;
}
.pull-right > .dropdown-menu {
  right: 0;
  left: auto;
}
.dropup .caret,
.navbar-fixed-bottom .dropdown .caret {
  border-top: 0;
  border-bottom: 4px dashed;
  border-bottom: 4px solid \9;
  content: "";
}
.dropup .dropdown-menu,
.navbar-fixed-bottom .dropdown .dropdown-menu {
  top: auto;
  bottom: 100%;
  margin-bottom: 2px;
}
@media (min-width: 541px) {
  .navbar-right .dropdown-menu {
    left: auto;
    right: 0;
  }
  .navbar-right .dropdown-menu-left {
    left: 0;
    right: auto;
  }
}
.btn-group,
.btn-group-vertical {
  position: relative;
  display: inline-block;
  vertical-align: middle;
}
.btn-group > .btn,
.btn-group-vertical > .btn {
  position: relative;
  float: left;
}
.btn-group > .btn:hover,
.btn-group-vertical > .btn:hover,
.btn-group > .btn:focus,
.btn-group-vertical > .btn:focus,
.btn-group > .btn:active,
.btn-group-vertical > .btn:active,
.btn-group > .btn.active,
.btn-group-vertical > .btn.active {
  z-index: 2;
}
.btn-group .btn + .btn,
.btn-group .btn + .btn-group,
.btn-group .btn-group + .btn,
.btn-group .btn-group + .btn-group {
  margin-left: -1px;
}
.btn-toolbar {
  margin-left: -5px;
}
.btn-toolbar .btn,
.btn-toolbar .btn-group,
.btn-toolbar .input-group {
  float: left;
}
.btn-toolbar > .btn,
.btn-toolbar > .btn-group,
.btn-toolbar > .input-group {
  margin-left: 5px;
}
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-left: 8px;
  padding-right: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-left: 12px;
  padding-right: 12px;
}
.btn-group.open .dropdown-toggle {
  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  -webkit-box-shadow: none;
  box-shadow: none;
}
.btn .caret {
  margin-left: 0;
}
.btn-lg .caret {
  border-width: 5px 5px 0;
  border-bottom-width: 0;
}
.dropup .btn-lg .caret {
  border-width: 0 5px 5px;
}
.btn-group-vertical > .btn,
.btn-group-vertical > .btn-group,
.btn-group-vertical > .btn-group > .btn {
  display: block;
  float: none;
  width: 100%;
  max-width: 100%;
}
.btn-group-vertical > .btn-group > .btn {
  float: none;
}
.btn-group-vertical > .btn + .btn,
.btn-group-vertical > .btn + .btn-group,
.btn-group-vertical > .btn-group + .btn,
.btn-group-vertical > .btn-group + .btn-group {
  margin-top: -1px;
  margin-left: 0;
}
.btn-group-vertical > .btn:not(:first-child):not(:last-child) {
  border-radius: 0;
}
.btn-group-vertical > .btn:first-child:not(:last-child) {
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group-vertical > .btn:last-child:not(:first-child) {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
  border-bottom-right-radius: 2px;
  border-bottom-left-radius: 2px;
}
.btn-group-vertical > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group-vertical > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group-vertical > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group-vertical > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.btn-group-justified {
  display: table;
  width: 100%;
  table-layout: fixed;
  border-collapse: separate;
}
.btn-group-justified > .btn,
.btn-group-justified > .btn-group {
  float: none;
  display: table-cell;
  width: 1%;
}
.btn-group-justified > .btn-group .btn {
  width: 100%;
}
.btn-group-justified > .btn-group .dropdown-menu {
  left: auto;
}
[data-toggle="buttons"] > .btn input[type="radio"],
[data-toggle="buttons"] > .btn-group > .btn input[type="radio"],
[data-toggle="buttons"] > .btn input[type="checkbox"],
[data-toggle="buttons"] > .btn-group > .btn input[type="checkbox"] {
  position: absolute;
  clip: rect(0, 0, 0, 0);
  pointer-events: none;
}
.input-group {
  position: relative;
  display: table;
  border-collapse: separate;
}
.input-group[class*="col-"] {
  float: none;
  padding-left: 0;
  padding-right: 0;
}
.input-group .form-control {
  position: relative;
  z-index: 2;
  float: left;
  width: 100%;
  margin-bottom: 0;
}
.input-group .form-control:focus {
  z-index: 3;
}
.input-group-lg > .form-control,
.input-group-lg > .input-group-addon,
.input-group-lg > .input-group-btn > .btn {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
select.input-group-lg > .form-control,
select.input-group-lg > .input-group-addon,
select.input-group-lg > .input-group-btn > .btn {
  height: 45px;
  line-height: 45px;
}
textarea.input-group-lg > .form-control,
textarea.input-group-lg > .input-group-addon,
textarea.input-group-lg > .input-group-btn > .btn,
select[multiple].input-group-lg > .form-control,
select[multiple].input-group-lg > .input-group-addon,
select[multiple].input-group-lg > .input-group-btn > .btn {
  height: auto;
}
.input-group-sm > .form-control,
.input-group-sm > .input-group-addon,
.input-group-sm > .input-group-btn > .btn {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
select.input-group-sm > .form-control,
select.input-group-sm > .input-group-addon,
select.input-group-sm > .input-group-btn > .btn {
  height: 30px;
  line-height: 30px;
}
textarea.input-group-sm > .form-control,
textarea.input-group-sm > .input-group-addon,
textarea.input-group-sm > .input-group-btn > .btn,
select[multiple].input-group-sm > .form-control,
select[multiple].input-group-sm > .input-group-addon,
select[multiple].input-group-sm > .input-group-btn > .btn {
  height: auto;
}
.input-group-addon,
.input-group-btn,
.input-group .form-control {
  display: table-cell;
}
.input-group-addon:not(:first-child):not(:last-child),
.input-group-btn:not(:first-child):not(:last-child),
.input-group .form-control:not(:first-child):not(:last-child) {
  border-radius: 0;
}
.input-group-addon,
.input-group-btn {
  width: 1%;
  white-space: nowrap;
  vertical-align: middle;
}
.input-group-addon {
  padding: 6px 12px;
  font-size: 13px;
  font-weight: normal;
  line-height: 1;
  color: #555555;
  text-align: center;
  background-color: #eeeeee;
  border: 1px solid #ccc;
  border-radius: 2px;
}
.input-group-addon.input-sm {
  padding: 5px 10px;
  font-size: 12px;
  border-radius: 1px;
}
.input-group-addon.input-lg {
  padding: 10px 16px;
  font-size: 17px;
  border-radius: 3px;
}
.input-group-addon input[type="radio"],
.input-group-addon input[type="checkbox"] {
  margin-top: 0;
}
.input-group .form-control:first-child,
.input-group-addon:first-child,
.input-group-btn:first-child > .btn,
.input-group-btn:first-child > .btn-group > .btn,
.input-group-btn:first-child > .dropdown-toggle,
.input-group-btn:last-child > .btn:not(:last-child):not(.dropdown-toggle),
.input-group-btn:last-child > .btn-group:not(:last-child) > .btn {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.input-group-addon:first-child {
  border-right: 0;
}
.input-group .form-control:last-child,
.input-group-addon:last-child,
.input-group-btn:last-child > .btn,
.input-group-btn:last-child > .btn-group > .btn,
.input-group-btn:last-child > .dropdown-toggle,
.input-group-btn:first-child > .btn:not(:first-child),
.input-group-btn:first-child > .btn-group:not(:first-child) > .btn {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.input-group-addon:last-child {
  border-left: 0;
}
.input-group-btn {
  position: relative;
  font-size: 0;
  white-space: nowrap;
}
.input-group-btn > .btn {
  position: relative;
}
.input-group-btn > .btn + .btn {
  margin-left: -1px;
}
.input-group-btn > .btn:hover,
.input-group-btn > .btn:focus,
.input-group-btn > .btn:active {
  z-index: 2;
}
.input-group-btn:first-child > .btn,
.input-group-btn:first-child > .btn-group {
  margin-right: -1px;
}
.input-group-btn:last-child > .btn,
.input-group-btn:last-child > .btn-group {
  z-index: 2;
  margin-left: -1px;
}
.nav {
  margin-bottom: 0;
  padding-left: 0;
  list-style: none;
}
.nav > li {
  position: relative;
  display: block;
}
.nav > li > a {
  position: relative;
  display: block;
  padding: 10px 15px;
}
.nav > li > a:hover,
.nav > li > a:focus {
  text-decoration: none;
  background-color: #eeeeee;
}
.nav > li.disabled > a {
  color: #777777;
}
.nav > li.disabled > a:hover,
.nav > li.disabled > a:focus {
  color: #777777;
  text-decoration: none;
  background-color: transparent;
  cursor: not-allowed;
}
.nav .open > a,
.nav .open > a:hover,
.nav .open > a:focus {
  background-color: #eeeeee;
  border-color: #337ab7;
}
.nav .nav-divider {
  height: 1px;
  margin: 8px 0;
  overflow: hidden;
  background-color: #e5e5e5;
}
.nav > li > a > img {
  max-width: none;
}
.nav-tabs {
  border-bottom: 1px solid #ddd;
}
.nav-tabs > li {
  float: left;
  margin-bottom: -1px;
}
.nav-tabs > li > a {
  margin-right: 2px;
  line-height: 1.42857143;
  border: 1px solid transparent;
  border-radius: 2px 2px 0 0;
}
.nav-tabs > li > a:hover {
  border-color: #eeeeee #eeeeee #ddd;
}
.nav-tabs > li.active > a,
.nav-tabs > li.active > a:hover,
.nav-tabs > li.active > a:focus {
  color: #555555;
  background-color: #fff;
  border: 1px solid #ddd;
  border-bottom-color: transparent;
  cursor: default;
}
.nav-tabs.nav-justified {
  width: 100%;
  border-bottom: 0;
}
.nav-tabs.nav-justified > li {
  float: none;
}
.nav-tabs.nav-justified > li > a {
  text-align: center;
  margin-bottom: 5px;
}
.nav-tabs.nav-justified > .dropdown .dropdown-menu {
  top: auto;
  left: auto;
}
@media (min-width: 768px) {
  .nav-tabs.nav-justified > li {
    display: table-cell;
    width: 1%;
  }
  .nav-tabs.nav-justified > li > a {
    margin-bottom: 0;
  }
}
.nav-tabs.nav-justified > li > a {
  margin-right: 0;
  border-radius: 2px;
}
.nav-tabs.nav-justified > .active > a,
.nav-tabs.nav-justified > .active > a:hover,
.nav-tabs.nav-justified > .active > a:focus {
  border: 1px solid #ddd;
}
@media (min-width: 768px) {
  .nav-tabs.nav-justified > li > a {
    border-bottom: 1px solid #ddd;
    border-radius: 2px 2px 0 0;
  }
  .nav-tabs.nav-justified > .active > a,
  .nav-tabs.nav-justified > .active > a:hover,
  .nav-tabs.nav-justified > .active > a:focus {
    border-bottom-color: #fff;
  }
}
.nav-pills > li {
  float: left;
}
.nav-pills > li > a {
  border-radius: 2px;
}
.nav-pills > li + li {
  margin-left: 2px;
}
.nav-pills > li.active > a,
.nav-pills > li.active > a:hover,
.nav-pills > li.active > a:focus {
  color: #fff;
  background-color: #337ab7;
}
.nav-stacked > li {
  float: none;
}
.nav-stacked > li + li {
  margin-top: 2px;
  margin-left: 0;
}
.nav-justified {
  width: 100%;
}
.nav-justified > li {
  float: none;
}
.nav-justified > li > a {
  text-align: center;
  margin-bottom: 5px;
}
.nav-justified > .dropdown .dropdown-menu {
  top: auto;
  left: auto;
}
@media (min-width: 768px) {
  .nav-justified > li {
    display: table-cell;
    width: 1%;
  }
  .nav-justified > li > a {
    margin-bottom: 0;
  }
}
.nav-tabs-justified {
  border-bottom: 0;
}
.nav-tabs-justified > li > a {
  margin-right: 0;
  border-radius: 2px;
}
.nav-tabs-justified > .active > a,
.nav-tabs-justified > .active > a:hover,
.nav-tabs-justified > .active > a:focus {
  border: 1px solid #ddd;
}
@media (min-width: 768px) {
  .nav-tabs-justified > li > a {
    border-bottom: 1px solid #ddd;
    border-radius: 2px 2px 0 0;
  }
  .nav-tabs-justified > .active > a,
  .nav-tabs-justified > .active > a:hover,
  .nav-tabs-justified > .active > a:focus {
    border-bottom-color: #fff;
  }
}
.tab-content > .tab-pane {
  display: none;
}
.tab-content > .active {
  display: block;
}
.nav-tabs .dropdown-menu {
  margin-top: -1px;
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.navbar {
  position: relative;
  min-height: 30px;
  margin-bottom: 18px;
  border: 1px solid transparent;
}
@media (min-width: 541px) {
  .navbar {
    border-radius: 2px;
  }
}
@media (min-width: 541px) {
  .navbar-header {
    float: left;
  }
}
.navbar-collapse {
  overflow-x: visible;
  padding-right: 0px;
  padding-left: 0px;
  border-top: 1px solid transparent;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
  -webkit-overflow-scrolling: touch;
}
.navbar-collapse.in {
  overflow-y: auto;
}
@media (min-width: 541px) {
  .navbar-collapse {
    width: auto;
    border-top: 0;
    box-shadow: none;
  }
  .navbar-collapse.collapse {
    display: block !important;
    height: auto !important;
    padding-bottom: 0;
    overflow: visible !important;
  }
  .navbar-collapse.in {
    overflow-y: visible;
  }
  .navbar-fixed-top .navbar-collapse,
  .navbar-static-top .navbar-collapse,
  .navbar-fixed-bottom .navbar-collapse {
    padding-left: 0;
    padding-right: 0;
  }
}
.navbar-fixed-top .navbar-collapse,
.navbar-fixed-bottom .navbar-collapse {
  max-height: 340px;
}
@media (max-device-width: 540px) and (orientation: landscape) {
  .navbar-fixed-top .navbar-collapse,
  .navbar-fixed-bottom .navbar-collapse {
    max-height: 200px;
  }
}
.container > .navbar-header,
.container-fluid > .navbar-header,
.container > .navbar-collapse,
.container-fluid > .navbar-collapse {
  margin-right: 0px;
  margin-left: 0px;
}
@media (min-width: 541px) {
  .container > .navbar-header,
  .container-fluid > .navbar-header,
  .container > .navbar-collapse,
  .container-fluid > .navbar-collapse {
    margin-right: 0;
    margin-left: 0;
  }
}
.navbar-static-top {
  z-index: 1000;
  border-width: 0 0 1px;
}
@media (min-width: 541px) {
  .navbar-static-top {
    border-radius: 0;
  }
}
.navbar-fixed-top,
.navbar-fixed-bottom {
  position: fixed;
  right: 0;
  left: 0;
  z-index: 1030;
}
@media (min-width: 541px) {
  .navbar-fixed-top,
  .navbar-fixed-bottom {
    border-radius: 0;
  }
}
.navbar-fixed-top {
  top: 0;
  border-width: 0 0 1px;
}
.navbar-fixed-bottom {
  bottom: 0;
  margin-bottom: 0;
  border-width: 1px 0 0;
}
.navbar-brand {
  float: left;
  padding: 6px 0px;
  font-size: 17px;
  line-height: 18px;
  height: 30px;
}
.navbar-brand:hover,
.navbar-brand:focus {
  text-decoration: none;
}
.navbar-brand > img {
  display: block;
}
@media (min-width: 541px) {
  .navbar > .container .navbar-brand,
  .navbar > .container-fluid .navbar-brand {
    margin-left: 0px;
  }
}
.navbar-toggle {
  position: relative;
  float: right;
  margin-right: 0px;
  padding: 9px 10px;
  margin-top: -2px;
  margin-bottom: -2px;
  background-color: transparent;
  background-image: none;
  border: 1px solid transparent;
  border-radius: 2px;
}
.navbar-toggle:focus {
  outline: 0;
}
.navbar-toggle .icon-bar {
  display: block;
  width: 22px;
  height: 2px;
  border-radius: 1px;
}
.navbar-toggle .icon-bar + .icon-bar {
  margin-top: 4px;
}
@media (min-width: 541px) {
  .navbar-toggle {
    display: none;
  }
}
.navbar-nav {
  margin: 3px 0px;
}
.navbar-nav > li > a {
  padding-top: 10px;
  padding-bottom: 10px;
  line-height: 18px;
}
@media (max-width: 540px) {
  .navbar-nav .open .dropdown-menu {
    position: static;
    float: none;
    width: auto;
    margin-top: 0;
    background-color: transparent;
    border: 0;
    box-shadow: none;
  }
  .navbar-nav .open .dropdown-menu > li > a,
  .navbar-nav .open .dropdown-menu .dropdown-header {
    padding: 5px 15px 5px 25px;
  }
  .navbar-nav .open .dropdown-menu > li > a {
    line-height: 18px;
  }
  .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-nav .open .dropdown-menu > li > a:focus {
    background-image: none;
  }
}
@media (min-width: 541px) {
  .navbar-nav {
    float: left;
    margin: 0;
  }
  .navbar-nav > li {
    float: left;
  }
  .navbar-nav > li > a {
    padding-top: 6px;
    padding-bottom: 6px;
  }
}
.navbar-form {
  margin-left: 0px;
  margin-right: 0px;
  padding: 10px 0px;
  border-top: 1px solid transparent;
  border-bottom: 1px solid transparent;
  -webkit-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);
  margin-top: -1px;
  margin-bottom: -1px;
}
@media (min-width: 768px) {
  .navbar-form .form-group {
    display: inline-block;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .form-control {
    display: inline-block;
    width: auto;
    vertical-align: middle;
  }
  .navbar-form .form-control-static {
    display: inline-block;
  }
  .navbar-form .input-group {
    display: inline-table;
    vertical-align: middle;
  }
  .navbar-form .input-group .input-group-addon,
  .navbar-form .input-group .input-group-btn,
  .navbar-form .input-group .form-control {
    width: auto;
  }
  .navbar-form .input-group > .form-control {
    width: 100%;
  }
  .navbar-form .control-label {
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .radio,
  .navbar-form .checkbox {
    display: inline-block;
    margin-top: 0;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .radio label,
  .navbar-form .checkbox label {
    padding-left: 0;
  }
  .navbar-form .radio input[type="radio"],
  .navbar-form .checkbox input[type="checkbox"] {
    position: relative;
    margin-left: 0;
  }
  .navbar-form .has-feedback .form-control-feedback {
    top: 0;
  }
}
@media (max-width: 540px) {
  .navbar-form .form-group {
    margin-bottom: 5px;
  }
  .navbar-form .form-group:last-child {
    margin-bottom: 0;
  }
}
@media (min-width: 541px) {
  .navbar-form {
    width: auto;
    border: 0;
    margin-left: 0;
    margin-right: 0;
    padding-top: 0;
    padding-bottom: 0;
    -webkit-box-shadow: none;
    box-shadow: none;
  }
}
.navbar-nav > li > .dropdown-menu {
  margin-top: 0;
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.navbar-fixed-bottom .navbar-nav > li > .dropdown-menu {
  margin-bottom: 0;
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.navbar-btn {
  margin-top: -1px;
  margin-bottom: -1px;
}
.navbar-btn.btn-sm {
  margin-top: 0px;
  margin-bottom: 0px;
}
.navbar-btn.btn-xs {
  margin-top: 4px;
  margin-bottom: 4px;
}
.navbar-text {
  margin-top: 6px;
  margin-bottom: 6px;
}
@media (min-width: 541px) {
  .navbar-text {
    float: left;
    margin-left: 0px;
    margin-right: 0px;
  }
}
@media (min-width: 541px) {
  .navbar-left {
    float: left !important;
    float: left;
  }
  .navbar-right {
    float: right !important;
    float: right;
    margin-right: 0px;
  }
  .navbar-right ~ .navbar-right {
    margin-right: 0;
  }
}
.navbar-default {
  background-color: #f8f8f8;
  border-color: #e7e7e7;
}
.navbar-default .navbar-brand {
  color: #777;
}
.navbar-default .navbar-brand:hover,
.navbar-default .navbar-brand:focus {
  color: #5e5e5e;
  background-color: transparent;
}
.navbar-default .navbar-text {
  color: #777;
}
.navbar-default .navbar-nav > li > a {
  color: #777;
}
.navbar-default .navbar-nav > li > a:hover,
.navbar-default .navbar-nav > li > a:focus {
  color: #333;
  background-color: transparent;
}
.navbar-default .navbar-nav > .active > a,
.navbar-default .navbar-nav > .active > a:hover,
.navbar-default .navbar-nav > .active > a:focus {
  color: #555;
  background-color: #e7e7e7;
}
.navbar-default .navbar-nav > .disabled > a,
.navbar-default .navbar-nav > .disabled > a:hover,
.navbar-default .navbar-nav > .disabled > a:focus {
  color: #ccc;
  background-color: transparent;
}
.navbar-default .navbar-toggle {
  border-color: #ddd;
}
.navbar-default .navbar-toggle:hover,
.navbar-default .navbar-toggle:focus {
  background-color: #ddd;
}
.navbar-default .navbar-toggle .icon-bar {
  background-color: #888;
}
.navbar-default .navbar-collapse,
.navbar-default .navbar-form {
  border-color: #e7e7e7;
}
.navbar-default .navbar-nav > .open > a,
.navbar-default .navbar-nav > .open > a:hover,
.navbar-default .navbar-nav > .open > a:focus {
  background-color: #e7e7e7;
  color: #555;
}
@media (max-width: 540px) {
  .navbar-default .navbar-nav .open .dropdown-menu > li > a {
    color: #777;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #333;
    background-color: transparent;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #555;
    background-color: #e7e7e7;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:focus {
    color: #ccc;
    background-color: transparent;
  }
}
.navbar-default .navbar-link {
  color: #777;
}
.navbar-default .navbar-link:hover {
  color: #333;
}
.navbar-default .btn-link {
  color: #777;
}
.navbar-default .btn-link:hover,
.navbar-default .btn-link:focus {
  color: #333;
}
.navbar-default .btn-link[disabled]:hover,
fieldset[disabled] .navbar-default .btn-link:hover,
.navbar-default .btn-link[disabled]:focus,
fieldset[disabled] .navbar-default .btn-link:focus {
  color: #ccc;
}
.navbar-inverse {
  background-color: #222;
  border-color: #080808;
}
.navbar-inverse .navbar-brand {
  color: #9d9d9d;
}
.navbar-inverse .navbar-brand:hover,
.navbar-inverse .navbar-brand:focus {
  color: #fff;
  background-color: transparent;
}
.navbar-inverse .navbar-text {
  color: #9d9d9d;
}
.navbar-inverse .navbar-nav > li > a {
  color: #9d9d9d;
}
.navbar-inverse .navbar-nav > li > a:hover,
.navbar-inverse .navbar-nav > li > a:focus {
  color: #fff;
  background-color: transparent;
}
.navbar-inverse .navbar-nav > .active > a,
.navbar-inverse .navbar-nav > .active > a:hover,
.navbar-inverse .navbar-nav > .active > a:focus {
  color: #fff;
  background-color: #080808;
}
.navbar-inverse .navbar-nav > .disabled > a,
.navbar-inverse .navbar-nav > .disabled > a:hover,
.navbar-inverse .navbar-nav > .disabled > a:focus {
  color: #444;
  background-color: transparent;
}
.navbar-inverse .navbar-toggle {
  border-color: #333;
}
.navbar-inverse .navbar-toggle:hover,
.navbar-inverse .navbar-toggle:focus {
  background-color: #333;
}
.navbar-inverse .navbar-toggle .icon-bar {
  background-color: #fff;
}
.navbar-inverse .navbar-collapse,
.navbar-inverse .navbar-form {
  border-color: #101010;
}
.navbar-inverse .navbar-nav > .open > a,
.navbar-inverse .navbar-nav > .open > a:hover,
.navbar-inverse .navbar-nav > .open > a:focus {
  background-color: #080808;
  color: #fff;
}
@media (max-width: 540px) {
  .navbar-inverse .navbar-nav .open .dropdown-menu > .dropdown-header {
    border-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu .divider {
    background-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a {
    color: #9d9d9d;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #fff;
    background-color: transparent;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #fff;
    background-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:focus {
    color: #444;
    background-color: transparent;
  }
}
.navbar-inverse .navbar-link {
  color: #9d9d9d;
}
.navbar-inverse .navbar-link:hover {
  color: #fff;
}
.navbar-inverse .btn-link {
  color: #9d9d9d;
}
.navbar-inverse .btn-link:hover,
.navbar-inverse .btn-link:focus {
  color: #fff;
}
.navbar-inverse .btn-link[disabled]:hover,
fieldset[disabled] .navbar-inverse .btn-link:hover,
.navbar-inverse .btn-link[disabled]:focus,
fieldset[disabled] .navbar-inverse .btn-link:focus {
  color: #444;
}
.breadcrumb {
  padding: 8px 15px;
  margin-bottom: 18px;
  list-style: none;
  background-color: #f5f5f5;
  border-radius: 2px;
}
.breadcrumb > li {
  display: inline-block;
}
.breadcrumb > li + li:before {
  content: "/\00a0";
  padding: 0 5px;
  color: #5e5e5e;
}
.breadcrumb > .active {
  color: #777777;
}
.pagination {
  display: inline-block;
  padding-left: 0;
  margin: 18px 0;
  border-radius: 2px;
}
.pagination > li {
  display: inline;
}
.pagination > li > a,
.pagination > li > span {
  position: relative;
  float: left;
  padding: 6px 12px;
  line-height: 1.42857143;
  text-decoration: none;
  color: #337ab7;
  background-color: #fff;
  border: 1px solid #ddd;
  margin-left: -1px;
}
.pagination > li:first-child > a,
.pagination > li:first-child > span {
  margin-left: 0;
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.pagination > li:last-child > a,
.pagination > li:last-child > span {
  border-bottom-right-radius: 2px;
  border-top-right-radius: 2px;
}
.pagination > li > a:hover,
.pagination > li > span:hover,
.pagination > li > a:focus,
.pagination > li > span:focus {
  z-index: 2;
  color: #23527c;
  background-color: #eeeeee;
  border-color: #ddd;
}
.pagination > .active > a,
.pagination > .active > span,
.pagination > .active > a:hover,
.pagination > .active > span:hover,
.pagination > .active > a:focus,
.pagination > .active > span:focus {
  z-index: 3;
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
  cursor: default;
}
.pagination > .disabled > span,
.pagination > .disabled > span:hover,
.pagination > .disabled > span:focus,
.pagination > .disabled > a,
.pagination > .disabled > a:hover,
.pagination > .disabled > a:focus {
  color: #777777;
  background-color: #fff;
  border-color: #ddd;
  cursor: not-allowed;
}
.pagination-lg > li > a,
.pagination-lg > li > span {
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
}
.pagination-lg > li:first-child > a,
.pagination-lg > li:first-child > span {
  border-bottom-left-radius: 3px;
  border-top-left-radius: 3px;
}
.pagination-lg > li:last-child > a,
.pagination-lg > li:last-child > span {
  border-bottom-right-radius: 3px;
  border-top-right-radius: 3px;
}
.pagination-sm > li > a,
.pagination-sm > li > span {
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
}
.pagination-sm > li:first-child > a,
.pagination-sm > li:first-child > span {
  border-bottom-left-radius: 1px;
  border-top-left-radius: 1px;
}
.pagination-sm > li:last-child > a,
.pagination-sm > li:last-child > span {
  border-bottom-right-radius: 1px;
  border-top-right-radius: 1px;
}
.pager {
  padding-left: 0;
  margin: 18px 0;
  list-style: none;
  text-align: center;
}
.pager li {
  display: inline;
}
.pager li > a,
.pager li > span {
  display: inline-block;
  padding: 5px 14px;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 15px;
}
.pager li > a:hover,
.pager li > a:focus {
  text-decoration: none;
  background-color: #eeeeee;
}
.pager .next > a,
.pager .next > span {
  float: right;
}
.pager .previous > a,
.pager .previous > span {
  float: left;
}
.pager .disabled > a,
.pager .disabled > a:hover,
.pager .disabled > a:focus,
.pager .disabled > span {
  color: #777777;
  background-color: #fff;
  cursor: not-allowed;
}
.label {
  display: inline;
  padding: .2em .6em .3em;
  font-size: 75%;
  font-weight: bold;
  line-height: 1;
  color: #fff;
  text-align: center;
  white-space: nowrap;
  vertical-align: baseline;
  border-radius: .25em;
}
a.label:hover,
a.label:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}
.label:empty {
  display: none;
}
.btn .label {
  position: relative;
  top: -1px;
}
.label-default {
  background-color: #777777;
}
.label-default[href]:hover,
.label-default[href]:focus {
  background-color: #5e5e5e;
}
.label-primary {
  background-color: #337ab7;
}
.label-primary[href]:hover,
.label-primary[href]:focus {
  background-color: #286090;
}
.label-success {
  background-color: #5cb85c;
}
.label-success[href]:hover,
.label-success[href]:focus {
  background-color: #449d44;
}
.label-info {
  background-color: #5bc0de;
}
.label-info[href]:hover,
.label-info[href]:focus {
  background-color: #31b0d5;
}
.label-warning {
  background-color: #f0ad4e;
}
.label-warning[href]:hover,
.label-warning[href]:focus {
  background-color: #ec971f;
}
.label-danger {
  background-color: #d9534f;
}
.label-danger[href]:hover,
.label-danger[href]:focus {
  background-color: #c9302c;
}
.badge {
  display: inline-block;
  min-width: 10px;
  padding: 3px 7px;
  font-size: 12px;
  font-weight: bold;
  color: #fff;
  line-height: 1;
  vertical-align: middle;
  white-space: nowrap;
  text-align: center;
  background-color: #777777;
  border-radius: 10px;
}
.badge:empty {
  display: none;
}
.btn .badge {
  position: relative;
  top: -1px;
}
.btn-xs .badge,
.btn-group-xs > .btn .badge {
  top: 0;
  padding: 1px 5px;
}
a.badge:hover,
a.badge:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}
.list-group-item.active > .badge,
.nav-pills > .active > a > .badge {
  color: #337ab7;
  background-color: #fff;
}
.list-group-item > .badge {
  float: right;
}
.list-group-item > .badge + .badge {
  margin-right: 5px;
}
.nav-pills > li > a > .badge {
  margin-left: 3px;
}
.jumbotron {
  padding-top: 30px;
  padding-bottom: 30px;
  margin-bottom: 30px;
  color: inherit;
  background-color: #eeeeee;
}
.jumbotron h1,
.jumbotron .h1 {
  color: inherit;
}
.jumbotron p {
  margin-bottom: 15px;
  font-size: 20px;
  font-weight: 200;
}
.jumbotron > hr {
  border-top-color: #d5d5d5;
}
.container .jumbotron,
.container-fluid .jumbotron {
  border-radius: 3px;
  padding-left: 0px;
  padding-right: 0px;
}
.jumbotron .container {
  max-width: 100%;
}
@media screen and (min-width: 768px) {
  .jumbotron {
    padding-top: 48px;
    padding-bottom: 48px;
  }
  .container .jumbotron,
  .container-fluid .jumbotron {
    padding-left: 60px;
    padding-right: 60px;
  }
  .jumbotron h1,
  .jumbotron .h1 {
    font-size: 59px;
  }
}
.thumbnail {
  display: block;
  padding: 4px;
  margin-bottom: 18px;
  line-height: 1.42857143;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 2px;
  -webkit-transition: border 0.2s ease-in-out;
  -o-transition: border 0.2s ease-in-out;
  transition: border 0.2s ease-in-out;
}
.thumbnail > img,
.thumbnail a > img {
  margin-left: auto;
  margin-right: auto;
}
a.thumbnail:hover,
a.thumbnail:focus,
a.thumbnail.active {
  border-color: #337ab7;
}
.thumbnail .caption {
  padding: 9px;
  color: #000;
}
.alert {
  padding: 15px;
  margin-bottom: 18px;
  border: 1px solid transparent;
  border-radius: 2px;
}
.alert h4 {
  margin-top: 0;
  color: inherit;
}
.alert .alert-link {
  font-weight: bold;
}
.alert > p,
.alert > ul {
  margin-bottom: 0;
}
.alert > p + p {
  margin-top: 5px;
}
.alert-dismissable,
.alert-dismissible {
  padding-right: 35px;
}
.alert-dismissable .close,
.alert-dismissible .close {
  position: relative;
  top: -2px;
  right: -21px;
  color: inherit;
}
.alert-success {
  background-color: #dff0d8;
  border-color: #d6e9c6;
  color: #3c763d;
}
.alert-success hr {
  border-top-color: #c9e2b3;
}
.alert-success .alert-link {
  color: #2b542c;
}
.alert-info {
  background-color: #d9edf7;
  border-color: #bce8f1;
  color: #31708f;
}
.alert-info hr {
  border-top-color: #a6e1ec;
}
.alert-info .alert-link {
  color: #245269;
}
.alert-warning {
  background-color: #fcf8e3;
  border-color: #faebcc;
  color: #8a6d3b;
}
.alert-warning hr {
  border-top-color: #f7e1b5;
}
.alert-warning .alert-link {
  color: #66512c;
}
.alert-danger {
  background-color: #f2dede;
  border-color: #ebccd1;
  color: #a94442;
}
.alert-danger hr {
  border-top-color: #e4b9c0;
}
.alert-danger .alert-link {
  color: #843534;
}
@-webkit-keyframes progress-bar-stripes {
  from {
    background-position: 40px 0;
  }
  to {
    background-position: 0 0;
  }
}
@keyframes progress-bar-stripes {
  from {
    background-position: 40px 0;
  }
  to {
    background-position: 0 0;
  }
}
.progress {
  overflow: hidden;
  height: 18px;
  margin-bottom: 18px;
  background-color: #f5f5f5;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
}
.progress-bar {
  float: left;
  width: 0%;
  height: 100%;
  font-size: 12px;
  line-height: 18px;
  color: #fff;
  text-align: center;
  background-color: #337ab7;
  -webkit-box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  -webkit-transition: width 0.6s ease;
  -o-transition: width 0.6s ease;
  transition: width 0.6s ease;
}
.progress-striped .progress-bar,
.progress-bar-striped {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-size: 40px 40px;
}
.progress.active .progress-bar,
.progress-bar.active {
  -webkit-animation: progress-bar-stripes 2s linear infinite;
  -o-animation: progress-bar-stripes 2s linear infinite;
  animation: progress-bar-stripes 2s linear infinite;
}
.progress-bar-success {
  background-color: #5cb85c;
}
.progress-striped .progress-bar-success {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-info {
  background-color: #5bc0de;
}
.progress-striped .progress-bar-info {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-warning {
  background-color: #f0ad4e;
}
.progress-striped .progress-bar-warning {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-danger {
  background-color: #d9534f;
}
.progress-striped .progress-bar-danger {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.media {
  margin-top: 15px;
}
.media:first-child {
  margin-top: 0;
}
.media,
.media-body {
  zoom: 1;
  overflow: hidden;
}
.media-body {
  width: 10000px;
}
.media-object {
  display: block;
}
.media-object.img-thumbnail {
  max-width: none;
}
.media-right,
.media > .pull-right {
  padding-left: 10px;
}
.media-left,
.media > .pull-left {
  padding-right: 10px;
}
.media-left,
.media-right,
.media-body {
  display: table-cell;
  vertical-align: top;
}
.media-middle {
  vertical-align: middle;
}
.media-bottom {
  vertical-align: bottom;
}
.media-heading {
  margin-top: 0;
  margin-bottom: 5px;
}
.media-list {
  padding-left: 0;
  list-style: none;
}
.list-group {
  margin-bottom: 20px;
  padding-left: 0;
}
.list-group-item {
  position: relative;
  display: block;
  padding: 10px 15px;
  margin-bottom: -1px;
  background-color: #fff;
  border: 1px solid #ddd;
}
.list-group-item:first-child {
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
}
.list-group-item:last-child {
  margin-bottom: 0;
  border-bottom-right-radius: 2px;
  border-bottom-left-radius: 2px;
}
a.list-group-item,
button.list-group-item {
  color: #555;
}
a.list-group-item .list-group-item-heading,
button.list-group-item .list-group-item-heading {
  color: #333;
}
a.list-group-item:hover,
button.list-group-item:hover,
a.list-group-item:focus,
button.list-group-item:focus {
  text-decoration: none;
  color: #555;
  background-color: #f5f5f5;
}
button.list-group-item {
  width: 100%;
  text-align: left;
}
.list-group-item.disabled,
.list-group-item.disabled:hover,
.list-group-item.disabled:focus {
  background-color: #eeeeee;
  color: #777777;
  cursor: not-allowed;
}
.list-group-item.disabled .list-group-item-heading,
.list-group-item.disabled:hover .list-group-item-heading,
.list-group-item.disabled:focus .list-group-item-heading {
  color: inherit;
}
.list-group-item.disabled .list-group-item-text,
.list-group-item.disabled:hover .list-group-item-text,
.list-group-item.disabled:focus .list-group-item-text {
  color: #777777;
}
.list-group-item.active,
.list-group-item.active:hover,
.list-group-item.active:focus {
  z-index: 2;
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
}
.list-group-item.active .list-group-item-heading,
.list-group-item.active:hover .list-group-item-heading,
.list-group-item.active:focus .list-group-item-heading,
.list-group-item.active .list-group-item-heading > small,
.list-group-item.active:hover .list-group-item-heading > small,
.list-group-item.active:focus .list-group-item-heading > small,
.list-group-item.active .list-group-item-heading > .small,
.list-group-item.active:hover .list-group-item-heading > .small,
.list-group-item.active:focus .list-group-item-heading > .small {
  color: inherit;
}
.list-group-item.active .list-group-item-text,
.list-group-item.active:hover .list-group-item-text,
.list-group-item.active:focus .list-group-item-text {
  color: #c7ddef;
}
.list-group-item-success {
  color: #3c763d;
  background-color: #dff0d8;
}
a.list-group-item-success,
button.list-group-item-success {
  color: #3c763d;
}
a.list-group-item-success .list-group-item-heading,
button.list-group-item-success .list-group-item-heading {
  color: inherit;
}
a.list-group-item-success:hover,
button.list-group-item-success:hover,
a.list-group-item-success:focus,
button.list-group-item-success:focus {
  color: #3c763d;
  background-color: #d0e9c6;
}
a.list-group-item-success.active,
button.list-group-item-success.active,
a.list-group-item-success.active:hover,
button.list-group-item-success.active:hover,
a.list-group-item-success.active:focus,
button.list-group-item-success.active:focus {
  color: #fff;
  background-color: #3c763d;
  border-color: #3c763d;
}
.list-group-item-info {
  color: #31708f;
  background-color: #d9edf7;
}
a.list-group-item-info,
button.list-group-item-info {
  color: #31708f;
}
a.list-group-item-info .list-group-item-heading,
button.list-group-item-info .list-group-item-heading {
  color: inherit;
}
a.list-group-item-info:hover,
button.list-group-item-info:hover,
a.list-group-item-info:focus,
button.list-group-item-info:focus {
  color: #31708f;
  background-color: #c4e3f3;
}
a.list-group-item-info.active,
button.list-group-item-info.active,
a.list-group-item-info.active:hover,
button.list-group-item-info.active:hover,
a.list-group-item-info.active:focus,
button.list-group-item-info.active:focus {
  color: #fff;
  background-color: #31708f;
  border-color: #31708f;
}
.list-group-item-warning {
  color: #8a6d3b;
  background-color: #fcf8e3;
}
a.list-group-item-warning,
button.list-group-item-warning {
  color: #8a6d3b;
}
a.list-group-item-warning .list-group-item-heading,
button.list-group-item-warning .list-group-item-heading {
  color: inherit;
}
a.list-group-item-warning:hover,
button.list-group-item-warning:hover,
a.list-group-item-warning:focus,
button.list-group-item-warning:focus {
  color: #8a6d3b;
  background-color: #faf2cc;
}
a.list-group-item-warning.active,
button.list-group-item-warning.active,
a.list-group-item-warning.active:hover,
button.list-group-item-warning.active:hover,
a.list-group-item-warning.active:focus,
button.list-group-item-warning.active:focus {
  color: #fff;
  background-color: #8a6d3b;
  border-color: #8a6d3b;
}
.list-group-item-danger {
  color: #a94442;
  background-color: #f2dede;
}
a.list-group-item-danger,
button.list-group-item-danger {
  color: #a94442;
}
a.list-group-item-danger .list-group-item-heading,
button.list-group-item-danger .list-group-item-heading {
  color: inherit;
}
a.list-group-item-danger:hover,
button.list-group-item-danger:hover,
a.list-group-item-danger:focus,
button.list-group-item-danger:focus {
  color: #a94442;
  background-color: #ebcccc;
}
a.list-group-item-danger.active,
button.list-group-item-danger.active,
a.list-group-item-danger.active:hover,
button.list-group-item-danger.active:hover,
a.list-group-item-danger.active:focus,
button.list-group-item-danger.active:focus {
  color: #fff;
  background-color: #a94442;
  border-color: #a94442;
}
.list-group-item-heading {
  margin-top: 0;
  margin-bottom: 5px;
}
.list-group-item-text {
  margin-bottom: 0;
  line-height: 1.3;
}
.panel {
  margin-bottom: 18px;
  background-color: #fff;
  border: 1px solid transparent;
  border-radius: 2px;
  -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
}
.panel-body {
  padding: 15px;
}
.panel-heading {
  padding: 10px 15px;
  border-bottom: 1px solid transparent;
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel-heading > .dropdown .dropdown-toggle {
  color: inherit;
}
.panel-title {
  margin-top: 0;
  margin-bottom: 0;
  font-size: 15px;
  color: inherit;
}
.panel-title > a,
.panel-title > small,
.panel-title > .small,
.panel-title > small > a,
.panel-title > .small > a {
  color: inherit;
}
.panel-footer {
  padding: 10px 15px;
  background-color: #f5f5f5;
  border-top: 1px solid #ddd;
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .list-group,
.panel > .panel-collapse > .list-group {
  margin-bottom: 0;
}
.panel > .list-group .list-group-item,
.panel > .panel-collapse > .list-group .list-group-item {
  border-width: 1px 0;
  border-radius: 0;
}
.panel > .list-group:first-child .list-group-item:first-child,
.panel > .panel-collapse > .list-group:first-child .list-group-item:first-child {
  border-top: 0;
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel > .list-group:last-child .list-group-item:last-child,
.panel > .panel-collapse > .list-group:last-child .list-group-item:last-child {
  border-bottom: 0;
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .panel-heading + .panel-collapse > .list-group .list-group-item:first-child {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.panel-heading + .list-group .list-group-item:first-child {
  border-top-width: 0;
}
.list-group + .panel-footer {
  border-top-width: 0;
}
.panel > .table,
.panel > .table-responsive > .table,
.panel > .panel-collapse > .table {
  margin-bottom: 0;
}
.panel > .table caption,
.panel > .table-responsive > .table caption,
.panel > .panel-collapse > .table caption {
  padding-left: 15px;
  padding-right: 15px;
}
.panel > .table:first-child,
.panel > .table-responsive:first-child > .table:first-child {
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child {
  border-top-left-radius: 1px;
  border-top-right-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:first-child {
  border-top-left-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:last-child {
  border-top-right-radius: 1px;
}
.panel > .table:last-child,
.panel > .table-responsive:last-child > .table:last-child {
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child {
  border-bottom-left-radius: 1px;
  border-bottom-right-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:first-child {
  border-bottom-left-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:last-child {
  border-bottom-right-radius: 1px;
}
.panel > .panel-body + .table,
.panel > .panel-body + .table-responsive,
.panel > .table + .panel-body,
.panel > .table-responsive + .panel-body {
  border-top: 1px solid #ddd;
}
.panel > .table > tbody:first-child > tr:first-child th,
.panel > .table > tbody:first-child > tr:first-child td {
  border-top: 0;
}
.panel > .table-bordered,
.panel > .table-responsive > .table-bordered {
  border: 0;
}
.panel > .table-bordered > thead > tr > th:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:first-child,
.panel > .table-bordered > tbody > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:first-child,
.panel > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-bordered > thead > tr > td:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:first-child,
.panel > .table-bordered > tbody > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:first-child,
.panel > .table-bordered > tfoot > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:first-child {
  border-left: 0;
}
.panel > .table-bordered > thead > tr > th:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:last-child,
.panel > .table-bordered > tbody > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:last-child,
.panel > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-bordered > thead > tr > td:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:last-child,
.panel > .table-bordered > tbody > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:last-child,
.panel > .table-bordered > tfoot > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:last-child {
  border-right: 0;
}
.panel > .table-bordered > thead > tr:first-child > td,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > td,
.panel > .table-bordered > tbody > tr:first-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > td,
.panel > .table-bordered > thead > tr:first-child > th,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > th,
.panel > .table-bordered > tbody > tr:first-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > th {
  border-bottom: 0;
}
.panel > .table-bordered > tbody > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > td,
.panel > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-bordered > tbody > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > th,
.panel > .table-bordered > tfoot > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > th {
  border-bottom: 0;
}
.panel > .table-responsive {
  border: 0;
  margin-bottom: 0;
}
.panel-group {
  margin-bottom: 18px;
}
.panel-group .panel {
  margin-bottom: 0;
  border-radius: 2px;
}
.panel-group .panel + .panel {
  margin-top: 5px;
}
.panel-group .panel-heading {
  border-bottom: 0;
}
.panel-group .panel-heading + .panel-collapse > .panel-body,
.panel-group .panel-heading + .panel-collapse > .list-group {
  border-top: 1px solid #ddd;
}
.panel-group .panel-footer {
  border-top: 0;
}
.panel-group .panel-footer + .panel-collapse .panel-body {
  border-bottom: 1px solid #ddd;
}
.panel-default {
  border-color: #ddd;
}
.panel-default > .panel-heading {
  color: #333333;
  background-color: #f5f5f5;
  border-color: #ddd;
}
.panel-default > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ddd;
}
.panel-default > .panel-heading .badge {
  color: #f5f5f5;
  background-color: #333333;
}
.panel-default > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ddd;
}
.panel-primary {
  border-color: #337ab7;
}
.panel-primary > .panel-heading {
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
}
.panel-primary > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #337ab7;
}
.panel-primary > .panel-heading .badge {
  color: #337ab7;
  background-color: #fff;
}
.panel-primary > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #337ab7;
}
.panel-success {
  border-color: #d6e9c6;
}
.panel-success > .panel-heading {
  color: #3c763d;
  background-color: #dff0d8;
  border-color: #d6e9c6;
}
.panel-success > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #d6e9c6;
}
.panel-success > .panel-heading .badge {
  color: #dff0d8;
  background-color: #3c763d;
}
.panel-success > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #d6e9c6;
}
.panel-info {
  border-color: #bce8f1;
}
.panel-info > .panel-heading {
  color: #31708f;
  background-color: #d9edf7;
  border-color: #bce8f1;
}
.panel-info > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #bce8f1;
}
.panel-info > .panel-heading .badge {
  color: #d9edf7;
  background-color: #31708f;
}
.panel-info > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #bce8f1;
}
.panel-warning {
  border-color: #faebcc;
}
.panel-warning > .panel-heading {
  color: #8a6d3b;
  background-color: #fcf8e3;
  border-color: #faebcc;
}
.panel-warning > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #faebcc;
}
.panel-warning > .panel-heading .badge {
  color: #fcf8e3;
  background-color: #8a6d3b;
}
.panel-warning > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #faebcc;
}
.panel-danger {
  border-color: #ebccd1;
}
.panel-danger > .panel-heading {
  color: #a94442;
  background-color: #f2dede;
  border-color: #ebccd1;
}
.panel-danger > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ebccd1;
}
.panel-danger > .panel-heading .badge {
  color: #f2dede;
  background-color: #a94442;
}
.panel-danger > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ebccd1;
}
.embed-responsive {
  position: relative;
  display: block;
  height: 0;
  padding: 0;
  overflow: hidden;
}
.embed-responsive .embed-responsive-item,
.embed-responsive iframe,
.embed-responsive embed,
.embed-responsive object,
.embed-responsive video {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  height: 100%;
  width: 100%;
  border: 0;
}
.embed-responsive-16by9 {
  padding-bottom: 56.25%;
}
.embed-responsive-4by3 {
  padding-bottom: 75%;
}
.well {
  min-height: 20px;
  padding: 19px;
  margin-bottom: 20px;
  background-color: #f5f5f5;
  border: 1px solid #e3e3e3;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
}
.well blockquote {
  border-color: #ddd;
  border-color: rgba(0, 0, 0, 0.15);
}
.well-lg {
  padding: 24px;
  border-radius: 3px;
}
.well-sm {
  padding: 9px;
  border-radius: 1px;
}
.close {
  float: right;
  font-size: 19.5px;
  font-weight: bold;
  line-height: 1;
  color: #000;
  text-shadow: 0 1px 0 #fff;
  opacity: 0.2;
  filter: alpha(opacity=20);
}
.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
  opacity: 0.5;
  filter: alpha(opacity=50);
}
button.close {
  padding: 0;
  cursor: pointer;
  background: transparent;
  border: 0;
  -webkit-appearance: none;
}
.modal-open {
  overflow: hidden;
}
.modal {
  display: none;
  overflow: hidden;
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1050;
  -webkit-overflow-scrolling: touch;
  outline: 0;
}
.modal.fade .modal-dialog {
  -webkit-transform: translate(0, -25%);
  -ms-transform: translate(0, -25%);
  -o-transform: translate(0, -25%);
  transform: translate(0, -25%);
  -webkit-transition: -webkit-transform 0.3s ease-out;
  -moz-transition: -moz-transform 0.3s ease-out;
  -o-transition: -o-transform 0.3s ease-out;
  transition: transform 0.3s ease-out;
}
.modal.in .modal-dialog {
  -webkit-transform: translate(0, 0);
  -ms-transform: translate(0, 0);
  -o-transform: translate(0, 0);
  transform: translate(0, 0);
}
.modal-open .modal {
  overflow-x: hidden;
  overflow-y: auto;
}
.modal-dialog {
  position: relative;
  width: auto;
  margin: 10px;
}
.modal-content {
  position: relative;
  background-color: #fff;
  border: 1px solid #999;
  border: 1px solid rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  -webkit-box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);
  box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);
  background-clip: padding-box;
  outline: 0;
}
.modal-backdrop {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1040;
  background-color: #000;
}
.modal-backdrop.fade {
  opacity: 0;
  filter: alpha(opacity=0);
}
.modal-backdrop.in {
  opacity: 0.5;
  filter: alpha(opacity=50);
}
.modal-header {
  padding: 15px;
  border-bottom: 1px solid #e5e5e5;
}
.modal-header .close {
  margin-top: -2px;
}
.modal-title {
  margin: 0;
  line-height: 1.42857143;
}
.modal-body {
  position: relative;
  padding: 15px;
}
.modal-footer {
  padding: 15px;
  text-align: right;
  border-top: 1px solid #e5e5e5;
}
.modal-footer .btn + .btn {
  margin-left: 5px;
  margin-bottom: 0;
}
.modal-footer .btn-group .btn + .btn {
  margin-left: -1px;
}
.modal-footer .btn-block + .btn-block {
  margin-left: 0;
}
.modal-scrollbar-measure {
  position: absolute;
  top: -9999px;
  width: 50px;
  height: 50px;
  overflow: scroll;
}
@media (min-width: 768px) {
  .modal-dialog {
    width: 600px;
    margin: 30px auto;
  }
  .modal-content {
    -webkit-box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
  }
  .modal-sm {
    width: 300px;
  }
}
@media (min-width: 992px) {
  .modal-lg {
    width: 900px;
  }
}
.tooltip {
  position: absolute;
  z-index: 1070;
  display: block;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-style: normal;
  font-weight: normal;
  letter-spacing: normal;
  line-break: auto;
  line-height: 1.42857143;
  text-align: left;
  text-align: start;
  text-decoration: none;
  text-shadow: none;
  text-transform: none;
  white-space: normal;
  word-break: normal;
  word-spacing: normal;
  word-wrap: normal;
  font-size: 12px;
  opacity: 0;
  filter: alpha(opacity=0);
}
.tooltip.in {
  opacity: 0.9;
  filter: alpha(opacity=90);
}
.tooltip.top {
  margin-top: -3px;
  padding: 5px 0;
}
.tooltip.right {
  margin-left: 3px;
  padding: 0 5px;
}
.tooltip.bottom {
  margin-top: 3px;
  padding: 5px 0;
}
.tooltip.left {
  margin-left: -3px;
  padding: 0 5px;
}
.tooltip-inner {
  max-width: 200px;
  padding: 3px 8px;
  color: #fff;
  text-align: center;
  background-color: #000;
  border-radius: 2px;
}
.tooltip-arrow {
  position: absolute;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
}
.tooltip.top .tooltip-arrow {
  bottom: 0;
  left: 50%;
  margin-left: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.top-left .tooltip-arrow {
  bottom: 0;
  right: 5px;
  margin-bottom: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.top-right .tooltip-arrow {
  bottom: 0;
  left: 5px;
  margin-bottom: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.right .tooltip-arrow {
  top: 50%;
  left: 0;
  margin-top: -5px;
  border-width: 5px 5px 5px 0;
  border-right-color: #000;
}
.tooltip.left .tooltip-arrow {
  top: 50%;
  right: 0;
  margin-top: -5px;
  border-width: 5px 0 5px 5px;
  border-left-color: #000;
}
.tooltip.bottom .tooltip-arrow {
  top: 0;
  left: 50%;
  margin-left: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.tooltip.bottom-left .tooltip-arrow {
  top: 0;
  right: 5px;
  margin-top: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.tooltip.bottom-right .tooltip-arrow {
  top: 0;
  left: 5px;
  margin-top: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.popover {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 1060;
  display: none;
  max-width: 276px;
  padding: 1px;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-style: normal;
  font-weight: normal;
  letter-spacing: normal;
  line-break: auto;
  line-height: 1.42857143;
  text-align: left;
  text-align: start;
  text-decoration: none;
  text-shadow: none;
  text-transform: none;
  white-space: normal;
  word-break: normal;
  word-spacing: normal;
  word-wrap: normal;
  font-size: 13px;
  background-color: #fff;
  background-clip: padding-box;
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  -webkit-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
  box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
}
.popover.top {
  margin-top: -10px;
}
.popover.right {
  margin-left: 10px;
}
.popover.bottom {
  margin-top: 10px;
}
.popover.left {
  margin-left: -10px;
}
.popover-title {
  margin: 0;
  padding: 8px 14px;
  font-size: 13px;
  background-color: #f7f7f7;
  border-bottom: 1px solid #ebebeb;
  border-radius: 2px 2px 0 0;
}
.popover-content {
  padding: 9px 14px;
}
.popover > .arrow,
.popover > .arrow:after {
  position: absolute;
  display: block;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
}
.popover > .arrow {
  border-width: 11px;
}
.popover > .arrow:after {
  border-width: 10px;
  content: "";
}
.popover.top > .arrow {
  left: 50%;
  margin-left: -11px;
  border-bottom-width: 0;
  border-top-color: #999999;
  border-top-color: rgba(0, 0, 0, 0.25);
  bottom: -11px;
}
.popover.top > .arrow:after {
  content: " ";
  bottom: 1px;
  margin-left: -10px;
  border-bottom-width: 0;
  border-top-color: #fff;
}
.popover.right > .arrow {
  top: 50%;
  left: -11px;
  margin-top: -11px;
  border-left-width: 0;
  border-right-color: #999999;
  border-right-color: rgba(0, 0, 0, 0.25);
}
.popover.right > .arrow:after {
  content: " ";
  left: 1px;
  bottom: -10px;
  border-left-width: 0;
  border-right-color: #fff;
}
.popover.bottom > .arrow {
  left: 50%;
  margin-left: -11px;
  border-top-width: 0;
  border-bottom-color: #999999;
  border-bottom-color: rgba(0, 0, 0, 0.25);
  top: -11px;
}
.popover.bottom > .arrow:after {
  content: " ";
  top: 1px;
  margin-left: -10px;
  border-top-width: 0;
  border-bottom-color: #fff;
}
.popover.left > .arrow {
  top: 50%;
  right: -11px;
  margin-top: -11px;
  border-right-width: 0;
  border-left-color: #999999;
  border-left-color: rgba(0, 0, 0, 0.25);
}
.popover.left > .arrow:after {
  content: " ";
  right: 1px;
  border-right-width: 0;
  border-left-color: #fff;
  bottom: -10px;
}
.carousel {
  position: relative;
}
.carousel-inner {
  position: relative;
  overflow: hidden;
  width: 100%;
}
.carousel-inner > .item {
  display: none;
  position: relative;
  -webkit-transition: 0.6s ease-in-out left;
  -o-transition: 0.6s ease-in-out left;
  transition: 0.6s ease-in-out left;
}
.carousel-inner > .item > img,
.carousel-inner > .item > a > img {
  line-height: 1;
}
@media all and (transform-3d), (-webkit-transform-3d) {
  .carousel-inner > .item {
    -webkit-transition: -webkit-transform 0.6s ease-in-out;
    -moz-transition: -moz-transform 0.6s ease-in-out;
    -o-transition: -o-transform 0.6s ease-in-out;
    transition: transform 0.6s ease-in-out;
    -webkit-backface-visibility: hidden;
    -moz-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-perspective: 1000px;
    -moz-perspective: 1000px;
    perspective: 1000px;
  }
  .carousel-inner > .item.next,
  .carousel-inner > .item.active.right {
    -webkit-transform: translate3d(100%, 0, 0);
    transform: translate3d(100%, 0, 0);
    left: 0;
  }
  .carousel-inner > .item.prev,
  .carousel-inner > .item.active.left {
    -webkit-transform: translate3d(-100%, 0, 0);
    transform: translate3d(-100%, 0, 0);
    left: 0;
  }
  .carousel-inner > .item.next.left,
  .carousel-inner > .item.prev.right,
  .carousel-inner > .item.active {
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    left: 0;
  }
}
.carousel-inner > .active,
.carousel-inner > .next,
.carousel-inner > .prev {
  display: block;
}
.carousel-inner > .active {
  left: 0;
}
.carousel-inner > .next,
.carousel-inner > .prev {
  position: absolute;
  top: 0;
  width: 100%;
}
.carousel-inner > .next {
  left: 100%;
}
.carousel-inner > .prev {
  left: -100%;
}
.carousel-inner > .next.left,
.carousel-inner > .prev.right {
  left: 0;
}
.carousel-inner > .active.left {
  left: -100%;
}
.carousel-inner > .active.right {
  left: 100%;
}
.carousel-control {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  width: 15%;
  opacity: 0.5;
  filter: alpha(opacity=50);
  font-size: 20px;
  color: #fff;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
  background-color: rgba(0, 0, 0, 0);
}
.carousel-control.left {
  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#80000000', endColorstr='#00000000', GradientType=1);
}
.carousel-control.right {
  left: auto;
  right: 0;
  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#00000000', endColorstr='#80000000', GradientType=1);
}
.carousel-control:hover,
.carousel-control:focus {
  outline: 0;
  color: #fff;
  text-decoration: none;
  opacity: 0.9;
  filter: alpha(opacity=90);
}
.carousel-control .icon-prev,
.carousel-control .icon-next,
.carousel-control .glyphicon-chevron-left,
.carousel-control .glyphicon-chevron-right {
  position: absolute;
  top: 50%;
  margin-top: -10px;
  z-index: 5;
  display: inline-block;
}
.carousel-control .icon-prev,
.carousel-control .glyphicon-chevron-left {
  left: 50%;
  margin-left: -10px;
}
.carousel-control .icon-next,
.carousel-control .glyphicon-chevron-right {
  right: 50%;
  margin-right: -10px;
}
.carousel-control .icon-prev,
.carousel-control .icon-next {
  width: 20px;
  height: 20px;
  line-height: 1;
  font-family: serif;
}
.carousel-control .icon-prev:before {
  content: '\2039';
}
.carousel-control .icon-next:before {
  content: '\203a';
}
.carousel-indicators {
  position: absolute;
  bottom: 10px;
  left: 50%;
  z-index: 15;
  width: 60%;
  margin-left: -30%;
  padding-left: 0;
  list-style: none;
  text-align: center;
}
.carousel-indicators li {
  display: inline-block;
  width: 10px;
  height: 10px;
  margin: 1px;
  text-indent: -999px;
  border: 1px solid #fff;
  border-radius: 10px;
  cursor: pointer;
  background-color: #000 \9;
  background-color: rgba(0, 0, 0, 0);
}
.carousel-indicators .active {
  margin: 0;
  width: 12px;
  height: 12px;
  background-color: #fff;
}
.carousel-caption {
  position: absolute;
  left: 15%;
  right: 15%;
  bottom: 20px;
  z-index: 10;
  padding-top: 20px;
  padding-bottom: 20px;
  color: #fff;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
}
.carousel-caption .btn {
  text-shadow: none;
}
@media screen and (min-width: 768px) {
  .carousel-control .glyphicon-chevron-left,
  .carousel-control .glyphicon-chevron-right,
  .carousel-control .icon-prev,
  .carousel-control .icon-next {
    width: 30px;
    height: 30px;
    margin-top: -10px;
    font-size: 30px;
  }
  .carousel-control .glyphicon-chevron-left,
  .carousel-control .icon-prev {
    margin-left: -10px;
  }
  .carousel-control .glyphicon-chevron-right,
  .carousel-control .icon-next {
    margin-right: -10px;
  }
  .carousel-caption {
    left: 20%;
    right: 20%;
    padding-bottom: 30px;
  }
  .carousel-indicators {
    bottom: 20px;
  }
}
.clearfix:before,
.clearfix:after,
.dl-horizontal dd:before,
.dl-horizontal dd:after,
.container:before,
.container:after,
.container-fluid:before,
.container-fluid:after,
.row:before,
.row:after,
.form-horizontal .form-group:before,
.form-horizontal .form-group:after,
.btn-toolbar:before,
.btn-toolbar:after,
.btn-group-vertical > .btn-group:before,
.btn-group-vertical > .btn-group:after,
.nav:before,
.nav:after,
.navbar:before,
.navbar:after,
.navbar-header:before,
.navbar-header:after,
.navbar-collapse:before,
.navbar-collapse:after,
.pager:before,
.pager:after,
.panel-body:before,
.panel-body:after,
.modal-header:before,
.modal-header:after,
.modal-footer:before,
.modal-footer:after,
.item_buttons:before,
.item_buttons:after {
  content: " ";
  display: table;
}
.clearfix:after,
.dl-horizontal dd:after,
.container:after,
.container-fluid:after,
.row:after,
.form-horizontal .form-group:after,
.btn-toolbar:after,
.btn-group-vertical > .btn-group:after,
.nav:after,
.navbar:after,
.navbar-header:after,
.navbar-collapse:after,
.pager:after,
.panel-body:after,
.modal-header:after,
.modal-footer:after,
.item_buttons:after {
  clear: both;
}
.center-block {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
.pull-right {
  float: right !important;
}
.pull-left {
  float: left !important;
}
.hide {
  display: none !important;
}
.show {
  display: block !important;
}
.invisible {
  visibility: hidden;
}
.text-hide {
  font: 0/0 a;
  color: transparent;
  text-shadow: none;
  background-color: transparent;
  border: 0;
}
.hidden {
  display: none !important;
}
.affix {
  position: fixed;
}
@-ms-viewport {
  width: device-width;
}
.visible-xs,
.visible-sm,
.visible-md,
.visible-lg {
  display: none !important;
}
.visible-xs-block,
.visible-xs-inline,
.visible-xs-inline-block,
.visible-sm-block,
.visible-sm-inline,
.visible-sm-inline-block,
.visible-md-block,
.visible-md-inline,
.visible-md-inline-block,
.visible-lg-block,
.visible-lg-inline,
.visible-lg-inline-block {
  display: none !important;
}
@media (max-width: 767px) {
  .visible-xs {
    display: block !important;
  }
  table.visible-xs {
    display: table !important;
  }
  tr.visible-xs {
    display: table-row !important;
  }
  th.visible-xs,
  td.visible-xs {
    display: table-cell !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-block {
    display: block !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-inline {
    display: inline !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm {
    display: block !important;
  }
  table.visible-sm {
    display: table !important;
  }
  tr.visible-sm {
    display: table-row !important;
  }
  th.visible-sm,
  td.visible-sm {
    display: table-cell !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-block {
    display: block !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-inline {
    display: inline !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md {
    display: block !important;
  }
  table.visible-md {
    display: table !important;
  }
  tr.visible-md {
    display: table-row !important;
  }
  th.visible-md,
  td.visible-md {
    display: table-cell !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-block {
    display: block !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-inline {
    display: inline !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg {
    display: block !important;
  }
  table.visible-lg {
    display: table !important;
  }
  tr.visible-lg {
    display: table-row !important;
  }
  th.visible-lg,
  td.visible-lg {
    display: table-cell !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-block {
    display: block !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-inline {
    display: inline !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-inline-block {
    display: inline-block !important;
  }
}
@media (max-width: 767px) {
  .hidden-xs {
    display: none !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .hidden-sm {
    display: none !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .hidden-md {
    display: none !important;
  }
}
@media (min-width: 1200px) {
  .hidden-lg {
    display: none !important;
  }
}
.visible-print {
  display: none !important;
}
@media print {
  .visible-print {
    display: block !important;
  }
  table.visible-print {
    display: table !important;
  }
  tr.visible-print {
    display: table-row !important;
  }
  th.visible-print,
  td.visible-print {
    display: table-cell !important;
  }
}
.visible-print-block {
  display: none !important;
}
@media print {
  .visible-print-block {
    display: block !important;
  }
}
.visible-print-inline {
  display: none !important;
}
@media print {
  .visible-print-inline {
    display: inline !important;
  }
}
.visible-print-inline-block {
  display: none !important;
}
@media print {
  .visible-print-inline-block {
    display: inline-block !important;
  }
}
@media print {
  .hidden-print {
    display: none !important;
  }
}
/*!
*
* Font Awesome
*
*/
/*!
 *  Font Awesome 4.7.0 by @davegandy - http://fontawesome.io - @fontawesome
 *  License - http://fontawesome.io/license (Font: SIL OFL 1.1, CSS: MIT License)
 */
/* FONT PATH
 * -------------------------- */
@font-face {
  font-family: 'FontAwesome';
  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?v=4.7.0');
  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?#iefix&v=4.7.0') format('embedded-opentype'), url('../components/font-awesome/fonts/fontawesome-webfont.woff2?v=4.7.0') format('woff2'), url('../components/font-awesome/fonts/fontawesome-webfont.woff?v=4.7.0') format('woff'), url('../components/font-awesome/fonts/fontawesome-webfont.ttf?v=4.7.0') format('truetype'), url('../components/font-awesome/fonts/fontawesome-webfont.svg?v=4.7.0#fontawesomeregular') format('svg');
  font-weight: normal;
  font-style: normal;
}
.fa {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
/* makes the font 33% larger relative to the icon container */
.fa-lg {
  font-size: 1.33333333em;
  line-height: 0.75em;
  vertical-align: -15%;
}
.fa-2x {
  font-size: 2em;
}
.fa-3x {
  font-size: 3em;
}
.fa-4x {
  font-size: 4em;
}
.fa-5x {
  font-size: 5em;
}
.fa-fw {
  width: 1.28571429em;
  text-align: center;
}
.fa-ul {
  padding-left: 0;
  margin-left: 2.14285714em;
  list-style-type: none;
}
.fa-ul > li {
  position: relative;
}
.fa-li {
  position: absolute;
  left: -2.14285714em;
  width: 2.14285714em;
  top: 0.14285714em;
  text-align: center;
}
.fa-li.fa-lg {
  left: -1.85714286em;
}
.fa-border {
  padding: .2em .25em .15em;
  border: solid 0.08em #eee;
  border-radius: .1em;
}
.fa-pull-left {
  float: left;
}
.fa-pull-right {
  float: right;
}
.fa.fa-pull-left {
  margin-right: .3em;
}
.fa.fa-pull-right {
  margin-left: .3em;
}
/* Deprecated as of 4.4.0 */
.pull-right {
  float: right;
}
.pull-left {
  float: left;
}
.fa.pull-left {
  margin-right: .3em;
}
.fa.pull-right {
  margin-left: .3em;
}
.fa-spin {
  -webkit-animation: fa-spin 2s infinite linear;
  animation: fa-spin 2s infinite linear;
}
.fa-pulse {
  -webkit-animation: fa-spin 1s infinite steps(8);
  animation: fa-spin 1s infinite steps(8);
}
@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg);
  }
}
@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg);
  }
}
.fa-rotate-90 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";
  -webkit-transform: rotate(90deg);
  -ms-transform: rotate(90deg);
  transform: rotate(90deg);
}
.fa-rotate-180 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";
  -webkit-transform: rotate(180deg);
  -ms-transform: rotate(180deg);
  transform: rotate(180deg);
}
.fa-rotate-270 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";
  -webkit-transform: rotate(270deg);
  -ms-transform: rotate(270deg);
  transform: rotate(270deg);
}
.fa-flip-horizontal {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";
  -webkit-transform: scale(-1, 1);
  -ms-transform: scale(-1, 1);
  transform: scale(-1, 1);
}
.fa-flip-vertical {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";
  -webkit-transform: scale(1, -1);
  -ms-transform: scale(1, -1);
  transform: scale(1, -1);
}
:root .fa-rotate-90,
:root .fa-rotate-180,
:root .fa-rotate-270,
:root .fa-flip-horizontal,
:root .fa-flip-vertical {
  filter: none;
}
.fa-stack {
  position: relative;
  display: inline-block;
  width: 2em;
  height: 2em;
  line-height: 2em;
  vertical-align: middle;
}
.fa-stack-1x,
.fa-stack-2x {
  position: absolute;
  left: 0;
  width: 100%;
  text-align: center;
}
.fa-stack-1x {
  line-height: inherit;
}
.fa-stack-2x {
  font-size: 2em;
}
.fa-inverse {
  color: #fff;
}
/* Font Awesome uses the Unicode Private Use Area (PUA) to ensure screen
   readers do not read off random characters that represent icons */
.fa-glass:before {
  content: "\f000";
}
.fa-music:before {
  content: "\f001";
}
.fa-search:before {
  content: "\f002";
}
.fa-envelope-o:before {
  content: "\f003";
}
.fa-heart:before {
  content: "\f004";
}
.fa-star:before {
  content: "\f005";
}
.fa-star-o:before {
  content: "\f006";
}
.fa-user:before {
  content: "\f007";
}
.fa-film:before {
  content: "\f008";
}
.fa-th-large:before {
  content: "\f009";
}
.fa-th:before {
  content: "\f00a";
}
.fa-th-list:before {
  content: "\f00b";
}
.fa-check:before {
  content: "\f00c";
}
.fa-remove:before,
.fa-close:before,
.fa-times:before {
  content: "\f00d";
}
.fa-search-plus:before {
  content: "\f00e";
}
.fa-search-minus:before {
  content: "\f010";
}
.fa-power-off:before {
  content: "\f011";
}
.fa-signal:before {
  content: "\f012";
}
.fa-gear:before,
.fa-cog:before {
  content: "\f013";
}
.fa-trash-o:before {
  content: "\f014";
}
.fa-home:before {
  content: "\f015";
}
.fa-file-o:before {
  content: "\f016";
}
.fa-clock-o:before {
  content: "\f017";
}
.fa-road:before {
  content: "\f018";
}
.fa-download:before {
  content: "\f019";
}
.fa-arrow-circle-o-down:before {
  content: "\f01a";
}
.fa-arrow-circle-o-up:before {
  content: "\f01b";
}
.fa-inbox:before {
  content: "\f01c";
}
.fa-play-circle-o:before {
  content: "\f01d";
}
.fa-rotate-right:before,
.fa-repeat:before {
  content: "\f01e";
}
.fa-refresh:before {
  content: "\f021";
}
.fa-list-alt:before {
  content: "\f022";
}
.fa-lock:before {
  content: "\f023";
}
.fa-flag:before {
  content: "\f024";
}
.fa-headphones:before {
  content: "\f025";
}
.fa-volume-off:before {
  content: "\f026";
}
.fa-volume-down:before {
  content: "\f027";
}
.fa-volume-up:before {
  content: "\f028";
}
.fa-qrcode:before {
  content: "\f029";
}
.fa-barcode:before {
  content: "\f02a";
}
.fa-tag:before {
  content: "\f02b";
}
.fa-tags:before {
  content: "\f02c";
}
.fa-book:before {
  content: "\f02d";
}
.fa-bookmark:before {
  content: "\f02e";
}
.fa-print:before {
  content: "\f02f";
}
.fa-camera:before {
  content: "\f030";
}
.fa-font:before {
  content: "\f031";
}
.fa-bold:before {
  content: "\f032";
}
.fa-italic:before {
  content: "\f033";
}
.fa-text-height:before {
  content: "\f034";
}
.fa-text-width:before {
  content: "\f035";
}
.fa-align-left:before {
  content: "\f036";
}
.fa-align-center:before {
  content: "\f037";
}
.fa-align-right:before {
  content: "\f038";
}
.fa-align-justify:before {
  content: "\f039";
}
.fa-list:before {
  content: "\f03a";
}
.fa-dedent:before,
.fa-outdent:before {
  content: "\f03b";
}
.fa-indent:before {
  content: "\f03c";
}
.fa-video-camera:before {
  content: "\f03d";
}
.fa-photo:before,
.fa-image:before,
.fa-picture-o:before {
  content: "\f03e";
}
.fa-pencil:before {
  content: "\f040";
}
.fa-map-marker:before {
  content: "\f041";
}
.fa-adjust:before {
  content: "\f042";
}
.fa-tint:before {
  content: "\f043";
}
.fa-edit:before,
.fa-pencil-square-o:before {
  content: "\f044";
}
.fa-share-square-o:before {
  content: "\f045";
}
.fa-check-square-o:before {
  content: "\f046";
}
.fa-arrows:before {
  content: "\f047";
}
.fa-step-backward:before {
  content: "\f048";
}
.fa-fast-backward:before {
  content: "\f049";
}
.fa-backward:before {
  content: "\f04a";
}
.fa-play:before {
  content: "\f04b";
}
.fa-pause:before {
  content: "\f04c";
}
.fa-stop:before {
  content: "\f04d";
}
.fa-forward:before {
  content: "\f04e";
}
.fa-fast-forward:before {
  content: "\f050";
}
.fa-step-forward:before {
  content: "\f051";
}
.fa-eject:before {
  content: "\f052";
}
.fa-chevron-left:before {
  content: "\f053";
}
.fa-chevron-right:before {
  content: "\f054";
}
.fa-plus-circle:before {
  content: "\f055";
}
.fa-minus-circle:before {
  content: "\f056";
}
.fa-times-circle:before {
  content: "\f057";
}
.fa-check-circle:before {
  content: "\f058";
}
.fa-question-circle:before {
  content: "\f059";
}
.fa-info-circle:before {
  content: "\f05a";
}
.fa-crosshairs:before {
  content: "\f05b";
}
.fa-times-circle-o:before {
  content: "\f05c";
}
.fa-check-circle-o:before {
  content: "\f05d";
}
.fa-ban:before {
  content: "\f05e";
}
.fa-arrow-left:before {
  content: "\f060";
}
.fa-arrow-right:before {
  content: "\f061";
}
.fa-arrow-up:before {
  content: "\f062";
}
.fa-arrow-down:before {
  content: "\f063";
}
.fa-mail-forward:before,
.fa-share:before {
  content: "\f064";
}
.fa-expand:before {
  content: "\f065";
}
.fa-compress:before {
  content: "\f066";
}
.fa-plus:before {
  content: "\f067";
}
.fa-minus:before {
  content: "\f068";
}
.fa-asterisk:before {
  content: "\f069";
}
.fa-exclamation-circle:before {
  content: "\f06a";
}
.fa-gift:before {
  content: "\f06b";
}
.fa-leaf:before {
  content: "\f06c";
}
.fa-fire:before {
  content: "\f06d";
}
.fa-eye:before {
  content: "\f06e";
}
.fa-eye-slash:before {
  content: "\f070";
}
.fa-warning:before,
.fa-exclamation-triangle:before {
  content: "\f071";
}
.fa-plane:before {
  content: "\f072";
}
.fa-calendar:before {
  content: "\f073";
}
.fa-random:before {
  content: "\f074";
}
.fa-comment:before {
  content: "\f075";
}
.fa-magnet:before {
  content: "\f076";
}
.fa-chevron-up:before {
  content: "\f077";
}
.fa-chevron-down:before {
  content: "\f078";
}
.fa-retweet:before {
  content: "\f079";
}
.fa-shopping-cart:before {
  content: "\f07a";
}
.fa-folder:before {
  content: "\f07b";
}
.fa-folder-open:before {
  content: "\f07c";
}
.fa-arrows-v:before {
  content: "\f07d";
}
.fa-arrows-h:before {
  content: "\f07e";
}
.fa-bar-chart-o:before,
.fa-bar-chart:before {
  content: "\f080";
}
.fa-twitter-square:before {
  content: "\f081";
}
.fa-facebook-square:before {
  content: "\f082";
}
.fa-camera-retro:before {
  content: "\f083";
}
.fa-key:before {
  content: "\f084";
}
.fa-gears:before,
.fa-cogs:before {
  content: "\f085";
}
.fa-comments:before {
  content: "\f086";
}
.fa-thumbs-o-up:before {
  content: "\f087";
}
.fa-thumbs-o-down:before {
  content: "\f088";
}
.fa-star-half:before {
  content: "\f089";
}
.fa-heart-o:before {
  content: "\f08a";
}
.fa-sign-out:before {
  content: "\f08b";
}
.fa-linkedin-square:before {
  content: "\f08c";
}
.fa-thumb-tack:before {
  content: "\f08d";
}
.fa-external-link:before {
  content: "\f08e";
}
.fa-sign-in:before {
  content: "\f090";
}
.fa-trophy:before {
  content: "\f091";
}
.fa-github-square:before {
  content: "\f092";
}
.fa-upload:before {
  content: "\f093";
}
.fa-lemon-o:before {
  content: "\f094";
}
.fa-phone:before {
  content: "\f095";
}
.fa-square-o:before {
  content: "\f096";
}
.fa-bookmark-o:before {
  content: "\f097";
}
.fa-phone-square:before {
  content: "\f098";
}
.fa-twitter:before {
  content: "\f099";
}
.fa-facebook-f:before,
.fa-facebook:before {
  content: "\f09a";
}
.fa-github:before {
  content: "\f09b";
}
.fa-unlock:before {
  content: "\f09c";
}
.fa-credit-card:before {
  content: "\f09d";
}
.fa-feed:before,
.fa-rss:before {
  content: "\f09e";
}
.fa-hdd-o:before {
  content: "\f0a0";
}
.fa-bullhorn:before {
  content: "\f0a1";
}
.fa-bell:before {
  content: "\f0f3";
}
.fa-certificate:before {
  content: "\f0a3";
}
.fa-hand-o-right:before {
  content: "\f0a4";
}
.fa-hand-o-left:before {
  content: "\f0a5";
}
.fa-hand-o-up:before {
  content: "\f0a6";
}
.fa-hand-o-down:before {
  content: "\f0a7";
}
.fa-arrow-circle-left:before {
  content: "\f0a8";
}
.fa-arrow-circle-right:before {
  content: "\f0a9";
}
.fa-arrow-circle-up:before {
  content: "\f0aa";
}
.fa-arrow-circle-down:before {
  content: "\f0ab";
}
.fa-globe:before {
  content: "\f0ac";
}
.fa-wrench:before {
  content: "\f0ad";
}
.fa-tasks:before {
  content: "\f0ae";
}
.fa-filter:before {
  content: "\f0b0";
}
.fa-briefcase:before {
  content: "\f0b1";
}
.fa-arrows-alt:before {
  content: "\f0b2";
}
.fa-group:before,
.fa-users:before {
  content: "\f0c0";
}
.fa-chain:before,
.fa-link:before {
  content: "\f0c1";
}
.fa-cloud:before {
  content: "\f0c2";
}
.fa-flask:before {
  content: "\f0c3";
}
.fa-cut:before,
.fa-scissors:before {
  content: "\f0c4";
}
.fa-copy:before,
.fa-files-o:before {
  content: "\f0c5";
}
.fa-paperclip:before {
  content: "\f0c6";
}
.fa-save:before,
.fa-floppy-o:before {
  content: "\f0c7";
}
.fa-square:before {
  content: "\f0c8";
}
.fa-navicon:before,
.fa-reorder:before,
.fa-bars:before {
  content: "\f0c9";
}
.fa-list-ul:before {
  content: "\f0ca";
}
.fa-list-ol:before {
  content: "\f0cb";
}
.fa-strikethrough:before {
  content: "\f0cc";
}
.fa-underline:before {
  content: "\f0cd";
}
.fa-table:before {
  content: "\f0ce";
}
.fa-magic:before {
  content: "\f0d0";
}
.fa-truck:before {
  content: "\f0d1";
}
.fa-pinterest:before {
  content: "\f0d2";
}
.fa-pinterest-square:before {
  content: "\f0d3";
}
.fa-google-plus-square:before {
  content: "\f0d4";
}
.fa-google-plus:before {
  content: "\f0d5";
}
.fa-money:before {
  content: "\f0d6";
}
.fa-caret-down:before {
  content: "\f0d7";
}
.fa-caret-up:before {
  content: "\f0d8";
}
.fa-caret-left:before {
  content: "\f0d9";
}
.fa-caret-right:before {
  content: "\f0da";
}
.fa-columns:before {
  content: "\f0db";
}
.fa-unsorted:before,
.fa-sort:before {
  content: "\f0dc";
}
.fa-sort-down:before,
.fa-sort-desc:before {
  content: "\f0dd";
}
.fa-sort-up:before,
.fa-sort-asc:before {
  content: "\f0de";
}
.fa-envelope:before {
  content: "\f0e0";
}
.fa-linkedin:before {
  content: "\f0e1";
}
.fa-rotate-left:before,
.fa-undo:before {
  content: "\f0e2";
}
.fa-legal:before,
.fa-gavel:before {
  content: "\f0e3";
}
.fa-dashboard:before,
.fa-tachometer:before {
  content: "\f0e4";
}
.fa-comment-o:before {
  content: "\f0e5";
}
.fa-comments-o:before {
  content: "\f0e6";
}
.fa-flash:before,
.fa-bolt:before {
  content: "\f0e7";
}
.fa-sitemap:before {
  content: "\f0e8";
}
.fa-umbrella:before {
  content: "\f0e9";
}
.fa-paste:before,
.fa-clipboard:before {
  content: "\f0ea";
}
.fa-lightbulb-o:before {
  content: "\f0eb";
}
.fa-exchange:before {
  content: "\f0ec";
}
.fa-cloud-download:before {
  content: "\f0ed";
}
.fa-cloud-upload:before {
  content: "\f0ee";
}
.fa-user-md:before {
  content: "\f0f0";
}
.fa-stethoscope:before {
  content: "\f0f1";
}
.fa-suitcase:before {
  content: "\f0f2";
}
.fa-bell-o:before {
  content: "\f0a2";
}
.fa-coffee:before {
  content: "\f0f4";
}
.fa-cutlery:before {
  content: "\f0f5";
}
.fa-file-text-o:before {
  content: "\f0f6";
}
.fa-building-o:before {
  content: "\f0f7";
}
.fa-hospital-o:before {
  content: "\f0f8";
}
.fa-ambulance:before {
  content: "\f0f9";
}
.fa-medkit:before {
  content: "\f0fa";
}
.fa-fighter-jet:before {
  content: "\f0fb";
}
.fa-beer:before {
  content: "\f0fc";
}
.fa-h-square:before {
  content: "\f0fd";
}
.fa-plus-square:before {
  content: "\f0fe";
}
.fa-angle-double-left:before {
  content: "\f100";
}
.fa-angle-double-right:before {
  content: "\f101";
}
.fa-angle-double-up:before {
  content: "\f102";
}
.fa-angle-double-down:before {
  content: "\f103";
}
.fa-angle-left:before {
  content: "\f104";
}
.fa-angle-right:before {
  content: "\f105";
}
.fa-angle-up:before {
  content: "\f106";
}
.fa-angle-down:before {
  content: "\f107";
}
.fa-desktop:before {
  content: "\f108";
}
.fa-laptop:before {
  content: "\f109";
}
.fa-tablet:before {
  content: "\f10a";
}
.fa-mobile-phone:before,
.fa-mobile:before {
  content: "\f10b";
}
.fa-circle-o:before {
  content: "\f10c";
}
.fa-quote-left:before {
  content: "\f10d";
}
.fa-quote-right:before {
  content: "\f10e";
}
.fa-spinner:before {
  content: "\f110";
}
.fa-circle:before {
  content: "\f111";
}
.fa-mail-reply:before,
.fa-reply:before {
  content: "\f112";
}
.fa-github-alt:before {
  content: "\f113";
}
.fa-folder-o:before {
  content: "\f114";
}
.fa-folder-open-o:before {
  content: "\f115";
}
.fa-smile-o:before {
  content: "\f118";
}
.fa-frown-o:before {
  content: "\f119";
}
.fa-meh-o:before {
  content: "\f11a";
}
.fa-gamepad:before {
  content: "\f11b";
}
.fa-keyboard-o:before {
  content: "\f11c";
}
.fa-flag-o:before {
  content: "\f11d";
}
.fa-flag-checkered:before {
  content: "\f11e";
}
.fa-terminal:before {
  content: "\f120";
}
.fa-code:before {
  content: "\f121";
}
.fa-mail-reply-all:before,
.fa-reply-all:before {
  content: "\f122";
}
.fa-star-half-empty:before,
.fa-star-half-full:before,
.fa-star-half-o:before {
  content: "\f123";
}
.fa-location-arrow:before {
  content: "\f124";
}
.fa-crop:before {
  content: "\f125";
}
.fa-code-fork:before {
  content: "\f126";
}
.fa-unlink:before,
.fa-chain-broken:before {
  content: "\f127";
}
.fa-question:before {
  content: "\f128";
}
.fa-info:before {
  content: "\f129";
}
.fa-exclamation:before {
  content: "\f12a";
}
.fa-superscript:before {
  content: "\f12b";
}
.fa-subscript:before {
  content: "\f12c";
}
.fa-eraser:before {
  content: "\f12d";
}
.fa-puzzle-piece:before {
  content: "\f12e";
}
.fa-microphone:before {
  content: "\f130";
}
.fa-microphone-slash:before {
  content: "\f131";
}
.fa-shield:before {
  content: "\f132";
}
.fa-calendar-o:before {
  content: "\f133";
}
.fa-fire-extinguisher:before {
  content: "\f134";
}
.fa-rocket:before {
  content: "\f135";
}
.fa-maxcdn:before {
  content: "\f136";
}
.fa-chevron-circle-left:before {
  content: "\f137";
}
.fa-chevron-circle-right:before {
  content: "\f138";
}
.fa-chevron-circle-up:before {
  content: "\f139";
}
.fa-chevron-circle-down:before {
  content: "\f13a";
}
.fa-html5:before {
  content: "\f13b";
}
.fa-css3:before {
  content: "\f13c";
}
.fa-anchor:before {
  content: "\f13d";
}
.fa-unlock-alt:before {
  content: "\f13e";
}
.fa-bullseye:before {
  content: "\f140";
}
.fa-ellipsis-h:before {
  content: "\f141";
}
.fa-ellipsis-v:before {
  content: "\f142";
}
.fa-rss-square:before {
  content: "\f143";
}
.fa-play-circle:before {
  content: "\f144";
}
.fa-ticket:before {
  content: "\f145";
}
.fa-minus-square:before {
  content: "\f146";
}
.fa-minus-square-o:before {
  content: "\f147";
}
.fa-level-up:before {
  content: "\f148";
}
.fa-level-down:before {
  content: "\f149";
}
.fa-check-square:before {
  content: "\f14a";
}
.fa-pencil-square:before {
  content: "\f14b";
}
.fa-external-link-square:before {
  content: "\f14c";
}
.fa-share-square:before {
  content: "\f14d";
}
.fa-compass:before {
  content: "\f14e";
}
.fa-toggle-down:before,
.fa-caret-square-o-down:before {
  content: "\f150";
}
.fa-toggle-up:before,
.fa-caret-square-o-up:before {
  content: "\f151";
}
.fa-toggle-right:before,
.fa-caret-square-o-right:before {
  content: "\f152";
}
.fa-euro:before,
.fa-eur:before {
  content: "\f153";
}
.fa-gbp:before {
  content: "\f154";
}
.fa-dollar:before,
.fa-usd:before {
  content: "\f155";
}
.fa-rupee:before,
.fa-inr:before {
  content: "\f156";
}
.fa-cny:before,
.fa-rmb:before,
.fa-yen:before,
.fa-jpy:before {
  content: "\f157";
}
.fa-ruble:before,
.fa-rouble:before,
.fa-rub:before {
  content: "\f158";
}
.fa-won:before,
.fa-krw:before {
  content: "\f159";
}
.fa-bitcoin:before,
.fa-btc:before {
  content: "\f15a";
}
.fa-file:before {
  content: "\f15b";
}
.fa-file-text:before {
  content: "\f15c";
}
.fa-sort-alpha-asc:before {
  content: "\f15d";
}
.fa-sort-alpha-desc:before {
  content: "\f15e";
}
.fa-sort-amount-asc:before {
  content: "\f160";
}
.fa-sort-amount-desc:before {
  content: "\f161";
}
.fa-sort-numeric-asc:before {
  content: "\f162";
}
.fa-sort-numeric-desc:before {
  content: "\f163";
}
.fa-thumbs-up:before {
  content: "\f164";
}
.fa-thumbs-down:before {
  content: "\f165";
}
.fa-youtube-square:before {
  content: "\f166";
}
.fa-youtube:before {
  content: "\f167";
}
.fa-xing:before {
  content: "\f168";
}
.fa-xing-square:before {
  content: "\f169";
}
.fa-youtube-play:before {
  content: "\f16a";
}
.fa-dropbox:before {
  content: "\f16b";
}
.fa-stack-overflow:before {
  content: "\f16c";
}
.fa-instagram:before {
  content: "\f16d";
}
.fa-flickr:before {
  content: "\f16e";
}
.fa-adn:before {
  content: "\f170";
}
.fa-bitbucket:before {
  content: "\f171";
}
.fa-bitbucket-square:before {
  content: "\f172";
}
.fa-tumblr:before {
  content: "\f173";
}
.fa-tumblr-square:before {
  content: "\f174";
}
.fa-long-arrow-down:before {
  content: "\f175";
}
.fa-long-arrow-up:before {
  content: "\f176";
}
.fa-long-arrow-left:before {
  content: "\f177";
}
.fa-long-arrow-right:before {
  content: "\f178";
}
.fa-apple:before {
  content: "\f179";
}
.fa-windows:before {
  content: "\f17a";
}
.fa-android:before {
  content: "\f17b";
}
.fa-linux:before {
  content: "\f17c";
}
.fa-dribbble:before {
  content: "\f17d";
}
.fa-skype:before {
  content: "\f17e";
}
.fa-foursquare:before {
  content: "\f180";
}
.fa-trello:before {
  content: "\f181";
}
.fa-female:before {
  content: "\f182";
}
.fa-male:before {
  content: "\f183";
}
.fa-gittip:before,
.fa-gratipay:before {
  content: "\f184";
}
.fa-sun-o:before {
  content: "\f185";
}
.fa-moon-o:before {
  content: "\f186";
}
.fa-archive:before {
  content: "\f187";
}
.fa-bug:before {
  content: "\f188";
}
.fa-vk:before {
  content: "\f189";
}
.fa-weibo:before {
  content: "\f18a";
}
.fa-renren:before {
  content: "\f18b";
}
.fa-pagelines:before {
  content: "\f18c";
}
.fa-stack-exchange:before {
  content: "\f18d";
}
.fa-arrow-circle-o-right:before {
  content: "\f18e";
}
.fa-arrow-circle-o-left:before {
  content: "\f190";
}
.fa-toggle-left:before,
.fa-caret-square-o-left:before {
  content: "\f191";
}
.fa-dot-circle-o:before {
  content: "\f192";
}
.fa-wheelchair:before {
  content: "\f193";
}
.fa-vimeo-square:before {
  content: "\f194";
}
.fa-turkish-lira:before,
.fa-try:before {
  content: "\f195";
}
.fa-plus-square-o:before {
  content: "\f196";
}
.fa-space-shuttle:before {
  content: "\f197";
}
.fa-slack:before {
  content: "\f198";
}
.fa-envelope-square:before {
  content: "\f199";
}
.fa-wordpress:before {
  content: "\f19a";
}
.fa-openid:before {
  content: "\f19b";
}
.fa-institution:before,
.fa-bank:before,
.fa-university:before {
  content: "\f19c";
}
.fa-mortar-board:before,
.fa-graduation-cap:before {
  content: "\f19d";
}
.fa-yahoo:before {
  content: "\f19e";
}
.fa-google:before {
  content: "\f1a0";
}
.fa-reddit:before {
  content: "\f1a1";
}
.fa-reddit-square:before {
  content: "\f1a2";
}
.fa-stumbleupon-circle:before {
  content: "\f1a3";
}
.fa-stumbleupon:before {
  content: "\f1a4";
}
.fa-delicious:before {
  content: "\f1a5";
}
.fa-digg:before {
  content: "\f1a6";
}
.fa-pied-piper-pp:before {
  content: "\f1a7";
}
.fa-pied-piper-alt:before {
  content: "\f1a8";
}
.fa-drupal:before {
  content: "\f1a9";
}
.fa-joomla:before {
  content: "\f1aa";
}
.fa-language:before {
  content: "\f1ab";
}
.fa-fax:before {
  content: "\f1ac";
}
.fa-building:before {
  content: "\f1ad";
}
.fa-child:before {
  content: "\f1ae";
}
.fa-paw:before {
  content: "\f1b0";
}
.fa-spoon:before {
  content: "\f1b1";
}
.fa-cube:before {
  content: "\f1b2";
}
.fa-cubes:before {
  content: "\f1b3";
}
.fa-behance:before {
  content: "\f1b4";
}
.fa-behance-square:before {
  content: "\f1b5";
}
.fa-steam:before {
  content: "\f1b6";
}
.fa-steam-square:before {
  content: "\f1b7";
}
.fa-recycle:before {
  content: "\f1b8";
}
.fa-automobile:before,
.fa-car:before {
  content: "\f1b9";
}
.fa-cab:before,
.fa-taxi:before {
  content: "\f1ba";
}
.fa-tree:before {
  content: "\f1bb";
}
.fa-spotify:before {
  content: "\f1bc";
}
.fa-deviantart:before {
  content: "\f1bd";
}
.fa-soundcloud:before {
  content: "\f1be";
}
.fa-database:before {
  content: "\f1c0";
}
.fa-file-pdf-o:before {
  content: "\f1c1";
}
.fa-file-word-o:before {
  content: "\f1c2";
}
.fa-file-excel-o:before {
  content: "\f1c3";
}
.fa-file-powerpoint-o:before {
  content: "\f1c4";
}
.fa-file-photo-o:before,
.fa-file-picture-o:before,
.fa-file-image-o:before {
  content: "\f1c5";
}
.fa-file-zip-o:before,
.fa-file-archive-o:before {
  content: "\f1c6";
}
.fa-file-sound-o:before,
.fa-file-audio-o:before {
  content: "\f1c7";
}
.fa-file-movie-o:before,
.fa-file-video-o:before {
  content: "\f1c8";
}
.fa-file-code-o:before {
  content: "\f1c9";
}
.fa-vine:before {
  content: "\f1ca";
}
.fa-codepen:before {
  content: "\f1cb";
}
.fa-jsfiddle:before {
  content: "\f1cc";
}
.fa-life-bouy:before,
.fa-life-buoy:before,
.fa-life-saver:before,
.fa-support:before,
.fa-life-ring:before {
  content: "\f1cd";
}
.fa-circle-o-notch:before {
  content: "\f1ce";
}
.fa-ra:before,
.fa-resistance:before,
.fa-rebel:before {
  content: "\f1d0";
}
.fa-ge:before,
.fa-empire:before {
  content: "\f1d1";
}
.fa-git-square:before {
  content: "\f1d2";
}
.fa-git:before {
  content: "\f1d3";
}
.fa-y-combinator-square:before,
.fa-yc-square:before,
.fa-hacker-news:before {
  content: "\f1d4";
}
.fa-tencent-weibo:before {
  content: "\f1d5";
}
.fa-qq:before {
  content: "\f1d6";
}
.fa-wechat:before,
.fa-weixin:before {
  content: "\f1d7";
}
.fa-send:before,
.fa-paper-plane:before {
  content: "\f1d8";
}
.fa-send-o:before,
.fa-paper-plane-o:before {
  content: "\f1d9";
}
.fa-history:before {
  content: "\f1da";
}
.fa-circle-thin:before {
  content: "\f1db";
}
.fa-header:before {
  content: "\f1dc";
}
.fa-paragraph:before {
  content: "\f1dd";
}
.fa-sliders:before {
  content: "\f1de";
}
.fa-share-alt:before {
  content: "\f1e0";
}
.fa-share-alt-square:before {
  content: "\f1e1";
}
.fa-bomb:before {
  content: "\f1e2";
}
.fa-soccer-ball-o:before,
.fa-futbol-o:before {
  content: "\f1e3";
}
.fa-tty:before {
  content: "\f1e4";
}
.fa-binoculars:before {
  content: "\f1e5";
}
.fa-plug:before {
  content: "\f1e6";
}
.fa-slideshare:before {
  content: "\f1e7";
}
.fa-twitch:before {
  content: "\f1e8";
}
.fa-yelp:before {
  content: "\f1e9";
}
.fa-newspaper-o:before {
  content: "\f1ea";
}
.fa-wifi:before {
  content: "\f1eb";
}
.fa-calculator:before {
  content: "\f1ec";
}
.fa-paypal:before {
  content: "\f1ed";
}
.fa-google-wallet:before {
  content: "\f1ee";
}
.fa-cc-visa:before {
  content: "\f1f0";
}
.fa-cc-mastercard:before {
  content: "\f1f1";
}
.fa-cc-discover:before {
  content: "\f1f2";
}
.fa-cc-amex:before {
  content: "\f1f3";
}
.fa-cc-paypal:before {
  content: "\f1f4";
}
.fa-cc-stripe:before {
  content: "\f1f5";
}
.fa-bell-slash:before {
  content: "\f1f6";
}
.fa-bell-slash-o:before {
  content: "\f1f7";
}
.fa-trash:before {
  content: "\f1f8";
}
.fa-copyright:before {
  content: "\f1f9";
}
.fa-at:before {
  content: "\f1fa";
}
.fa-eyedropper:before {
  content: "\f1fb";
}
.fa-paint-brush:before {
  content: "\f1fc";
}
.fa-birthday-cake:before {
  content: "\f1fd";
}
.fa-area-chart:before {
  content: "\f1fe";
}
.fa-pie-chart:before {
  content: "\f200";
}
.fa-line-chart:before {
  content: "\f201";
}
.fa-lastfm:before {
  content: "\f202";
}
.fa-lastfm-square:before {
  content: "\f203";
}
.fa-toggle-off:before {
  content: "\f204";
}
.fa-toggle-on:before {
  content: "\f205";
}
.fa-bicycle:before {
  content: "\f206";
}
.fa-bus:before {
  content: "\f207";
}
.fa-ioxhost:before {
  content: "\f208";
}
.fa-angellist:before {
  content: "\f209";
}
.fa-cc:before {
  content: "\f20a";
}
.fa-shekel:before,
.fa-sheqel:before,
.fa-ils:before {
  content: "\f20b";
}
.fa-meanpath:before {
  content: "\f20c";
}
.fa-buysellads:before {
  content: "\f20d";
}
.fa-connectdevelop:before {
  content: "\f20e";
}
.fa-dashcube:before {
  content: "\f210";
}
.fa-forumbee:before {
  content: "\f211";
}
.fa-leanpub:before {
  content: "\f212";
}
.fa-sellsy:before {
  content: "\f213";
}
.fa-shirtsinbulk:before {
  content: "\f214";
}
.fa-simplybuilt:before {
  content: "\f215";
}
.fa-skyatlas:before {
  content: "\f216";
}
.fa-cart-plus:before {
  content: "\f217";
}
.fa-cart-arrow-down:before {
  content: "\f218";
}
.fa-diamond:before {
  content: "\f219";
}
.fa-ship:before {
  content: "\f21a";
}
.fa-user-secret:before {
  content: "\f21b";
}
.fa-motorcycle:before {
  content: "\f21c";
}
.fa-street-view:before {
  content: "\f21d";
}
.fa-heartbeat:before {
  content: "\f21e";
}
.fa-venus:before {
  content: "\f221";
}
.fa-mars:before {
  content: "\f222";
}
.fa-mercury:before {
  content: "\f223";
}
.fa-intersex:before,
.fa-transgender:before {
  content: "\f224";
}
.fa-transgender-alt:before {
  content: "\f225";
}
.fa-venus-double:before {
  content: "\f226";
}
.fa-mars-double:before {
  content: "\f227";
}
.fa-venus-mars:before {
  content: "\f228";
}
.fa-mars-stroke:before {
  content: "\f229";
}
.fa-mars-stroke-v:before {
  content: "\f22a";
}
.fa-mars-stroke-h:before {
  content: "\f22b";
}
.fa-neuter:before {
  content: "\f22c";
}
.fa-genderless:before {
  content: "\f22d";
}
.fa-facebook-official:before {
  content: "\f230";
}
.fa-pinterest-p:before {
  content: "\f231";
}
.fa-whatsapp:before {
  content: "\f232";
}
.fa-server:before {
  content: "\f233";
}
.fa-user-plus:before {
  content: "\f234";
}
.fa-user-times:before {
  content: "\f235";
}
.fa-hotel:before,
.fa-bed:before {
  content: "\f236";
}
.fa-viacoin:before {
  content: "\f237";
}
.fa-train:before {
  content: "\f238";
}
.fa-subway:before {
  content: "\f239";
}
.fa-medium:before {
  content: "\f23a";
}
.fa-yc:before,
.fa-y-combinator:before {
  content: "\f23b";
}
.fa-optin-monster:before {
  content: "\f23c";
}
.fa-opencart:before {
  content: "\f23d";
}
.fa-expeditedssl:before {
  content: "\f23e";
}
.fa-battery-4:before,
.fa-battery:before,
.fa-battery-full:before {
  content: "\f240";
}
.fa-battery-3:before,
.fa-battery-three-quarters:before {
  content: "\f241";
}
.fa-battery-2:before,
.fa-battery-half:before {
  content: "\f242";
}
.fa-battery-1:before,
.fa-battery-quarter:before {
  content: "\f243";
}
.fa-battery-0:before,
.fa-battery-empty:before {
  content: "\f244";
}
.fa-mouse-pointer:before {
  content: "\f245";
}
.fa-i-cursor:before {
  content: "\f246";
}
.fa-object-group:before {
  content: "\f247";
}
.fa-object-ungroup:before {
  content: "\f248";
}
.fa-sticky-note:before {
  content: "\f249";
}
.fa-sticky-note-o:before {
  content: "\f24a";
}
.fa-cc-jcb:before {
  content: "\f24b";
}
.fa-cc-diners-club:before {
  content: "\f24c";
}
.fa-clone:before {
  content: "\f24d";
}
.fa-balance-scale:before {
  content: "\f24e";
}
.fa-hourglass-o:before {
  content: "\f250";
}
.fa-hourglass-1:before,
.fa-hourglass-start:before {
  content: "\f251";
}
.fa-hourglass-2:before,
.fa-hourglass-half:before {
  content: "\f252";
}
.fa-hourglass-3:before,
.fa-hourglass-end:before {
  content: "\f253";
}
.fa-hourglass:before {
  content: "\f254";
}
.fa-hand-grab-o:before,
.fa-hand-rock-o:before {
  content: "\f255";
}
.fa-hand-stop-o:before,
.fa-hand-paper-o:before {
  content: "\f256";
}
.fa-hand-scissors-o:before {
  content: "\f257";
}
.fa-hand-lizard-o:before {
  content: "\f258";
}
.fa-hand-spock-o:before {
  content: "\f259";
}
.fa-hand-pointer-o:before {
  content: "\f25a";
}
.fa-hand-peace-o:before {
  content: "\f25b";
}
.fa-trademark:before {
  content: "\f25c";
}
.fa-registered:before {
  content: "\f25d";
}
.fa-creative-commons:before {
  content: "\f25e";
}
.fa-gg:before {
  content: "\f260";
}
.fa-gg-circle:before {
  content: "\f261";
}
.fa-tripadvisor:before {
  content: "\f262";
}
.fa-odnoklassniki:before {
  content: "\f263";
}
.fa-odnoklassniki-square:before {
  content: "\f264";
}
.fa-get-pocket:before {
  content: "\f265";
}
.fa-wikipedia-w:before {
  content: "\f266";
}
.fa-safari:before {
  content: "\f267";
}
.fa-chrome:before {
  content: "\f268";
}
.fa-firefox:before {
  content: "\f269";
}
.fa-opera:before {
  content: "\f26a";
}
.fa-internet-explorer:before {
  content: "\f26b";
}
.fa-tv:before,
.fa-television:before {
  content: "\f26c";
}
.fa-contao:before {
  content: "\f26d";
}
.fa-500px:before {
  content: "\f26e";
}
.fa-amazon:before {
  content: "\f270";
}
.fa-calendar-plus-o:before {
  content: "\f271";
}
.fa-calendar-minus-o:before {
  content: "\f272";
}
.fa-calendar-times-o:before {
  content: "\f273";
}
.fa-calendar-check-o:before {
  content: "\f274";
}
.fa-industry:before {
  content: "\f275";
}
.fa-map-pin:before {
  content: "\f276";
}
.fa-map-signs:before {
  content: "\f277";
}
.fa-map-o:before {
  content: "\f278";
}
.fa-map:before {
  content: "\f279";
}
.fa-commenting:before {
  content: "\f27a";
}
.fa-commenting-o:before {
  content: "\f27b";
}
.fa-houzz:before {
  content: "\f27c";
}
.fa-vimeo:before {
  content: "\f27d";
}
.fa-black-tie:before {
  content: "\f27e";
}
.fa-fonticons:before {
  content: "\f280";
}
.fa-reddit-alien:before {
  content: "\f281";
}
.fa-edge:before {
  content: "\f282";
}
.fa-credit-card-alt:before {
  content: "\f283";
}
.fa-codiepie:before {
  content: "\f284";
}
.fa-modx:before {
  content: "\f285";
}
.fa-fort-awesome:before {
  content: "\f286";
}
.fa-usb:before {
  content: "\f287";
}
.fa-product-hunt:before {
  content: "\f288";
}
.fa-mixcloud:before {
  content: "\f289";
}
.fa-scribd:before {
  content: "\f28a";
}
.fa-pause-circle:before {
  content: "\f28b";
}
.fa-pause-circle-o:before {
  content: "\f28c";
}
.fa-stop-circle:before {
  content: "\f28d";
}
.fa-stop-circle-o:before {
  content: "\f28e";
}
.fa-shopping-bag:before {
  content: "\f290";
}
.fa-shopping-basket:before {
  content: "\f291";
}
.fa-hashtag:before {
  content: "\f292";
}
.fa-bluetooth:before {
  content: "\f293";
}
.fa-bluetooth-b:before {
  content: "\f294";
}
.fa-percent:before {
  content: "\f295";
}
.fa-gitlab:before {
  content: "\f296";
}
.fa-wpbeginner:before {
  content: "\f297";
}
.fa-wpforms:before {
  content: "\f298";
}
.fa-envira:before {
  content: "\f299";
}
.fa-universal-access:before {
  content: "\f29a";
}
.fa-wheelchair-alt:before {
  content: "\f29b";
}
.fa-question-circle-o:before {
  content: "\f29c";
}
.fa-blind:before {
  content: "\f29d";
}
.fa-audio-description:before {
  content: "\f29e";
}
.fa-volume-control-phone:before {
  content: "\f2a0";
}
.fa-braille:before {
  content: "\f2a1";
}
.fa-assistive-listening-systems:before {
  content: "\f2a2";
}
.fa-asl-interpreting:before,
.fa-american-sign-language-interpreting:before {
  content: "\f2a3";
}
.fa-deafness:before,
.fa-hard-of-hearing:before,
.fa-deaf:before {
  content: "\f2a4";
}
.fa-glide:before {
  content: "\f2a5";
}
.fa-glide-g:before {
  content: "\f2a6";
}
.fa-signing:before,
.fa-sign-language:before {
  content: "\f2a7";
}
.fa-low-vision:before {
  content: "\f2a8";
}
.fa-viadeo:before {
  content: "\f2a9";
}
.fa-viadeo-square:before {
  content: "\f2aa";
}
.fa-snapchat:before {
  content: "\f2ab";
}
.fa-snapchat-ghost:before {
  content: "\f2ac";
}
.fa-snapchat-square:before {
  content: "\f2ad";
}
.fa-pied-piper:before {
  content: "\f2ae";
}
.fa-first-order:before {
  content: "\f2b0";
}
.fa-yoast:before {
  content: "\f2b1";
}
.fa-themeisle:before {
  content: "\f2b2";
}
.fa-google-plus-circle:before,
.fa-google-plus-official:before {
  content: "\f2b3";
}
.fa-fa:before,
.fa-font-awesome:before {
  content: "\f2b4";
}
.fa-handshake-o:before {
  content: "\f2b5";
}
.fa-envelope-open:before {
  content: "\f2b6";
}
.fa-envelope-open-o:before {
  content: "\f2b7";
}
.fa-linode:before {
  content: "\f2b8";
}
.fa-address-book:before {
  content: "\f2b9";
}
.fa-address-book-o:before {
  content: "\f2ba";
}
.fa-vcard:before,
.fa-address-card:before {
  content: "\f2bb";
}
.fa-vcard-o:before,
.fa-address-card-o:before {
  content: "\f2bc";
}
.fa-user-circle:before {
  content: "\f2bd";
}
.fa-user-circle-o:before {
  content: "\f2be";
}
.fa-user-o:before {
  content: "\f2c0";
}
.fa-id-badge:before {
  content: "\f2c1";
}
.fa-drivers-license:before,
.fa-id-card:before {
  content: "\f2c2";
}
.fa-drivers-license-o:before,
.fa-id-card-o:before {
  content: "\f2c3";
}
.fa-quora:before {
  content: "\f2c4";
}
.fa-free-code-camp:before {
  content: "\f2c5";
}
.fa-telegram:before {
  content: "\f2c6";
}
.fa-thermometer-4:before,
.fa-thermometer:before,
.fa-thermometer-full:before {
  content: "\f2c7";
}
.fa-thermometer-3:before,
.fa-thermometer-three-quarters:before {
  content: "\f2c8";
}
.fa-thermometer-2:before,
.fa-thermometer-half:before {
  content: "\f2c9";
}
.fa-thermometer-1:before,
.fa-thermometer-quarter:before {
  content: "\f2ca";
}
.fa-thermometer-0:before,
.fa-thermometer-empty:before {
  content: "\f2cb";
}
.fa-shower:before {
  content: "\f2cc";
}
.fa-bathtub:before,
.fa-s15:before,
.fa-bath:before {
  content: "\f2cd";
}
.fa-podcast:before {
  content: "\f2ce";
}
.fa-window-maximize:before {
  content: "\f2d0";
}
.fa-window-minimize:before {
  content: "\f2d1";
}
.fa-window-restore:before {
  content: "\f2d2";
}
.fa-times-rectangle:before,
.fa-window-close:before {
  content: "\f2d3";
}
.fa-times-rectangle-o:before,
.fa-window-close-o:before {
  content: "\f2d4";
}
.fa-bandcamp:before {
  content: "\f2d5";
}
.fa-grav:before {
  content: "\f2d6";
}
.fa-etsy:before {
  content: "\f2d7";
}
.fa-imdb:before {
  content: "\f2d8";
}
.fa-ravelry:before {
  content: "\f2d9";
}
.fa-eercast:before {
  content: "\f2da";
}
.fa-microchip:before {
  content: "\f2db";
}
.fa-snowflake-o:before {
  content: "\f2dc";
}
.fa-superpowers:before {
  content: "\f2dd";
}
.fa-wpexplorer:before {
  content: "\f2de";
}
.fa-meetup:before {
  content: "\f2e0";
}
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  border: 0;
}
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  clip: auto;
}
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  clip: auto;
}
/*!
*
* IPython base
*
*/
.modal.fade .modal-dialog {
  -webkit-transform: translate(0, 0);
  -ms-transform: translate(0, 0);
  -o-transform: translate(0, 0);
  transform: translate(0, 0);
}
code {
  color: #000;
}
pre {
  font-size: inherit;
  line-height: inherit;
}
label {
  font-weight: normal;
}
/* Make the page background atleast 100% the height of the view port */
/* Make the page itself atleast 70% the height of the view port */
.border-box-sizing {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
.corner-all {
  border-radius: 2px;
}
.no-padding {
  padding: 0px;
}
/* Flexible box model classes */
/* Taken from Alex Russell http://infrequently.org/2009/08/css-3-progress/ */
/* This file is a compatability layer.  It allows the usage of flexible box 
model layouts accross multiple browsers, including older browsers.  The newest,
universal implementation of the flexible box model is used when available (see
`Modern browsers` comments below).  Browsers that are known to implement this 
new spec completely include:

    Firefox 28.0+
    Chrome 29.0+
    Internet Explorer 11+ 
    Opera 17.0+

Browsers not listed, including Safari, are supported via the styling under the
`Old browsers` comments below.
*/
.hbox {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
.hbox > * {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
}
.vbox {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
.vbox > * {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
}
.hbox.reverse,
.vbox.reverse,
.reverse {
  /* Old browsers */
  -webkit-box-direction: reverse;
  -moz-box-direction: reverse;
  box-direction: reverse;
  /* Modern browsers */
  flex-direction: row-reverse;
}
.hbox.box-flex0,
.vbox.box-flex0,
.box-flex0 {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
  width: auto;
}
.hbox.box-flex1,
.vbox.box-flex1,
.box-flex1 {
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
.hbox.box-flex,
.vbox.box-flex,
.box-flex {
  /* Old browsers */
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
.hbox.box-flex2,
.vbox.box-flex2,
.box-flex2 {
  /* Old browsers */
  -webkit-box-flex: 2;
  -moz-box-flex: 2;
  box-flex: 2;
  /* Modern browsers */
  flex: 2;
}
.box-group1 {
  /*  Deprecated */
  -webkit-box-flex-group: 1;
  -moz-box-flex-group: 1;
  box-flex-group: 1;
}
.box-group2 {
  /* Deprecated */
  -webkit-box-flex-group: 2;
  -moz-box-flex-group: 2;
  box-flex-group: 2;
}
.hbox.start,
.vbox.start,
.start {
  /* Old browsers */
  -webkit-box-pack: start;
  -moz-box-pack: start;
  box-pack: start;
  /* Modern browsers */
  justify-content: flex-start;
}
.hbox.end,
.vbox.end,
.end {
  /* Old browsers */
  -webkit-box-pack: end;
  -moz-box-pack: end;
  box-pack: end;
  /* Modern browsers */
  justify-content: flex-end;
}
.hbox.center,
.vbox.center,
.center {
  /* Old browsers */
  -webkit-box-pack: center;
  -moz-box-pack: center;
  box-pack: center;
  /* Modern browsers */
  justify-content: center;
}
.hbox.baseline,
.vbox.baseline,
.baseline {
  /* Old browsers */
  -webkit-box-pack: baseline;
  -moz-box-pack: baseline;
  box-pack: baseline;
  /* Modern browsers */
  justify-content: baseline;
}
.hbox.stretch,
.vbox.stretch,
.stretch {
  /* Old browsers */
  -webkit-box-pack: stretch;
  -moz-box-pack: stretch;
  box-pack: stretch;
  /* Modern browsers */
  justify-content: stretch;
}
.hbox.align-start,
.vbox.align-start,
.align-start {
  /* Old browsers */
  -webkit-box-align: start;
  -moz-box-align: start;
  box-align: start;
  /* Modern browsers */
  align-items: flex-start;
}
.hbox.align-end,
.vbox.align-end,
.align-end {
  /* Old browsers */
  -webkit-box-align: end;
  -moz-box-align: end;
  box-align: end;
  /* Modern browsers */
  align-items: flex-end;
}
.hbox.align-center,
.vbox.align-center,
.align-center {
  /* Old browsers */
  -webkit-box-align: center;
  -moz-box-align: center;
  box-align: center;
  /* Modern browsers */
  align-items: center;
}
.hbox.align-baseline,
.vbox.align-baseline,
.align-baseline {
  /* Old browsers */
  -webkit-box-align: baseline;
  -moz-box-align: baseline;
  box-align: baseline;
  /* Modern browsers */
  align-items: baseline;
}
.hbox.align-stretch,
.vbox.align-stretch,
.align-stretch {
  /* Old browsers */
  -webkit-box-align: stretch;
  -moz-box-align: stretch;
  box-align: stretch;
  /* Modern browsers */
  align-items: stretch;
}
div.error {
  margin: 2em;
  text-align: center;
}
div.error > h1 {
  font-size: 500%;
  line-height: normal;
}
div.error > p {
  font-size: 200%;
  line-height: normal;
}
div.traceback-wrapper {
  text-align: left;
  max-width: 800px;
  margin: auto;
}
div.traceback-wrapper pre.traceback {
  max-height: 600px;
  overflow: auto;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
body {
  background-color: #fff;
  /* This makes sure that the body covers the entire window and needs to
       be in a different element than the display: box in wrapper below */
  position: absolute;
  left: 0px;
  right: 0px;
  top: 0px;
  bottom: 0px;
  overflow: visible;
}
body > #header {
  /* Initially hidden to prevent FLOUC */
  display: none;
  background-color: #fff;
  /* Display over codemirror */
  position: relative;
  z-index: 100;
}
body > #header #header-container {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  padding: 5px;
  padding-bottom: 5px;
  padding-top: 5px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
body > #header .header-bar {
  width: 100%;
  height: 1px;
  background: #e7e7e7;
  margin-bottom: -1px;
}
@media print {
  body > #header {
    display: none !important;
  }
}
#header-spacer {
  width: 100%;
  visibility: hidden;
}
@media print {
  #header-spacer {
    display: none;
  }
}
#ipython_notebook {
  padding-left: 0px;
  padding-top: 1px;
  padding-bottom: 1px;
}
[dir="rtl"] #ipython_notebook {
  margin-right: 10px;
  margin-left: 0;
}
[dir="rtl"] #ipython_notebook.pull-left {
  float: right !important;
  float: right;
}
.flex-spacer {
  flex: 1;
}
#noscript {
  width: auto;
  padding-top: 16px;
  padding-bottom: 16px;
  text-align: center;
  font-size: 22px;
  color: red;
  font-weight: bold;
}
#ipython_notebook img {
  height: 28px;
}
#site {
  width: 100%;
  display: none;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  overflow: auto;
}
@media print {
  #site {
    height: auto !important;
  }
}
/* Smaller buttons */
.ui-button .ui-button-text {
  padding: 0.2em 0.8em;
  font-size: 77%;
}
input.ui-button {
  padding: 0.3em 0.9em;
}
span#kernel_logo_widget {
  margin: 0 10px;
}
span#login_widget {
  float: right;
}
[dir="rtl"] span#login_widget {
  float: left;
}
span#login_widget > .button,
#logout {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
span#login_widget > .button:focus,
#logout:focus,
span#login_widget > .button.focus,
#logout.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
span#login_widget > .button:hover,
#logout:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
span#login_widget > .button:active,
#logout:active,
span#login_widget > .button.active,
#logout.active,
.open > .dropdown-togglespan#login_widget > .button,
.open > .dropdown-toggle#logout {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
span#login_widget > .button:active:hover,
#logout:active:hover,
span#login_widget > .button.active:hover,
#logout.active:hover,
.open > .dropdown-togglespan#login_widget > .button:hover,
.open > .dropdown-toggle#logout:hover,
span#login_widget > .button:active:focus,
#logout:active:focus,
span#login_widget > .button.active:focus,
#logout.active:focus,
.open > .dropdown-togglespan#login_widget > .button:focus,
.open > .dropdown-toggle#logout:focus,
span#login_widget > .button:active.focus,
#logout:active.focus,
span#login_widget > .button.active.focus,
#logout.active.focus,
.open > .dropdown-togglespan#login_widget > .button.focus,
.open > .dropdown-toggle#logout.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
span#login_widget > .button:active,
#logout:active,
span#login_widget > .button.active,
#logout.active,
.open > .dropdown-togglespan#login_widget > .button,
.open > .dropdown-toggle#logout {
  background-image: none;
}
span#login_widget > .button.disabled:hover,
#logout.disabled:hover,
span#login_widget > .button[disabled]:hover,
#logout[disabled]:hover,
fieldset[disabled] span#login_widget > .button:hover,
fieldset[disabled] #logout:hover,
span#login_widget > .button.disabled:focus,
#logout.disabled:focus,
span#login_widget > .button[disabled]:focus,
#logout[disabled]:focus,
fieldset[disabled] span#login_widget > .button:focus,
fieldset[disabled] #logout:focus,
span#login_widget > .button.disabled.focus,
#logout.disabled.focus,
span#login_widget > .button[disabled].focus,
#logout[disabled].focus,
fieldset[disabled] span#login_widget > .button.focus,
fieldset[disabled] #logout.focus {
  background-color: #fff;
  border-color: #ccc;
}
span#login_widget > .button .badge,
#logout .badge {
  color: #fff;
  background-color: #333;
}
.nav-header {
  text-transform: none;
}
#header > span {
  margin-top: 10px;
}
.modal_stretch .modal-dialog {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  min-height: 80vh;
}
.modal_stretch .modal-dialog .modal-body {
  max-height: calc(100vh - 200px);
  overflow: auto;
  flex: 1;
}
.modal-header {
  cursor: move;
}
@media (min-width: 768px) {
  .modal .modal-dialog {
    width: 700px;
  }
}
@media (min-width: 768px) {
  select.form-control {
    margin-left: 12px;
    margin-right: 12px;
  }
}
/*!
*
* IPython auth
*
*/
.center-nav {
  display: inline-block;
  margin-bottom: -4px;
}
[dir="rtl"] .center-nav form.pull-left {
  float: right !important;
  float: right;
}
[dir="rtl"] .center-nav .navbar-text {
  float: right;
}
[dir="rtl"] .navbar-inner {
  text-align: right;
}
[dir="rtl"] div.text-left {
  text-align: right;
}
/*!
*
* IPython tree view
*
*/
/* We need an invisible input field on top of the sentense*/
/* "Drag file onto the list ..." */
.alternate_upload {
  background-color: none;
  display: inline;
}
.alternate_upload.form {
  padding: 0;
  margin: 0;
}
.alternate_upload input.fileinput {
  position: absolute;
  display: block;
  width: 100%;
  height: 100%;
  overflow: hidden;
  cursor: pointer;
  opacity: 0;
  z-index: 2;
}
.alternate_upload .btn-xs > input.fileinput {
  margin: -1px -5px;
}
.alternate_upload .btn-upload {
  position: relative;
  height: 22px;
}
::-webkit-file-upload-button {
  cursor: pointer;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
ul#tabs {
  margin-bottom: 4px;
}
ul#tabs a {
  padding-top: 6px;
  padding-bottom: 4px;
}
[dir="rtl"] ul#tabs.nav-tabs > li {
  float: right;
}
[dir="rtl"] ul#tabs.nav.nav-tabs {
  padding-right: 0;
}
ul.breadcrumb a:focus,
ul.breadcrumb a:hover {
  text-decoration: none;
}
ul.breadcrumb i.icon-home {
  font-size: 16px;
  margin-right: 4px;
}
ul.breadcrumb span {
  color: #5e5e5e;
}
.list_toolbar {
  padding: 4px 0 4px 0;
  vertical-align: middle;
}
.list_toolbar .tree-buttons {
  padding-top: 1px;
}
[dir="rtl"] .list_toolbar .tree-buttons .pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .list_toolbar .col-sm-4,
[dir="rtl"] .list_toolbar .col-sm-8 {
  float: right;
}
.dynamic-buttons {
  padding-top: 3px;
  display: inline-block;
}
.list_toolbar [class*="span"] {
  min-height: 24px;
}
.list_header {
  font-weight: bold;
  background-color: #EEE;
}
.list_placeholder {
  font-weight: bold;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
}
.list_container {
  margin-top: 4px;
  margin-bottom: 20px;
  border: 1px solid #ddd;
  border-radius: 2px;
}
.list_container > div {
  border-bottom: 1px solid #ddd;
}
.list_container > div:hover .list-item {
  background-color: red;
}
.list_container > div:last-child {
  border: none;
}
.list_item:hover .list_item {
  background-color: #ddd;
}
.list_item a {
  text-decoration: none;
}
.list_item:hover {
  background-color: #fafafa;
}
.list_header > div,
.list_item > div {
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
  line-height: 22px;
}
.list_header > div input,
.list_item > div input {
  margin-right: 7px;
  margin-left: 14px;
  vertical-align: text-bottom;
  line-height: 22px;
  position: relative;
  top: -1px;
}
.list_header > div .item_link,
.list_item > div .item_link {
  margin-left: -1px;
  vertical-align: baseline;
  line-height: 22px;
}
[dir="rtl"] .list_item > div input {
  margin-right: 0;
}
.new-file input[type=checkbox] {
  visibility: hidden;
}
.item_name {
  line-height: 22px;
  height: 24px;
}
.item_icon {
  font-size: 14px;
  color: #5e5e5e;
  margin-right: 7px;
  margin-left: 7px;
  line-height: 22px;
  vertical-align: baseline;
}
.item_modified {
  margin-right: 7px;
  margin-left: 7px;
}
[dir="rtl"] .item_modified.pull-right {
  float: left !important;
  float: left;
}
.item_buttons {
  line-height: 1em;
  margin-left: -5px;
}
.item_buttons .btn,
.item_buttons .btn-group,
.item_buttons .input-group {
  float: left;
}
.item_buttons > .btn,
.item_buttons > .btn-group,
.item_buttons > .input-group {
  margin-left: 5px;
}
.item_buttons .btn {
  min-width: 13ex;
}
.item_buttons .running-indicator {
  padding-top: 4px;
  color: #5cb85c;
}
.item_buttons .kernel-name {
  padding-top: 4px;
  color: #5bc0de;
  margin-right: 7px;
  float: left;
}
[dir="rtl"] .item_buttons.pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .item_buttons .kernel-name {
  margin-left: 7px;
  float: right;
}
.toolbar_info {
  height: 24px;
  line-height: 24px;
}
.list_item input:not([type=checkbox]) {
  padding-top: 3px;
  padding-bottom: 3px;
  height: 22px;
  line-height: 14px;
  margin: 0px;
}
.highlight_text {
  color: blue;
}
#project_name {
  display: inline-block;
  padding-left: 7px;
  margin-left: -2px;
}
#project_name > .breadcrumb {
  padding: 0px;
  margin-bottom: 0px;
  background-color: transparent;
  font-weight: bold;
}
.sort_button {
  display: inline-block;
  padding-left: 7px;
}
[dir="rtl"] .sort_button.pull-right {
  float: left !important;
  float: left;
}
#tree-selector {
  padding-right: 0px;
}
#button-select-all {
  min-width: 50px;
}
[dir="rtl"] #button-select-all.btn {
  float: right ;
}
#select-all {
  margin-left: 7px;
  margin-right: 2px;
  margin-top: 2px;
  height: 16px;
}
[dir="rtl"] #select-all.pull-left {
  float: right !important;
  float: right;
}
.menu_icon {
  margin-right: 2px;
}
.tab-content .row {
  margin-left: 0px;
  margin-right: 0px;
}
.folder_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f114";
}
.folder_icon:before.fa-pull-left {
  margin-right: .3em;
}
.folder_icon:before.fa-pull-right {
  margin-left: .3em;
}
.folder_icon:before.pull-left {
  margin-right: .3em;
}
.folder_icon:before.pull-right {
  margin-left: .3em;
}
.notebook_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f02d";
  position: relative;
  top: -1px;
}
.notebook_icon:before.fa-pull-left {
  margin-right: .3em;
}
.notebook_icon:before.fa-pull-right {
  margin-left: .3em;
}
.notebook_icon:before.pull-left {
  margin-right: .3em;
}
.notebook_icon:before.pull-right {
  margin-left: .3em;
}
.running_notebook_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f02d";
  position: relative;
  top: -1px;
  color: #5cb85c;
}
.running_notebook_icon:before.fa-pull-left {
  margin-right: .3em;
}
.running_notebook_icon:before.fa-pull-right {
  margin-left: .3em;
}
.running_notebook_icon:before.pull-left {
  margin-right: .3em;
}
.running_notebook_icon:before.pull-right {
  margin-left: .3em;
}
.file_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f016";
  position: relative;
  top: -2px;
}
.file_icon:before.fa-pull-left {
  margin-right: .3em;
}
.file_icon:before.fa-pull-right {
  margin-left: .3em;
}
.file_icon:before.pull-left {
  margin-right: .3em;
}
.file_icon:before.pull-right {
  margin-left: .3em;
}
#notebook_toolbar .pull-right {
  padding-top: 0px;
  margin-right: -1px;
}
ul#new-menu {
  left: auto;
  right: 0;
}
#new-menu .dropdown-header {
  font-size: 10px;
  border-bottom: 1px solid #e5e5e5;
  padding: 0 0 3px;
  margin: -3px 20px 0;
}
.kernel-menu-icon {
  padding-right: 12px;
  width: 24px;
  content: "\f096";
}
.kernel-menu-icon:before {
  content: "\f096";
}
.kernel-menu-icon-current:before {
  content: "\f00c";
}
#tab_content {
  padding-top: 20px;
}
#running .panel-group .panel {
  margin-top: 3px;
  margin-bottom: 1em;
}
#running .panel-group .panel .panel-heading {
  background-color: #EEE;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
  line-height: 22px;
}
#running .panel-group .panel .panel-heading a:focus,
#running .panel-group .panel .panel-heading a:hover {
  text-decoration: none;
}
#running .panel-group .panel .panel-body {
  padding: 0px;
}
#running .panel-group .panel .panel-body .list_container {
  margin-top: 0px;
  margin-bottom: 0px;
  border: 0px;
  border-radius: 0px;
}
#running .panel-group .panel .panel-body .list_container .list_item {
  border-bottom: 1px solid #ddd;
}
#running .panel-group .panel .panel-body .list_container .list_item:last-child {
  border-bottom: 0px;
}
.delete-button {
  display: none;
}
.duplicate-button {
  display: none;
}
.rename-button {
  display: none;
}
.move-button {
  display: none;
}
.download-button {
  display: none;
}
.shutdown-button {
  display: none;
}
.dynamic-instructions {
  display: inline-block;
  padding-top: 4px;
}
/*!
*
* IPython text editor webapp
*
*/
.selected-keymap i.fa {
  padding: 0px 5px;
}
.selected-keymap i.fa:before {
  content: "\f00c";
}
#mode-menu {
  overflow: auto;
  max-height: 20em;
}
.edit_app #header {
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
.edit_app #menubar .navbar {
  /* Use a negative 1 bottom margin, so the border overlaps the border of the
    header */
  margin-bottom: -1px;
}
.dirty-indicator {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator.pull-left {
  margin-right: .3em;
}
.dirty-indicator.pull-right {
  margin-left: .3em;
}
.dirty-indicator-dirty {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator-dirty.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator-dirty.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator-dirty.pull-left {
  margin-right: .3em;
}
.dirty-indicator-dirty.pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator-clean.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean.pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean.pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f00c";
}
.dirty-indicator-clean:before.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean:before.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean:before.pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean:before.pull-right {
  margin-left: .3em;
}
#filename {
  font-size: 16pt;
  display: table;
  padding: 0px 5px;
}
#current-mode {
  padding-left: 5px;
  padding-right: 5px;
}
#texteditor-backdrop {
  padding-top: 20px;
  padding-bottom: 20px;
}
@media not print {
  #texteditor-backdrop {
    background-color: #EEE;
  }
}
@media print {
  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,
  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {
    background-color: #fff;
  }
}
@media not print {
  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,
  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {
    background-color: #fff;
  }
}
@media not print {
  #texteditor-backdrop #texteditor-container {
    padding: 0px;
    background-color: #fff;
    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  }
}
.CodeMirror-dialog {
  background-color: #fff;
}
/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #3E424D;
}
.ansi-black-bg {
  background-color: #3E424D;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #E75C58;
}
.ansi-red-bg {
  background-color: #E75C58;
}
.ansi-red-intense-fg {
  color: #B22B31;
}
.ansi-red-intense-bg {
  background-color: #B22B31;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #DDB62B;
}
.ansi-yellow-bg {
  background-color: #DDB62B;
}
.ansi-yellow-intense-fg {
  color: #B27D12;
}
.ansi-yellow-intense-bg {
  background-color: #B27D12;
}
.ansi-blue-fg {
  color: #208FFB;
}
.ansi-blue-bg {
  background-color: #208FFB;
}
.ansi-blue-intense-fg {
  color: #0065CA;
}
.ansi-blue-intense-bg {
  background-color: #0065CA;
}
.ansi-magenta-fg {
  color: #D160C4;
}
.ansi-magenta-bg {
  background-color: #D160C4;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #60C6C8;
}
.ansi-cyan-bg {
  background-color: #60C6C8;
}
.ansi-cyan-intense-fg {
  color: #258F8F;
}
.ansi-cyan-intense-bg {
  background-color: #258F8F;
}
.ansi-white-fg {
  color: #C5C1B4;
}
.ansi-white-bg {
  background-color: #C5C1B4;
}
.ansi-white-intense-fg {
  color: #A1A6B2;
}
.ansi-white-intense-bg {
  background-color: #A1A6B2;
}
.ansi-default-inverse-fg {
  color: #FFFFFF;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #42A5F5;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #66BB6A;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area .rendered_html table {
  margin-left: 0;
  margin-right: 0;
}
div.output_area .rendered_html img {
  margin-left: 0;
  margin-right: 0;
}
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph > img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}
.rendered_html em {
  font-style: italic;
}
.rendered_html strong {
  font-weight: bold;
}
.rendered_html u {
  text-decoration: underline;
}
.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}
.rendered_html h1 {
  font-size: 185.7%;
  margin: 1.08em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h2 {
  font-size: 157.1%;
  margin: 1.27em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h3 {
  font-size: 128.6%;
  margin: 1.55em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h4 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h5 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
  font-style: italic;
}
.rendered_html h6 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
  font-style: italic;
}
.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}
.rendered_html ul {
  list-style: disc;
}
.rendered_html ul ul {
  list-style: square;
  margin-top: 0;
}
.rendered_html ul ul ul {
  list-style: circle;
}
.rendered_html ol {
  list-style: decimal;
}
.rendered_html ol ol {
  list-style: upper-alpha;
  margin-top: 0;
}
.rendered_html ol ol ol {
  list-style: lower-alpha;
}
.rendered_html ol ol ol ol {
  list-style: lower-roman;
}
.rendered_html ol ol ol ol ol {
  list-style: decimal;
}
.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}
.rendered_html hr {
  color: black;
  background-color: black;
}
.rendered_html pre {
  margin: 1em 2em;
  padding: 0px;
  background-color: #fff;
}
.rendered_html code {
  background-color: #eff0f1;
}
.rendered_html p code {
  padding: 1px 5px;
}
.rendered_html pre code {
  background-color: #fff;
}
.rendered_html pre,
.rendered_html code {
  border: 0;
  color: #000;
  font-size: 100%;
}
.rendered_html blockquote {
  margin: 1em 2em;
}
.rendered_html table {
  margin-left: auto;
  margin-right: auto;
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.rendered_html tr,
.rendered_html th,
.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.rendered_html th {
  font-weight: bold;
}
.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}
.rendered_html p {
  text-align: left;
}
.rendered_html * + p {
  margin-top: 1em;
}
.rendered_html img {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,
.rendered_html svg {
  max-width: 100%;
  height: auto;
}
.rendered_html img.unconfined,
.rendered_html svg.unconfined {
  max-width: none;
}
.rendered_html .alert {
  margin-bottom: initial;
}
.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] .rendered_html p {
  text-align: right;
}
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered .rendered_html {
  overflow-x: auto;
  overflow-y: hidden;
}
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered .rendered_html td {
  max-width: none;
}
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
/*!
*
* IPython notebook webapp
*
*/
@media (max-width: 767px) {
  .notebook_app {
    padding-left: 0px;
    padding-right: 0px;
  }
}
#ipython-main-app {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  height: 100%;
}
div#notebook_panel {
  margin: 0px;
  padding: 0px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  height: 100%;
}
div#notebook {
  font-size: 14px;
  line-height: 20px;
  overflow-y: hidden;
  overflow-x: auto;
  width: 100%;
  /* This spaces the page away from the edge of the notebook area */
  padding-top: 20px;
  margin: 0px;
  outline: none;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  min-height: 100%;
}
@media not print {
  #notebook-container {
    padding: 15px;
    background-color: #fff;
    min-height: 0;
    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  }
}
@media print {
  #notebook-container {
    width: 100%;
  }
}
div.ui-widget-content {
  border: 1px solid #ababab;
  outline: none;
}
pre.dialog {
  background-color: #f7f7f7;
  border: 1px solid #ddd;
  border-radius: 2px;
  padding: 0.4em;
  padding-left: 2em;
}
p.dialog {
  padding: 0.2em;
}
/* Word-wrap output correctly.  This is the CSS3 spelling, though Firefox seems
   to not honor it correctly.  Webkit browsers (Chrome, rekonq, Safari) do.
 */
pre,
code,
kbd,
samp {
  white-space: pre-wrap;
}
#fonttest {
  font-family: monospace;
}
p {
  margin-bottom: 0;
}
.end_space {
  min-height: 100px;
  transition: height .2s ease;
}
.notebook_app > #header {
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
@media not print {
  .notebook_app {
    background-color: #EEE;
  }
}
kbd {
  border-style: solid;
  border-width: 1px;
  box-shadow: none;
  margin: 2px;
  padding-left: 2px;
  padding-right: 2px;
  padding-top: 1px;
  padding-bottom: 1px;
}
.jupyter-keybindings {
  padding: 1px;
  line-height: 24px;
  border-bottom: 1px solid gray;
}
.jupyter-keybindings input {
  margin: 0;
  padding: 0;
  border: none;
}
.jupyter-keybindings i {
  padding: 6px;
}
.well code {
  background-color: #ffffff;
  border-color: #ababab;
  border-width: 1px;
  border-style: solid;
  padding: 2px;
  padding-top: 1px;
  padding-bottom: 1px;
}
/* CSS for the cell toolbar */
.celltoolbar {
  border: thin solid #CFCFCF;
  border-bottom: none;
  background: #EEE;
  border-radius: 2px 2px 0px 0px;
  width: 100%;
  height: 29px;
  padding-right: 4px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-pack: end;
  -moz-box-pack: end;
  box-pack: end;
  /* Modern browsers */
  justify-content: flex-end;
  display: -webkit-flex;
}
@media print {
  .celltoolbar {
    display: none;
  }
}
.ctb_hideshow {
  display: none;
  vertical-align: bottom;
}
/* ctb_show is added to the ctb_hideshow div to show the cell toolbar.
   Cell toolbars are only shown when the ctb_global_show class is also set.
*/
.ctb_global_show .ctb_show.ctb_hideshow {
  display: block;
}
.ctb_global_show .ctb_show + .input_area,
.ctb_global_show .ctb_show + div.text_cell_input,
.ctb_global_show .ctb_show ~ div.text_cell_render {
  border-top-right-radius: 0px;
  border-top-left-radius: 0px;
}
.ctb_global_show .ctb_show ~ div.text_cell_render {
  border: 1px solid #cfcfcf;
}
.celltoolbar {
  font-size: 87%;
  padding-top: 3px;
}
.celltoolbar select {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
  width: inherit;
  font-size: inherit;
  height: 22px;
  padding: 0px;
  display: inline-block;
}
.celltoolbar select:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.celltoolbar select::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.celltoolbar select:-ms-input-placeholder {
  color: #999;
}
.celltoolbar select::-webkit-input-placeholder {
  color: #999;
}
.celltoolbar select::-ms-expand {
  border: 0;
  background-color: transparent;
}
.celltoolbar select[disabled],
.celltoolbar select[readonly],
fieldset[disabled] .celltoolbar select {
  background-color: #eeeeee;
  opacity: 1;
}
.celltoolbar select[disabled],
fieldset[disabled] .celltoolbar select {
  cursor: not-allowed;
}
textarea.celltoolbar select {
  height: auto;
}
select.celltoolbar select {
  height: 30px;
  line-height: 30px;
}
textarea.celltoolbar select,
select[multiple].celltoolbar select {
  height: auto;
}
.celltoolbar label {
  margin-left: 5px;
  margin-right: 5px;
}
.tags_button_container {
  width: 100%;
  display: flex;
}
.tag-container {
  display: flex;
  flex-direction: row;
  flex-grow: 1;
  overflow: hidden;
  position: relative;
}
.tag-container > * {
  margin: 0 4px;
}
.remove-tag-btn {
  margin-left: 4px;
}
.tags-input {
  display: flex;
}
.cell-tag:last-child:after {
  content: "";
  position: absolute;
  right: 0;
  width: 40px;
  height: 100%;
  /* Fade to background color of cell toolbar */
  background: linear-gradient(to right, rgba(0, 0, 0, 0), #EEE);
}
.tags-input > * {
  margin-left: 4px;
}
.cell-tag,
.tags-input input,
.tags-input button {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
  box-shadow: none;
  width: inherit;
  font-size: inherit;
  height: 22px;
  line-height: 22px;
  padding: 0px 4px;
  display: inline-block;
}
.cell-tag:focus,
.tags-input input:focus,
.tags-input button:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.cell-tag::-moz-placeholder,
.tags-input input::-moz-placeholder,
.tags-input button::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.cell-tag:-ms-input-placeholder,
.tags-input input:-ms-input-placeholder,
.tags-input button:-ms-input-placeholder {
  color: #999;
}
.cell-tag::-webkit-input-placeholder,
.tags-input input::-webkit-input-placeholder,
.tags-input button::-webkit-input-placeholder {
  color: #999;
}
.cell-tag::-ms-expand,
.tags-input input::-ms-expand,
.tags-input button::-ms-expand {
  border: 0;
  background-color: transparent;
}
.cell-tag[disabled],
.tags-input input[disabled],
.tags-input button[disabled],
.cell-tag[readonly],
.tags-input input[readonly],
.tags-input button[readonly],
fieldset[disabled] .cell-tag,
fieldset[disabled] .tags-input input,
fieldset[disabled] .tags-input button {
  background-color: #eeeeee;
  opacity: 1;
}
.cell-tag[disabled],
.tags-input input[disabled],
.tags-input button[disabled],
fieldset[disabled] .cell-tag,
fieldset[disabled] .tags-input input,
fieldset[disabled] .tags-input button {
  cursor: not-allowed;
}
textarea.cell-tag,
textarea.tags-input input,
textarea.tags-input button {
  height: auto;
}
select.cell-tag,
select.tags-input input,
select.tags-input button {
  height: 30px;
  line-height: 30px;
}
textarea.cell-tag,
textarea.tags-input input,
textarea.tags-input button,
select[multiple].cell-tag,
select[multiple].tags-input input,
select[multiple].tags-input button {
  height: auto;
}
.cell-tag,
.tags-input button {
  padding: 0px 4px;
}
.cell-tag {
  background-color: #fff;
  white-space: nowrap;
}
.tags-input input[type=text]:focus {
  outline: none;
  box-shadow: none;
  border-color: #ccc;
}
.completions {
  position: absolute;
  z-index: 110;
  overflow: hidden;
  border: 1px solid #ababab;
  border-radius: 2px;
  -webkit-box-shadow: 0px 6px 10px -1px #adadad;
  box-shadow: 0px 6px 10px -1px #adadad;
  line-height: 1;
}
.completions select {
  background: white;
  outline: none;
  border: none;
  padding: 0px;
  margin: 0px;
  overflow: auto;
  font-family: monospace;
  font-size: 110%;
  color: #000;
  width: auto;
}
.completions select option.context {
  color: #286090;
}
#kernel_logo_widget .current_kernel_logo {
  display: none;
  margin-top: -1px;
  margin-bottom: -1px;
  width: 32px;
  height: 32px;
}
[dir="rtl"] #kernel_logo_widget {
  float: left !important;
  float: left;
}
.modal .modal-body .move-path {
  display: flex;
  flex-direction: row;
  justify-content: space;
  align-items: center;
}
.modal .modal-body .move-path .server-root {
  padding-right: 20px;
}
.modal .modal-body .move-path .path-input {
  flex: 1;
}
#menubar {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  margin-top: 1px;
}
#menubar .navbar {
  border-top: 1px;
  border-radius: 0px 0px 2px 2px;
  margin-bottom: 0px;
}
#menubar .navbar-toggle {
  float: left;
  padding-top: 7px;
  padding-bottom: 7px;
  border: none;
}
#menubar .navbar-collapse {
  clear: left;
}
[dir="rtl"] #menubar .navbar-toggle {
  float: right;
}
[dir="rtl"] #menubar .navbar-collapse {
  clear: right;
}
[dir="rtl"] #menubar .navbar-nav {
  float: right;
}
[dir="rtl"] #menubar .nav {
  padding-right: 0px;
}
[dir="rtl"] #menubar .navbar-nav > li {
  float: right;
}
[dir="rtl"] #menubar .navbar-right {
  float: left !important;
}
[dir="rtl"] ul.dropdown-menu {
  text-align: right;
  left: auto;
}
[dir="rtl"] ul#new-menu.dropdown-menu {
  right: auto;
  left: 0;
}
.nav-wrapper {
  border-bottom: 1px solid #e7e7e7;
}
i.menu-icon {
  padding-top: 4px;
}
[dir="rtl"] i.menu-icon.pull-right {
  float: left !important;
  float: left;
}
ul#help_menu li a {
  overflow: hidden;
  padding-right: 2.2em;
}
ul#help_menu li a i {
  margin-right: -1.2em;
}
[dir="rtl"] ul#help_menu li a {
  padding-left: 2.2em;
}
[dir="rtl"] ul#help_menu li a i {
  margin-right: 0;
  margin-left: -1.2em;
}
[dir="rtl"] ul#help_menu li a i.pull-right {
  float: left !important;
  float: left;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu > .dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
}
[dir="rtl"] .dropdown-submenu > .dropdown-menu {
  right: 100%;
  margin-right: -1px;
}
.dropdown-submenu:hover > .dropdown-menu {
  display: block;
}
.dropdown-submenu > a:after {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  display: block;
  content: "\f0da";
  float: right;
  color: #333333;
  margin-top: 2px;
  margin-right: -10px;
}
.dropdown-submenu > a:after.fa-pull-left {
  margin-right: .3em;
}
.dropdown-submenu > a:after.fa-pull-right {
  margin-left: .3em;
}
.dropdown-submenu > a:after.pull-left {
  margin-right: .3em;
}
.dropdown-submenu > a:after.pull-right {
  margin-left: .3em;
}
[dir="rtl"] .dropdown-submenu > a:after {
  float: left;
  content: "\f0d9";
  margin-right: 0;
  margin-left: -10px;
}
.dropdown-submenu:hover > a:after {
  color: #262626;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left > .dropdown-menu {
  left: -100%;
  margin-left: 10px;
}
#notification_area {
  float: right !important;
  float: right;
  z-index: 10;
}
[dir="rtl"] #notification_area {
  float: left !important;
  float: left;
}
.indicator_area {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
}
[dir="rtl"] .indicator_area {
  float: left !important;
  float: left;
}
#kernel_indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
  border-left: 1px solid;
}
#kernel_indicator .kernel_indicator_name {
  padding-left: 5px;
  padding-right: 5px;
}
[dir="rtl"] #kernel_indicator {
  float: left !important;
  float: left;
  border-left: 0;
  border-right: 1px solid;
}
#modal_indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
}
[dir="rtl"] #modal_indicator {
  float: left !important;
  float: left;
}
#readonly-indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
  margin-top: 2px;
  margin-bottom: 0px;
  margin-left: 0px;
  margin-right: 0px;
  display: none;
}
.modal_indicator:before {
  width: 1.28571429em;
  text-align: center;
}
.edit_mode .modal_indicator:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f040";
}
.edit_mode .modal_indicator:before.fa-pull-left {
  margin-right: .3em;
}
.edit_mode .modal_indicator:before.fa-pull-right {
  margin-left: .3em;
}
.edit_mode .modal_indicator:before.pull-left {
  margin-right: .3em;
}
.edit_mode .modal_indicator:before.pull-right {
  margin-left: .3em;
}
.command_mode .modal_indicator:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: ' ';
}
.command_mode .modal_indicator:before.fa-pull-left {
  margin-right: .3em;
}
.command_mode .modal_indicator:before.fa-pull-right {
  margin-left: .3em;
}
.command_mode .modal_indicator:before.pull-left {
  margin-right: .3em;
}
.command_mode .modal_indicator:before.pull-right {
  margin-left: .3em;
}
.kernel_idle_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f10c";
}
.kernel_idle_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_idle_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_idle_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_idle_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_busy_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f111";
}
.kernel_busy_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_busy_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_busy_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_busy_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_dead_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f1e2";
}
.kernel_dead_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_dead_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_dead_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_dead_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_disconnected_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f127";
}
.kernel_disconnected_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_disconnected_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_disconnected_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_disconnected_icon:before.pull-right {
  margin-left: .3em;
}
.notification_widget {
  color: #777;
  z-index: 10;
  background: rgba(240, 240, 240, 0.5);
  margin-right: 4px;
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
.notification_widget:focus,
.notification_widget.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
.notification_widget:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.notification_widget:active,
.notification_widget.active,
.open > .dropdown-toggle.notification_widget {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.notification_widget:active:hover,
.notification_widget.active:hover,
.open > .dropdown-toggle.notification_widget:hover,
.notification_widget:active:focus,
.notification_widget.active:focus,
.open > .dropdown-toggle.notification_widget:focus,
.notification_widget:active.focus,
.notification_widget.active.focus,
.open > .dropdown-toggle.notification_widget.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
.notification_widget:active,
.notification_widget.active,
.open > .dropdown-toggle.notification_widget {
  background-image: none;
}
.notification_widget.disabled:hover,
.notification_widget[disabled]:hover,
fieldset[disabled] .notification_widget:hover,
.notification_widget.disabled:focus,
.notification_widget[disabled]:focus,
fieldset[disabled] .notification_widget:focus,
.notification_widget.disabled.focus,
.notification_widget[disabled].focus,
fieldset[disabled] .notification_widget.focus {
  background-color: #fff;
  border-color: #ccc;
}
.notification_widget .badge {
  color: #fff;
  background-color: #333;
}
.notification_widget.warning {
  color: #fff;
  background-color: #f0ad4e;
  border-color: #eea236;
}
.notification_widget.warning:focus,
.notification_widget.warning.focus {
  color: #fff;
  background-color: #ec971f;
  border-color: #985f0d;
}
.notification_widget.warning:hover {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.notification_widget.warning:active,
.notification_widget.warning.active,
.open > .dropdown-toggle.notification_widget.warning {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.notification_widget.warning:active:hover,
.notification_widget.warning.active:hover,
.open > .dropdown-toggle.notification_widget.warning:hover,
.notification_widget.warning:active:focus,
.notification_widget.warning.active:focus,
.open > .dropdown-toggle.notification_widget.warning:focus,
.notification_widget.warning:active.focus,
.notification_widget.warning.active.focus,
.open > .dropdown-toggle.notification_widget.warning.focus {
  color: #fff;
  background-color: #d58512;
  border-color: #985f0d;
}
.notification_widget.warning:active,
.notification_widget.warning.active,
.open > .dropdown-toggle.notification_widget.warning {
  background-image: none;
}
.notification_widget.warning.disabled:hover,
.notification_widget.warning[disabled]:hover,
fieldset[disabled] .notification_widget.warning:hover,
.notification_widget.warning.disabled:focus,
.notification_widget.warning[disabled]:focus,
fieldset[disabled] .notification_widget.warning:focus,
.notification_widget.warning.disabled.focus,
.notification_widget.warning[disabled].focus,
fieldset[disabled] .notification_widget.warning.focus {
  background-color: #f0ad4e;
  border-color: #eea236;
}
.notification_widget.warning .badge {
  color: #f0ad4e;
  background-color: #fff;
}
.notification_widget.success {
  color: #fff;
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.notification_widget.success:focus,
.notification_widget.success.focus {
  color: #fff;
  background-color: #449d44;
  border-color: #255625;
}
.notification_widget.success:hover {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.notification_widget.success:active,
.notification_widget.success.active,
.open > .dropdown-toggle.notification_widget.success {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.notification_widget.success:active:hover,
.notification_widget.success.active:hover,
.open > .dropdown-toggle.notification_widget.success:hover,
.notification_widget.success:active:focus,
.notification_widget.success.active:focus,
.open > .dropdown-toggle.notification_widget.success:focus,
.notification_widget.success:active.focus,
.notification_widget.success.active.focus,
.open > .dropdown-toggle.notification_widget.success.focus {
  color: #fff;
  background-color: #398439;
  border-color: #255625;
}
.notification_widget.success:active,
.notification_widget.success.active,
.open > .dropdown-toggle.notification_widget.success {
  background-image: none;
}
.notification_widget.success.disabled:hover,
.notification_widget.success[disabled]:hover,
fieldset[disabled] .notification_widget.success:hover,
.notification_widget.success.disabled:focus,
.notification_widget.success[disabled]:focus,
fieldset[disabled] .notification_widget.success:focus,
.notification_widget.success.disabled.focus,
.notification_widget.success[disabled].focus,
fieldset[disabled] .notification_widget.success.focus {
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.notification_widget.success .badge {
  color: #5cb85c;
  background-color: #fff;
}
.notification_widget.info {
  color: #fff;
  background-color: #5bc0de;
  border-color: #46b8da;
}
.notification_widget.info:focus,
.notification_widget.info.focus {
  color: #fff;
  background-color: #31b0d5;
  border-color: #1b6d85;
}
.notification_widget.info:hover {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.notification_widget.info:active,
.notification_widget.info.active,
.open > .dropdown-toggle.notification_widget.info {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.notification_widget.info:active:hover,
.notification_widget.info.active:hover,
.open > .dropdown-toggle.notification_widget.info:hover,
.notification_widget.info:active:focus,
.notification_widget.info.active:focus,
.open > .dropdown-toggle.notification_widget.info:focus,
.notification_widget.info:active.focus,
.notification_widget.info.active.focus,
.open > .dropdown-toggle.notification_widget.info.focus {
  color: #fff;
  background-color: #269abc;
  border-color: #1b6d85;
}
.notification_widget.info:active,
.notification_widget.info.active,
.open > .dropdown-toggle.notification_widget.info {
  background-image: none;
}
.notification_widget.info.disabled:hover,
.notification_widget.info[disabled]:hover,
fieldset[disabled] .notification_widget.info:hover,
.notification_widget.info.disabled:focus,
.notification_widget.info[disabled]:focus,
fieldset[disabled] .notification_widget.info:focus,
.notification_widget.info.disabled.focus,
.notification_widget.info[disabled].focus,
fieldset[disabled] .notification_widget.info.focus {
  background-color: #5bc0de;
  border-color: #46b8da;
}
.notification_widget.info .badge {
  color: #5bc0de;
  background-color: #fff;
}
.notification_widget.danger {
  color: #fff;
  background-color: #d9534f;
  border-color: #d43f3a;
}
.notification_widget.danger:focus,
.notification_widget.danger.focus {
  color: #fff;
  background-color: #c9302c;
  border-color: #761c19;
}
.notification_widget.danger:hover {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.notification_widget.danger:active,
.notification_widget.danger.active,
.open > .dropdown-toggle.notification_widget.danger {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.notification_widget.danger:active:hover,
.notification_widget.danger.active:hover,
.open > .dropdown-toggle.notification_widget.danger:hover,
.notification_widget.danger:active:focus,
.notification_widget.danger.active:focus,
.open > .dropdown-toggle.notification_widget.danger:focus,
.notification_widget.danger:active.focus,
.notification_widget.danger.active.focus,
.open > .dropdown-toggle.notification_widget.danger.focus {
  color: #fff;
  background-color: #ac2925;
  border-color: #761c19;
}
.notification_widget.danger:active,
.notification_widget.danger.active,
.open > .dropdown-toggle.notification_widget.danger {
  background-image: none;
}
.notification_widget.danger.disabled:hover,
.notification_widget.danger[disabled]:hover,
fieldset[disabled] .notification_widget.danger:hover,
.notification_widget.danger.disabled:focus,
.notification_widget.danger[disabled]:focus,
fieldset[disabled] .notification_widget.danger:focus,
.notification_widget.danger.disabled.focus,
.notification_widget.danger[disabled].focus,
fieldset[disabled] .notification_widget.danger.focus {
  background-color: #d9534f;
  border-color: #d43f3a;
}
.notification_widget.danger .badge {
  color: #d9534f;
  background-color: #fff;
}
div#pager {
  background-color: #fff;
  font-size: 14px;
  line-height: 20px;
  overflow: hidden;
  display: none;
  position: fixed;
  bottom: 0px;
  width: 100%;
  max-height: 50%;
  padding-top: 8px;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  /* Display over codemirror */
  z-index: 100;
  /* Hack which prevents jquery ui resizable from changing top. */
  top: auto !important;
}
div#pager pre {
  line-height: 1.21429em;
  color: #000;
  background-color: #f7f7f7;
  padding: 0.4em;
}
div#pager #pager-button-area {
  position: absolute;
  top: 8px;
  right: 20px;
}
div#pager #pager-contents {
  position: relative;
  overflow: auto;
  width: 100%;
  height: 100%;
}
div#pager #pager-contents #pager-container {
  position: relative;
  padding: 15px 0px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
div#pager .ui-resizable-handle {
  top: 0px;
  height: 8px;
  background: #f7f7f7;
  border-top: 1px solid #cfcfcf;
  border-bottom: 1px solid #cfcfcf;
  /* This injects handle bars (a short, wide = symbol) for 
        the resize handle. */
}
div#pager .ui-resizable-handle::after {
  content: '';
  top: 2px;
  left: 50%;
  height: 3px;
  width: 30px;
  margin-left: -15px;
  position: absolute;
  border-top: 1px solid #cfcfcf;
}
.quickhelp {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
  line-height: 1.8em;
}
.shortcut_key {
  display: inline-block;
  width: 21ex;
  text-align: right;
  font-family: monospace;
}
.shortcut_descr {
  display: inline-block;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
span.save_widget {
  height: 30px;
  margin-top: 4px;
  display: flex;
  justify-content: flex-start;
  align-items: baseline;
  width: 50%;
  flex: 1;
}
span.save_widget span.filename {
  height: 100%;
  line-height: 1em;
  margin-left: 16px;
  border: none;
  font-size: 146.5%;
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;
  border-radius: 2px;
}
span.save_widget span.filename:hover {
  background-color: #e6e6e6;
}
[dir="rtl"] span.save_widget.pull-left {
  float: right !important;
  float: right;
}
[dir="rtl"] span.save_widget span.filename {
  margin-left: 0;
  margin-right: 16px;
}
span.checkpoint_status,
span.autosave_status {
  font-size: small;
  white-space: nowrap;
  padding: 0 5px;
}
@media (max-width: 767px) {
  span.save_widget {
    font-size: small;
    padding: 0 0 0 5px;
  }
  span.checkpoint_status,
  span.autosave_status {
    display: none;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  span.checkpoint_status {
    display: none;
  }
  span.autosave_status {
    font-size: x-small;
  }
}
.toolbar {
  padding: 0px;
  margin-left: -5px;
  margin-top: 2px;
  margin-bottom: 5px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
.toolbar select,
.toolbar label {
  width: auto;
  vertical-align: middle;
  margin-right: 2px;
  margin-bottom: 0px;
  display: inline;
  font-size: 92%;
  margin-left: 0.3em;
  margin-right: 0.3em;
  padding: 0px;
  padding-top: 3px;
}
.toolbar .btn {
  padding: 2px 8px;
}
.toolbar .btn-group {
  margin-top: 0px;
  margin-left: 5px;
}
.toolbar-btn-label {
  margin-left: 6px;
}
#maintoolbar {
  margin-bottom: -3px;
  margin-top: -8px;
  border: 0px;
  min-height: 27px;
  margin-left: 0px;
  padding-top: 11px;
  padding-bottom: 3px;
}
#maintoolbar .navbar-text {
  float: none;
  vertical-align: middle;
  text-align: right;
  margin-left: 5px;
  margin-right: 0px;
  margin-top: 0px;
}
.select-xs {
  height: 24px;
}
[dir="rtl"] .btn-group > .btn,
.btn-group-vertical > .btn {
  float: right;
}
.pulse,
.dropdown-menu > li > a.pulse,
li.pulse > a.dropdown-toggle,
li.pulse.open > a.dropdown-toggle {
  background-color: #F37626;
  color: white;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
/** WARNING IF YOU ARE EDITTING THIS FILE, if this is a .css file, It has a lot
 * of chance of beeing generated from the ../less/[samename].less file, you can
 * try to get back the less file by reverting somme commit in history
 **/
/*
 * We'll try to get something pretty, so we
 * have some strange css to have the scroll bar on
 * the left with fix button on the top right of the tooltip
 */
@-moz-keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}
@-webkit-keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}
@-moz-keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
@-webkit-keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
/*properties of tooltip after "expand"*/
.bigtooltip {
  overflow: auto;
  height: 200px;
  -webkit-transition-property: height;
  -webkit-transition-duration: 500ms;
  -moz-transition-property: height;
  -moz-transition-duration: 500ms;
  transition-property: height;
  transition-duration: 500ms;
}
/*properties of tooltip before "expand"*/
.smalltooltip {
  -webkit-transition-property: height;
  -webkit-transition-duration: 500ms;
  -moz-transition-property: height;
  -moz-transition-duration: 500ms;
  transition-property: height;
  transition-duration: 500ms;
  text-overflow: ellipsis;
  overflow: hidden;
  height: 80px;
}
.tooltipbuttons {
  position: absolute;
  padding-right: 15px;
  top: 0px;
  right: 0px;
}
.tooltiptext {
  /*avoid the button to overlap on some docstring*/
  padding-right: 30px;
}
.ipython_tooltip {
  max-width: 700px;
  /*fade-in animation when inserted*/
  -webkit-animation: fadeOut 400ms;
  -moz-animation: fadeOut 400ms;
  animation: fadeOut 400ms;
  -webkit-animation: fadeIn 400ms;
  -moz-animation: fadeIn 400ms;
  animation: fadeIn 400ms;
  vertical-align: middle;
  background-color: #f7f7f7;
  overflow: visible;
  border: #ababab 1px solid;
  outline: none;
  padding: 3px;
  margin: 0px;
  padding-left: 7px;
  font-family: monospace;
  min-height: 50px;
  -moz-box-shadow: 0px 6px 10px -1px #adadad;
  -webkit-box-shadow: 0px 6px 10px -1px #adadad;
  box-shadow: 0px 6px 10px -1px #adadad;
  border-radius: 2px;
  position: absolute;
  z-index: 1000;
}
.ipython_tooltip a {
  float: right;
}
.ipython_tooltip .tooltiptext pre {
  border: 0;
  border-radius: 0;
  font-size: 100%;
  background-color: #f7f7f7;
}
.pretooltiparrow {
  left: 0px;
  margin: 0px;
  top: -16px;
  width: 40px;
  height: 16px;
  overflow: hidden;
  position: absolute;
}
.pretooltiparrow:before {
  background-color: #f7f7f7;
  border: 1px #ababab solid;
  z-index: 11;
  content: "";
  position: absolute;
  left: 15px;
  top: 10px;
  width: 25px;
  height: 25px;
  -webkit-transform: rotate(45deg);
  -moz-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  -o-transform: rotate(45deg);
}
ul.typeahead-list i {
  margin-left: -10px;
  width: 18px;
}
[dir="rtl"] ul.typeahead-list i {
  margin-left: 0;
  margin-right: -10px;
}
ul.typeahead-list {
  max-height: 80vh;
  overflow: auto;
}
ul.typeahead-list > li > a {
  /** Firefox bug **/
  /* see https://github.com/jupyter/notebook/issues/559 */
  white-space: normal;
}
ul.typeahead-list  > li > a.pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .typeahead-list {
  text-align: right;
}
.cmd-palette .modal-body {
  padding: 7px;
}
.cmd-palette form {
  background: white;
}
.cmd-palette input {
  outline: none;
}
.no-shortcut {
  min-width: 20px;
  color: transparent;
}
[dir="rtl"] .no-shortcut.pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .command-shortcut.pull-right {
  float: left !important;
  float: left;
}
.command-shortcut:before {
  content: "(command mode)";
  padding-right: 3px;
  color: #777777;
}
.edit-shortcut:before {
  content: "(edit)";
  padding-right: 3px;
  color: #777777;
}
[dir="rtl"] .edit-shortcut.pull-right {
  float: left !important;
  float: left;
}
#find-and-replace #replace-preview .match,
#find-and-replace #replace-preview .insert {
  background-color: #BBDEFB;
  border-color: #90CAF9;
  border-style: solid;
  border-width: 1px;
  border-radius: 0px;
}
[dir="ltr"] #find-and-replace .input-group-btn + .form-control {
  border-left: none;
}
[dir="rtl"] #find-and-replace .input-group-btn + .form-control {
  border-right: none;
}
#find-and-replace #replace-preview .replace .match {
  background-color: #FFCDD2;
  border-color: #EF9A9A;
  border-radius: 0px;
}
#find-and-replace #replace-preview .replace .insert {
  background-color: #C8E6C9;
  border-color: #A5D6A7;
  border-radius: 0px;
}
#find-and-replace #replace-preview {
  max-height: 60vh;
  overflow: auto;
}
#find-and-replace #replace-preview pre {
  padding: 5px 10px;
}
.terminal-app {
  background: #EEE;
}
.terminal-app #header {
  background: #fff;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
.terminal-app .terminal {
  width: 100%;
  float: left;
  font-family: monospace;
  color: white;
  background: black;
  padding: 0.4em;
  border-radius: 2px;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);
}
.terminal-app .terminal,
.terminal-app .terminal dummy-screen {
  line-height: 1em;
  font-size: 14px;
}
.terminal-app .terminal .xterm-rows {
  padding: 10px;
}
.terminal-app .terminal-cursor {
  color: black;
  background: white;
}
.terminal-app #terminado-container {
  margin-top: 20px;
}
/*# sourceMappingURL=style.min.css.map */
    </style>
<style type="text/css">
    .highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
<style type="text/css">
    
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }

    </style>


<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
body {
  overflow: visible;
  padding: 8px;
}

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  } 
  div.output_wrapper { 
    display: block;
    page-break-inside: avoid; 
  }
  div.output { 
    display: block;
    page-break-inside: avoid; 
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>
<body>
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Data Loading</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
 
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">log_loss</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">QuantileTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="k">import</span> <span class="n">PCA</span>
 
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
 
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_dir</span> <span class="o">=</span> <span class="s1">&#39;../input/lish-moa/&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[3]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&#39;train_targets_scored.csv&#39;,
 &#39;sample_submission.csv&#39;,
 &#39;train_drug.csv&#39;,
 &#39;train_targets_nonscored.csv&#39;,
 &#39;train_features.csv&#39;,
 &#39;test_features.csv&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="o">/</span><span class="n">kaggle</span><span class="o">/</span><span class="nb">input</span><span class="o">/</span><span class="n">iterative</span><span class="o">-</span><span class="n">stratification</span><span class="o">/</span><span class="n">iterative</span><span class="o">-</span><span class="n">stratification</span><span class="o">-</span><span class="n">master</span><span class="o">/</span>
<span class="kn">from</span> <span class="nn">iterstrat.ml_stratifiers</span> <span class="k">import</span> <span class="n">MultilabelStratifiedKFold</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Processing /kaggle/input/iterative-stratification/iterative-stratification-master
Requirement already satisfied: numpy in /opt/conda/lib/python3.7/site-packages (from iterative-stratification==0.1.6) (1.18.5)
Requirement already satisfied: scipy in /opt/conda/lib/python3.7/site-packages (from iterative-stratification==0.1.6) (1.4.1)
Requirement already satisfied: scikit-learn in /opt/conda/lib/python3.7/site-packages (from iterative-stratification==0.1.6) (0.23.2)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /opt/conda/lib/python3.7/site-packages (from scikit-learn-&gt;iterative-stratification==0.1.6) (2.1.0)
Requirement already satisfied: joblib&gt;=0.11 in /opt/conda/lib/python3.7/site-packages (from scikit-learn-&gt;iterative-stratification==0.1.6) (0.14.1)
Building wheels for collected packages: iterative-stratification
  Building wheel for iterative-stratification (setup.py) ... done
  Created wheel for iterative-stratification: filename=iterative_stratification-0.1.6-py3-none-any.whl size=8401 sha256=70d46af3ed5fd1674e539261580e52c0b07f20235bd722b2de4fd4df69d142f7
  Stored in directory: /root/.cache/pip/wheels/b8/47/3f/eb4af42d124f37d23d6f13a4c8bbc32c1d70140e6e1cecb4aa
Successfully built iterative-stratification
Installing collected packages: iterative-stratification
Successfully installed iterative-stratification-0.1.6
<span class="ansi-yellow-fg">WARNING: You are using pip version 20.2.2; however, version 20.3.3 is available.
You should consider upgrading via the &#39;/opt/conda/bin/python3.7 -m pip install --upgrade pip&#39; command.</span>
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">+</span> <span class="s1">&#39;train_features.csv&#39;</span><span class="p">)</span>
<span class="n">train_targets_scored</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">+</span> <span class="s1">&#39;train_targets_scored.csv&#39;</span><span class="p">)</span>
<span class="n">train_targets_nonscored</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">+</span> <span class="s1">&#39;train_targets_nonscored.csv&#39;</span><span class="p">)</span>
<span class="n">train_drug</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">+</span> <span class="s1">&#39;train_drug.csv&#39;</span><span class="p">)</span>
<span class="n">test_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">+</span> <span class="s1">&#39;test_features.csv&#39;</span><span class="p">)</span>
<span class="n">sample_submission</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">+</span> <span class="s1">&#39;sample_submission.csv&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;train_features: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">train_features</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;train_targets_scored: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">train_targets_scored</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;train_targets_nonscored: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">train_targets_nonscored</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;train_drug: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">train_drug</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;test_features: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">test_features</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>train_features: (23814, 876)
train_targets_scored: (23814, 207)
train_targets_nonscored: (23814, 403)
train_drug: (23814, 2)
test_features: (3982, 876)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_features2</span><span class="o">=</span><span class="n">train_features</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">test_features2</span><span class="o">=</span><span class="n">test_features</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GENES</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">train_features</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;g-&#39;</span><span class="p">)]</span>
<span class="n">CELLS</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">train_features</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;c-&#39;</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="In-this-kernel-I-rewrite-RankGauss-here:">In this kernel I rewrite RankGauss here:<a class="anchor-link" href="#In-this-kernel-I-rewrite-RankGauss-here:">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># rewrite the original rank gaussian</span>
<span class="n">qt</span> <span class="o">=</span> <span class="n">QuantileTransformer</span><span class="p">(</span><span class="n">n_quantiles</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span><span class="n">output_distribution</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_features</span><span class="p">[</span><span class="n">GENES</span><span class="o">+</span><span class="n">CELLS</span><span class="p">]),</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test_features</span><span class="p">[</span><span class="n">GENES</span><span class="o">+</span><span class="n">CELLS</span><span class="p">])])</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">GENES</span><span class="o">+</span><span class="n">CELLS</span><span class="p">])</span>
<span class="n">train_features</span><span class="p">[</span><span class="n">GENES</span><span class="o">+</span><span class="n">CELLS</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data2</span><span class="p">[:</span><span class="n">train_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">test_features</span><span class="p">[</span><span class="n">GENES</span><span class="o">+</span><span class="n">CELLS</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data2</span><span class="p">[</span><span class="o">-</span><span class="n">test_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">seed_everything</span><span class="p">(</span><span class="n">seed_value</span><span class="p">):</span>
    <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span> 
        <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed_all</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">deterministic</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">benchmark</span> <span class="o">=</span> <span class="kc">False</span>
    
<span class="n">seed_everything</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="PCA-features-+-Existing-features">PCA features + Existing features<a class="anchor-link" href="#PCA-features-+-Existing-features">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Take n = 600 on gene differential expression columns and did PCA.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_comp</span> <span class="o">=</span> <span class="mi">600</span>  <span class="c1">#&lt;--Update</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_features</span><span class="p">[</span><span class="n">GENES</span><span class="p">]),</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test_features</span><span class="p">[</span><span class="n">GENES</span><span class="p">])])</span>
<span class="n">data2</span> <span class="o">=</span> <span class="p">(</span><span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_comp</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">GENES</span><span class="p">]))</span>
<span class="n">train2</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[:</span><span class="n">train_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span> 
<span class="n">test2</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[</span><span class="o">-</span><span class="n">test_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:]</span>

<span class="n">train_gpca</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;pca_G-</span><span class="si">{i}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_comp</span><span class="p">)])</span>
<span class="n">test_gpca</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;pca_G-</span><span class="si">{i}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_comp</span><span class="p">)])</span>

<span class="c1"># drop_cols = [f&#39;c-{i}&#39; for i in range(n_comp,len(GENES))]</span>
<span class="n">train_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">train_features</span><span class="p">,</span> <span class="n">train_gpca</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">test_features</span><span class="p">,</span> <span class="n">test_gpca</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Take n = 50 on cell variability columns and did PCA.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_comp</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1">#&lt;--Update</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_features</span><span class="p">[</span><span class="n">CELLS</span><span class="p">]),</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test_features</span><span class="p">[</span><span class="n">CELLS</span><span class="p">])])</span>
<span class="n">data2</span> <span class="o">=</span> <span class="p">(</span><span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_comp</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">CELLS</span><span class="p">]))</span>
<span class="n">train2</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[:</span><span class="n">train_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span> <span class="n">test2</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[</span><span class="o">-</span><span class="n">test_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:]</span>

<span class="n">train_cpca</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;pca_C-</span><span class="si">{i}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_comp</span><span class="p">)])</span>
<span class="n">test_cpca</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;pca_C-</span><span class="si">{i}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_comp</span><span class="p">)])</span>

<span class="c1"># drop_cols = [f&#39;c-{i}&#39; for i in range(n_comp,len(CELLS))]</span>
<span class="n">train_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">train_features</span><span class="p">,</span> <span class="n">train_cpca</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">test_features</span><span class="p">,</span> <span class="n">test_cpca</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Do feature Selection using Variance Encoding after PCA:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="k">import</span> <span class="n">VarianceThreshold</span>


<span class="n">var_thresh</span> <span class="o">=</span> <span class="n">VarianceThreshold</span><span class="p">(</span><span class="mf">0.85</span><span class="p">)</span>  <span class="c1">#&lt;-- Update</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">train_features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_features</span><span class="p">)</span>
<span class="n">data_transformed</span> <span class="o">=</span> <span class="n">var_thresh</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:])</span>

<span class="n">train_features_transformed</span> <span class="o">=</span> <span class="n">data_transformed</span><span class="p">[</span> <span class="p">:</span> <span class="n">train_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">test_features_transformed</span> <span class="o">=</span> <span class="n">data_transformed</span><span class="p">[</span><span class="o">-</span><span class="n">test_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="p">]</span>


<span class="n">train_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_features</span><span class="p">[[</span><span class="s1">&#39;sig_id&#39;</span><span class="p">,</span><span class="s1">&#39;cp_type&#39;</span><span class="p">,</span><span class="s1">&#39;cp_time&#39;</span><span class="p">,</span><span class="s1">&#39;cp_dose&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>\
                              <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sig_id&#39;</span><span class="p">,</span><span class="s1">&#39;cp_type&#39;</span><span class="p">,</span><span class="s1">&#39;cp_time&#39;</span><span class="p">,</span><span class="s1">&#39;cp_dose&#39;</span><span class="p">])</span>

<span class="n">train_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train_features</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_features_transformed</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


<span class="n">test_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test_features</span><span class="p">[[</span><span class="s1">&#39;sig_id&#39;</span><span class="p">,</span><span class="s1">&#39;cp_type&#39;</span><span class="p">,</span><span class="s1">&#39;cp_time&#39;</span><span class="p">,</span><span class="s1">&#39;cp_dose&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>\
                             <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sig_id&#39;</span><span class="p">,</span><span class="s1">&#39;cp_type&#39;</span><span class="p">,</span><span class="s1">&#39;cp_time&#39;</span><span class="p">,</span><span class="s1">&#39;cp_dose&#39;</span><span class="p">])</span>

<span class="n">test_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">test_features</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test_features_transformed</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now I am considering taking clustering algorithm before model building. 
Previous clustering method on single cell line can identify gene expression changes across conditions and help generate hypotheses as to underlying biological mechanisms. However, one problem in this data set is that each sample has considerable cellular heterogeneity that bulk RNA-seq methods are not able to capture. One goal of the clustering algorithm here is to distinguish between changes in cell-type composition and cell-state, which is identified as c-features.</p>
<p>Here clusters made by examing g-features is assigned under clusters grouped by c-features as subgroups.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="k">import</span> <span class="n">KMeans</span>
<span class="k">def</span> <span class="nf">fe_cluster</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">n_clusters_g</span> <span class="o">=</span> <span class="mi">22</span><span class="p">,</span> <span class="n">n_clusters_c</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">SEED</span> <span class="o">=</span> <span class="mi">42</span><span class="p">):</span>
    
    <span class="n">features_g</span> <span class="o">=</span> <span class="n">GENES</span>
    <span class="n">features_c</span> <span class="o">=</span> <span class="n">CELLS</span>
    
    <span class="k">def</span> <span class="nf">create_cluster</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">n_clusters</span> <span class="o">=</span> <span class="n">n_clusters_g</span><span class="p">):</span>
        <span class="n">train_</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">test_</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train_</span><span class="p">,</span> <span class="n">test_</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="n">n_clusters</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="n">SEED</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">train</span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;clusters_</span><span class="si">{kind}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">[:</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">test</span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;clusters_</span><span class="si">{kind}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">[</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:]</span>
        <span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="s1">&#39;clusters_</span><span class="si">{kind}</span><span class="s1">&#39;</span><span class="p">])</span>
        <span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="s1">&#39;clusters_</span><span class="si">{kind}</span><span class="s1">&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span>
    
    <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">create_cluster</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">features_g</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">n_clusters</span> <span class="o">=</span> <span class="n">n_clusters_g</span><span class="p">)</span>
    <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">create_cluster</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">features_c</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">n_clusters</span> <span class="o">=</span> <span class="n">n_clusters_c</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span>

<span class="n">train_features2</span> <span class="p">,</span><span class="n">test_features2</span><span class="o">=</span><span class="n">fe_cluster</span><span class="p">(</span><span class="n">train_features2</span><span class="p">,</span><span class="n">test_features2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now I try to concatenate the selected PCA features from both g-columns and c-columns, and did k-means clustering on this new set.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_pca</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">train_gpca</span><span class="p">,</span><span class="n">train_cpca</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_pca</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">test_gpca</span><span class="p">,</span><span class="n">test_cpca</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">fe_cluster_pca</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">SEED</span> <span class="o">=</span> <span class="mi">42</span><span class="p">):</span>
        <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">,</span><span class="n">test</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="n">n_clusters</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="n">SEED</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">train</span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;clusters_pca&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">[:</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">test</span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;clusters_pca&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">[</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:]</span>
        <span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="s1">&#39;clusters_pca&#39;</span><span class="p">])</span>
        <span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="s1">&#39;clusters_pca&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span>
<span class="n">train_cluster_pca</span> <span class="p">,</span><span class="n">test_cluster_pca</span> <span class="o">=</span> <span class="n">fe_cluster_pca</span><span class="p">(</span><span class="n">train_pca</span><span class="p">,</span><span class="n">test_pca</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now I get two types of clusters.  One is done directly on the Principle components, and one is constructed under the structure of g-subgroups under c-subgroups.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_cluster_pca</span> <span class="o">=</span> <span class="n">train_cluster_pca</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">650</span><span class="p">:]</span>
<span class="n">test_cluster_pca</span> <span class="o">=</span> <span class="n">test_cluster_pca</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">650</span><span class="p">:]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_features_cluster</span><span class="o">=</span><span class="n">train_features2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">876</span><span class="p">:]</span>
<span class="n">test_features_cluster</span><span class="o">=</span><span class="n">test_features2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">876</span><span class="p">:]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the EDA step we have found significant highly correlated features. I will recombine them then do feature selection. Also statistic of the g-columns and c-columns are calculated.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gsquarecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;g-574&#39;</span><span class="p">,</span><span class="s1">&#39;g-211&#39;</span><span class="p">,</span><span class="s1">&#39;g-216&#39;</span><span class="p">,</span><span class="s1">&#39;g-0&#39;</span><span class="p">,</span><span class="s1">&#39;g-255&#39;</span><span class="p">,</span><span class="s1">&#39;g-577&#39;</span><span class="p">,</span><span class="s1">&#39;g-153&#39;</span><span class="p">,</span><span class="s1">&#39;g-389&#39;</span><span class="p">,</span><span class="s1">&#39;g-60&#39;</span><span class="p">,</span><span class="s1">&#39;g-370&#39;</span><span class="p">,</span><span class="s1">&#39;g-248&#39;</span><span class="p">,</span><span class="s1">&#39;g-167&#39;</span><span class="p">,</span><span class="s1">&#39;g-203&#39;</span><span class="p">,</span><span class="s1">&#39;g-177&#39;</span><span class="p">,</span><span class="s1">&#39;g-301&#39;</span><span class="p">,</span><span class="s1">&#39;g-332&#39;</span><span class="p">,</span><span class="s1">&#39;g-517&#39;</span><span class="p">,</span><span class="s1">&#39;g-6&#39;</span><span class="p">,</span><span class="s1">&#39;g-744&#39;</span><span class="p">,</span><span class="s1">&#39;g-224&#39;</span><span class="p">,</span><span class="s1">&#39;g-162&#39;</span><span class="p">,</span><span class="s1">&#39;g-3&#39;</span><span class="p">,</span><span class="s1">&#39;g-736&#39;</span><span class="p">,</span><span class="s1">&#39;g-486&#39;</span><span class="p">,</span><span class="s1">&#39;g-283&#39;</span><span class="p">,</span><span class="s1">&#39;g-22&#39;</span><span class="p">,</span><span class="s1">&#39;g-359&#39;</span><span class="p">,</span><span class="s1">&#39;g-361&#39;</span><span class="p">,</span><span class="s1">&#39;g-440&#39;</span><span class="p">,</span><span class="s1">&#39;g-335&#39;</span><span class="p">,</span><span class="s1">&#39;g-106&#39;</span><span class="p">,</span><span class="s1">&#39;g-307&#39;</span><span class="p">,</span><span class="s1">&#39;g-745&#39;</span><span class="p">,</span><span class="s1">&#39;g-146&#39;</span><span class="p">,</span><span class="s1">&#39;g-416&#39;</span><span class="p">,</span><span class="s1">&#39;g-298&#39;</span><span class="p">,</span><span class="s1">&#39;g-666&#39;</span><span class="p">,</span><span class="s1">&#39;g-91&#39;</span><span class="p">,</span><span class="s1">&#39;g-17&#39;</span><span class="p">,</span><span class="s1">&#39;g-549&#39;</span><span class="p">,</span><span class="s1">&#39;g-145&#39;</span><span class="p">,</span><span class="s1">&#39;g-157&#39;</span><span class="p">,</span><span class="s1">&#39;g-768&#39;</span><span class="p">,</span><span class="s1">&#39;g-568&#39;</span><span class="p">,</span><span class="s1">&#39;g-396&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">fe_stats</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">):</span>
    
    <span class="n">features_g</span> <span class="o">=</span> <span class="n">GENES</span>
    <span class="n">features_c</span> <span class="o">=</span> <span class="n">CELLS</span>
    
    <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;g_sum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;g_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;g_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;g_kurt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span><span class="p">]</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;g_skew&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span><span class="p">]</span><span class="o">.</span><span class="n">skew</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c_sum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c_kurt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c_skew&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">skew</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gc_sum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span> <span class="o">+</span> <span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gc_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span> <span class="o">+</span> <span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gc_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span> <span class="o">+</span> <span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gc_kurt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span> <span class="o">+</span> <span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gc_skew&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span> <span class="o">+</span> <span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">skew</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c52_c42&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-52&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-42&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c13_c73&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-13&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-73&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c26_c13&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-23&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-13&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c33_c6&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-33&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-6&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c11_c55&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-11&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-55&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c38_c63&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-38&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-63&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c38_c94&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-38&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-94&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c13_c94&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-13&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-94&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c4_c52&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-4&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-52&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c4_c42&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-4&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-42&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c13_c38&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-13&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-38&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c55_c2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-55&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-2&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c55_c4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-55&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-4&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c4_c13&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-4&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-13&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c82_c42&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-82&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-42&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c66_c42&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-66&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-42&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c6_c38&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-6&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-38&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c2_c13&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-2&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-13&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c62_c42&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-62&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-42&#39;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c90_c55&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-90&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c-55&#39;</span><span class="p">]</span>
        
        
        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">features_c</span><span class="p">:</span>
             <span class="n">df</span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{feature}</span><span class="s1">_squared&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>     
                
        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">gsquarecols</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{feature}</span><span class="s1">_squared&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>        
        
    <span class="k">return</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span>

<span class="n">train_features2</span><span class="p">,</span><span class="n">test_features2</span><span class="o">=</span><span class="n">fe_stats</span><span class="p">(</span><span class="n">train_features2</span><span class="p">,</span><span class="n">test_features2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_features_stats</span><span class="o">=</span><span class="n">train_features2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">902</span><span class="p">:]</span>
<span class="n">test_features_stats</span><span class="o">=</span><span class="n">test_features2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">902</span><span class="p">:]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">train_features</span><span class="p">,</span> <span class="n">train_features_cluster</span><span class="p">,</span><span class="n">train_cluster_pca</span><span class="p">,</span><span class="n">train_features_stats</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">test_features</span><span class="p">,</span> <span class="n">test_features_cluster</span><span class="p">,</span><span class="n">test_cluster_pca</span><span class="p">,</span><span class="n">test_features_stats</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_drug</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[22]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sig_id</th>
      <th>drug_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id_000644bb2</td>
      <td>b68db1d53</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id_000779bfc</td>
      <td>df89a8e5a</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id_000a6266a</td>
      <td>18bb41b2c</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id_0015fd391</td>
      <td>8c7f86626</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id_001626bd3</td>
      <td>7cbed3131</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="n">train_features</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">train_targets_scored</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;sig_id&#39;</span><span class="p">)</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">train_targets_nonscored</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;sig_id&#39;</span><span class="p">)</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">train_drug</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;sig_id&#39;</span><span class="p">)</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;cp_type&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;ctl_vehicle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">test_features</span><span class="p">[</span><span class="n">test_features</span><span class="p">[</span><span class="s1">&#39;cp_type&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;ctl_vehicle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;cp_type&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;cp_type&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we get the final recombined data as follows, which is supposed to be a good conversion on this mixedseq data set.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[25]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sig_id</th>
      <th>cp_time</th>
      <th>cp_dose</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>...</th>
      <th>vesicular_monoamine_transporter_inhibitor</th>
      <th>vitamin_k_antagonist</th>
      <th>voltage-gated_calcium_channel_ligand</th>
      <th>voltage-gated_potassium_channel_activator</th>
      <th>voltage-gated_sodium_channel_blocker</th>
      <th>wdr5_mll_interaction_inhibitor</th>
      <th>wnt_agonist</th>
      <th>xanthine_oxidase_inhibitor</th>
      <th>xiap_inhibitor</th>
      <th>drug_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id_000644bb2</td>
      <td>24</td>
      <td>D1</td>
      <td>1.146806</td>
      <td>0.902075</td>
      <td>-0.418339</td>
      <td>-0.961202</td>
      <td>-0.254770</td>
      <td>-1.021300</td>
      <td>-1.369236</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>b68db1d53</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id_000779bfc</td>
      <td>72</td>
      <td>D1</td>
      <td>0.128824</td>
      <td>0.676862</td>
      <td>0.274345</td>
      <td>0.090495</td>
      <td>1.208863</td>
      <td>0.688965</td>
      <td>0.316734</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>df89a8e5a</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id_000a6266a</td>
      <td>48</td>
      <td>D1</td>
      <td>0.790372</td>
      <td>0.939951</td>
      <td>1.428097</td>
      <td>-0.121817</td>
      <td>-0.002067</td>
      <td>1.495091</td>
      <td>0.238763</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>18bb41b2c</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id_0015fd391</td>
      <td>48</td>
      <td>D1</td>
      <td>-0.729866</td>
      <td>-0.277163</td>
      <td>-0.441200</td>
      <td>0.766612</td>
      <td>2.347817</td>
      <td>-0.862761</td>
      <td>-2.308829</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8c7f86626</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id_001626bd3</td>
      <td>72</td>
      <td>D2</td>
      <td>-0.444558</td>
      <td>-0.481202</td>
      <td>0.974729</td>
      <td>0.977467</td>
      <td>1.468304</td>
      <td>-0.874772</td>
      <td>-0.372682</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7cbed3131</td>
    </tr>
  </tbody>
</table>
<p>5 rows  1847 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">target_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">train_targets_scored</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="s1">&#39;sig_id&#39;</span><span class="p">]</span>
<span class="n">aux_target_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">train_targets_nonscored</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="s1">&#39;sig_id&#39;</span><span class="p">]</span>
<span class="n">all_target_cols</span> <span class="o">=</span> <span class="n">target_cols</span> <span class="o">+</span> <span class="n">aux_target_cols</span>

<span class="n">num_targets</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_cols</span><span class="p">)</span>
<span class="n">num_aux_targets</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">aux_target_cols</span><span class="p">)</span>
<span class="n">num_all_targets</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_target_cols</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;num_targets: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_targets</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;num_aux_targets: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_aux_targets</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;num_all_targets: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_all_targets</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>num_targets: 206
num_aux_targets: 402
num_all_targets: 608
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sample_submission</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(21948, 1847)
(3624, 1238)
(3982, 207)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now I will build my NN model based on this recombined dataset and make evaluation on the test set to see if the result improved. First I set up dataset classes for better visualization later.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Dataset-Classes">Dataset Classes<a class="anchor-link" href="#Dataset-Classes">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">MoADataset</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="n">features</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">targets</span> <span class="o">=</span> <span class="n">targets</span>
        
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="n">dct</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;x&#39;</span> <span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">),</span>
            <span class="s1">&#39;y&#39;</span> <span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">targets</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">dct</span>
    
<span class="k">class</span> <span class="nc">TestDataset</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="n">features</span>
        
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="n">dct</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;x&#39;</span> <span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">dct</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now I set up the training and validation and inference function.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">train_fn</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">scheduler</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">dataloader</span><span class="p">,</span> <span class="n">device</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    <span class="n">final_loss</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        <span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="n">final_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        
    <span class="n">final_loss</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">final_loss</span>

<span class="k">def</span> <span class="nf">valid_fn</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">dataloader</span><span class="p">,</span> <span class="n">device</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">final_loss</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">valid_preds</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
        <span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>

        <span class="n">final_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="n">valid_preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">outputs</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
        
    <span class="n">final_loss</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span>
    <span class="n">valid_preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">valid_preds</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">final_loss</span><span class="p">,</span> <span class="n">valid_preds</span>

<span class="k">def</span> <span class="nf">inference_fn</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataloader</span><span class="p">,</span> <span class="n">device</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
        
        <span class="n">preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">outputs</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
        
    <span class="n">preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">preds</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch.nn.modules.loss</span> <span class="k">import</span> <span class="n">_WeightedLoss</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>

<span class="k">class</span> <span class="nc">SmoothBCEwLogits</span><span class="p">(</span><span class="n">_WeightedLoss</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="n">reduction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smoothing</span> <span class="o">=</span> <span class="n">smoothing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">weight</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reduction</span> <span class="o">=</span> <span class="n">reduction</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_smooth</span><span class="p">(</span><span class="n">targets</span><span class="p">:</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">n_labels</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">smoothing</span> <span class="o">&lt;</span> <span class="mi">1</span>

        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
            <span class="n">targets</span> <span class="o">=</span> <span class="n">targets</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">smoothing</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">smoothing</span>
            
        <span class="k">return</span> <span class="n">targets</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
        <span class="n">targets</span> <span class="o">=</span> <span class="n">SmoothBCEwLogits</span><span class="o">.</span><span class="n">_smooth</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">inputs</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">smoothing</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">binary_cross_entropy_with_logits</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>

        <span class="k">if</span>  <span class="bp">self</span><span class="o">.</span><span class="n">reduction</span> <span class="o">==</span> <span class="s1">&#39;sum&#39;</span><span class="p">:</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">loss</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">elif</span>  <span class="bp">self</span><span class="o">.</span><span class="n">reduction</span> <span class="o">==</span> <span class="s1">&#39;mean&#39;</span><span class="p">:</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">loss</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Model-building">Model building<a class="anchor-link" href="#Model-building">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here I rewrite finetune function from the original notebook. In each iteration, the design idea is first, freeze all weights of the input, then save frozen layer names. After each epoch checking, replace the top layers with another ones and unfreeze parameters of the last frozen layer. By the end of training remove the last layer as unfrozen.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_features</span><span class="p">,</span> <span class="n">num_targets</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1500</span><span class="p">,</span> <span class="mi">1250</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">750</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout_value</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">batch_norm1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">(</span><span class="n">num_features</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_features</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_norm2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout_value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">batch_norm3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout_value</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dense3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">batch_norm4</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout4</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout_value</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dense4</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">batch_norm5</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout5</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout_value</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dense5</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">weight_norm</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">num_targets</span><span class="p">))</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_norm1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">leaky_relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dense1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_norm2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">leaky_relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dense2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_norm3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">leaky_relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dense3</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_norm4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">leaky_relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dense4</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_norm5</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout5</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense5</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
    
<span class="k">class</span> <span class="nc">LabelSmoothingLoss</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">LabelSmoothingLoss</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">smoothing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smoothing</span> <span class="o">=</span> <span class="n">smoothing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cls</span> <span class="o">=</span> <span class="n">classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dim</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
        <span class="n">pred</span> <span class="o">=</span> <span class="n">pred</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
            <span class="n">true_dist</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
            <span class="n">true_dist</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smoothing</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cls</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">true_dist</span><span class="o">.</span><span class="n">scatter_</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">target</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">confidence</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="n">true_dist</span> <span class="o">*</span> <span class="n">pred</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">FineTuneScheduler</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">epochs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span> <span class="o">=</span> <span class="n">epochs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epochs_per_step</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frozen_layers</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">copy_without_top</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">num_features</span><span class="p">,</span> <span class="n">num_targets</span><span class="p">,</span> <span class="n">num_targets_new</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frozen_layers</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">model_new</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">num_features</span><span class="p">,</span> <span class="n">num_targets</span><span class="p">)</span>
        <span class="n">model_new</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">model_new</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">():</span>
            <span class="n">layer_index</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">layer_index</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="n">layer_index</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frozen_layers</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">frozen_layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer_index</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">epochs_per_step</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span> <span class="o">//</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frozen_layers</span><span class="p">)</span>

        <span class="n">model_new</span><span class="o">.</span><span class="n">batch_norm5</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">(</span><span class="n">model_new</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">model_new</span><span class="o">.</span><span class="n">dropout5</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">model_new</span><span class="o">.</span><span class="n">dropout_value</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">model_new</span><span class="o">.</span><span class="n">dense5</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">weight_norm</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">model_new</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">num_targets_new</span><span class="p">))</span>
        <span class="n">model_new</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">model_new</span>

    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frozen_layers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">epoch</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">epochs_per_step</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">last_frozen_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frozen_layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">():</span>
                <span class="n">layer_index</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">layer_index</span> <span class="o">==</span> <span class="n">last_frozen_index</span><span class="p">:</span>
                    <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">frozen_layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Preprocessing-steps">Preprocessing steps<a class="anchor-link" href="#Preprocessing-steps">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_data</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cp_time&#39;</span><span class="p">,</span><span class="s1">&#39;cp_dose&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">feature_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">process_data</span><span class="p">(</span><span class="n">train</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_target_cols</span><span class="p">]</span>
<span class="n">feature_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">feature_cols</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;kfold&#39;</span><span class="p">,</span> <span class="s1">&#39;sig_id&#39;</span><span class="p">,</span> <span class="s1">&#39;drug_id&#39;</span><span class="p">]]</span>
<span class="n">num_features</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_cols</span><span class="p">)</span>
<span class="n">num_features</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[34]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1240</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I set a grid of hyperperameters and the moddel architecture is shown below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">DEVICE</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;cuda&#39;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
<span class="n">EPOCHS</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">BATCH_SIZE</span> <span class="o">=</span> <span class="mi">128</span>

<span class="n">WEIGHT_DECAY</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ALL_TARGETS&#39;</span><span class="p">:</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="s1">&#39;SCORED_ONLY&#39;</span><span class="p">:</span> <span class="mf">3e-6</span><span class="p">}</span>
<span class="n">MAX_LR</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ALL_TARGETS&#39;</span><span class="p">:</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="s1">&#39;SCORED_ONLY&#39;</span><span class="p">:</span> <span class="mf">3e-3</span><span class="p">}</span>
<span class="n">DIV_FACTOR</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ALL_TARGETS&#39;</span><span class="p">:</span> <span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;SCORED_ONLY&#39;</span><span class="p">:</span> <span class="mf">1e2</span><span class="p">}</span>
<span class="n">PCT_START</span> <span class="o">=</span> <span class="mf">0.1</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">num_features</span><span class="p">,</span> <span class="n">num_all_targets</span><span class="p">)</span>
<span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[36]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Model(
  (batch_norm1): BatchNorm1d(1240, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (dense1): Linear(in_features=1240, out_features=1500, bias=True)
  (batch_norm2): BatchNorm1d(1500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (dropout2): Dropout(p=0.5, inplace=False)
  (dense2): Linear(in_features=1500, out_features=1250, bias=True)
  (batch_norm3): BatchNorm1d(1250, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (dropout3): Dropout(p=0.35, inplace=False)
  (dense3): Linear(in_features=1250, out_features=1000, bias=True)
  (batch_norm4): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (dropout4): Dropout(p=0.3, inplace=False)
  (dense4): Linear(in_features=1000, out_features=750, bias=True)
  (batch_norm5): BatchNorm1d(750, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (dropout5): Dropout(p=0.25, inplace=False)
  (dense5): Linear(in_features=750, out_features=608, bias=True)
)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Single-fold-training">Single fold training<a class="anchor-link" href="#Single-fold-training">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now I my single fold training. I treat it as two different cases: stratify drugs 18x or less and stratify frugs more than 18x. Then I assign folds to each stratification.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">KFold</span>

<span class="k">def</span> <span class="nf">make_cv_folds</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">SEEDS</span><span class="p">,</span> <span class="n">NFOLDS</span><span class="p">,</span> <span class="n">DRUG_THRESH</span><span class="p">):</span>
    <span class="n">vc</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">drug_id</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">vc1</span> <span class="o">=</span> <span class="n">vc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">vc</span> <span class="o">&lt;=</span> <span class="n">DRUG_THRESH</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
    <span class="n">vc2</span> <span class="o">=</span> <span class="n">vc</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">vc</span> <span class="o">&gt;</span> <span class="n">DRUG_THRESH</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">seed_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">SEEDS</span><span class="p">):</span>
        <span class="n">kfold_col</span> <span class="o">=</span> <span class="s1">&#39;kfold_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">seed_id</span><span class="p">)</span>

        <span class="n">dct1</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">dct2</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">skf</span> <span class="o">=</span> <span class="n">MultilabelStratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">NFOLDS</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed_id</span><span class="p">)</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;drug_id&#39;</span><span class="p">)[</span><span class="n">target_cols</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">vc1</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">fold</span><span class="p">,(</span><span class="n">idxT</span><span class="p">,</span> <span class="n">idxV</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">skf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">tmp</span><span class="p">[</span><span class="n">target_cols</span><span class="p">])):</span>
            <span class="n">dd</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">fold</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tmp</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">idxV</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">}</span>
            <span class="n">dct1</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>

        <span class="n">skf</span> <span class="o">=</span> <span class="n">MultilabelStratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">NFOLDS</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed_id</span><span class="p">)</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train</span><span class="o">.</span><span class="n">drug_id</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">vc2</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">fold</span><span class="p">,(</span><span class="n">idxT</span><span class="p">,</span> <span class="n">idxV</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">skf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">tmp</span><span class="p">[</span><span class="n">target_cols</span><span class="p">])):</span>
            <span class="n">dd</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">fold</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tmp</span><span class="o">.</span><span class="n">sig_id</span><span class="p">[</span><span class="n">idxV</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">}</span>
            <span class="n">dct2</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>

        <span class="n">train</span><span class="p">[</span><span class="n">kfold_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">drug_id</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">dct1</span><span class="p">)</span>
        <span class="n">train</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="n">kfold_col</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="n">kfold_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="n">kfold_col</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="s1">&#39;sig_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">dct2</span><span class="p">)</span>
        <span class="n">train</span><span class="p">[</span><span class="n">kfold_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">kfold_col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int8&#39;</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">train</span>

<span class="n">SEEDS</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">NFOLDS</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">DRUG_THRESH</span> <span class="o">=</span> <span class="mi">18</span>

<span class="n">train</span> <span class="o">=</span> <span class="n">make_cv_folds</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">SEEDS</span><span class="p">,</span> <span class="n">NFOLDS</span><span class="p">,</span> <span class="n">DRUG_THRESH</span><span class="p">)</span>
<span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[37]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sig_id</th>
      <th>cp_time</th>
      <th>cp_dose</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>...</th>
      <th>xanthine_oxidase_inhibitor</th>
      <th>xiap_inhibitor</th>
      <th>drug_id</th>
      <th>kfold_0</th>
      <th>kfold_1</th>
      <th>kfold_2</th>
      <th>kfold_3</th>
      <th>kfold_4</th>
      <th>kfold_5</th>
      <th>kfold_6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id_000644bb2</td>
      <td>24</td>
      <td>D1</td>
      <td>1.146806</td>
      <td>0.902075</td>
      <td>-0.418339</td>
      <td>-0.961202</td>
      <td>-0.254770</td>
      <td>-1.021300</td>
      <td>-1.369236</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>b68db1d53</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>5</td>
      <td>0</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id_000779bfc</td>
      <td>72</td>
      <td>D1</td>
      <td>0.128824</td>
      <td>0.676862</td>
      <td>0.274345</td>
      <td>0.090495</td>
      <td>1.208863</td>
      <td>0.688965</td>
      <td>0.316734</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>df89a8e5a</td>
      <td>0</td>
      <td>3</td>
      <td>6</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id_000a6266a</td>
      <td>48</td>
      <td>D1</td>
      <td>0.790372</td>
      <td>0.939951</td>
      <td>1.428097</td>
      <td>-0.121817</td>
      <td>-0.002067</td>
      <td>1.495091</td>
      <td>0.238763</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>18bb41b2c</td>
      <td>5</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id_0015fd391</td>
      <td>48</td>
      <td>D1</td>
      <td>-0.729866</td>
      <td>-0.277163</td>
      <td>-0.441200</td>
      <td>0.766612</td>
      <td>2.347817</td>
      <td>-0.862761</td>
      <td>-2.308829</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>8c7f86626</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id_001626bd3</td>
      <td>72</td>
      <td>D2</td>
      <td>-0.444558</td>
      <td>-0.481202</td>
      <td>0.974729</td>
      <td>0.977467</td>
      <td>1.468304</td>
      <td>-0.874772</td>
      <td>-0.372682</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>7cbed3131</td>
      <td>6</td>
      <td>5</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>5 rows  1854 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now I run the training precess and after tuning, did the following things:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><p>Train on scored + nonscored targets</p>
</li>
<li><p>Load the pretrained model with the best loss</p>
</li>
<li><p>Copy model without the top layer</p>
</li>
<li><p>Fine-tune the model on scored targets only</p>
</li>
<li><p>Load the fine-tuned model with the best loss</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">run_training</span><span class="p">(</span><span class="n">fold_id</span><span class="p">,</span> <span class="n">seed_id</span><span class="p">):</span>
    <span class="n">seed_everything</span><span class="p">(</span><span class="n">seed_id</span><span class="p">)</span>
    
    <span class="n">train_</span> <span class="o">=</span> <span class="n">process_data</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
    <span class="n">test_</span> <span class="o">=</span> <span class="n">process_data</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
    
    <span class="n">kfold_col</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;kfold_</span><span class="si">{seed_id}</span><span class="s1">&#39;</span>
    <span class="n">trn_idx</span> <span class="o">=</span> <span class="n">train_</span><span class="p">[</span><span class="n">train_</span><span class="p">[</span><span class="n">kfold_col</span><span class="p">]</span> <span class="o">!=</span> <span class="n">fold_id</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
    <span class="n">val_idx</span> <span class="o">=</span> <span class="n">train_</span><span class="p">[</span><span class="n">train_</span><span class="p">[</span><span class="n">kfold_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">fold_id</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
    
    <span class="n">train_df</span> <span class="o">=</span> <span class="n">train_</span><span class="p">[</span><span class="n">train_</span><span class="p">[</span><span class="n">kfold_col</span><span class="p">]</span> <span class="o">!=</span> <span class="n">fold_id</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">valid_df</span> <span class="o">=</span> <span class="n">train_</span><span class="p">[</span><span class="n">train_</span><span class="p">[</span><span class="n">kfold_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">fold_id</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">train_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">,</span> <span class="n">target_cols_now</span><span class="p">,</span> <span class="n">fine_tune_scheduler</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span>  <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">train_df</span><span class="p">[</span><span class="n">target_cols_now</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">x_valid</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span>  <span class="n">valid_df</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">valid_df</span><span class="p">[</span><span class="n">target_cols_now</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        
        <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">MoADataset</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">valid_dataset</span> <span class="o">=</span> <span class="n">MoADataset</span><span class="p">(</span><span class="n">x_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">)</span>

        <span class="n">trainloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">validloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">valid_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">weight_decay</span><span class="o">=</span><span class="n">WEIGHT_DECAY</span><span class="p">[</span><span class="n">tag_name</span><span class="p">])</span>
        <span class="n">scheduler</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">OneCycleLR</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
                                                  <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">trainloader</span><span class="p">),</span>
                                                  <span class="n">pct_start</span><span class="o">=</span><span class="n">PCT_START</span><span class="p">,</span>
                                                  <span class="n">div_factor</span><span class="o">=</span><span class="n">DIV_FACTOR</span><span class="p">[</span><span class="n">tag_name</span><span class="p">],</span> 
                                                  <span class="n">max_lr</span><span class="o">=</span><span class="n">MAX_LR</span><span class="p">[</span><span class="n">tag_name</span><span class="p">],</span>
                                                  <span class="n">epochs</span><span class="o">=</span><span class="n">EPOCHS</span><span class="p">)</span>
        
        <span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BCEWithLogitsLoss</span><span class="p">()</span>
        <span class="n">loss_tr</span> <span class="o">=</span> <span class="n">SmoothBCEwLogits</span><span class="p">(</span><span class="n">smoothing</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>

        <span class="n">oof</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_cols_now</span><span class="p">)))</span>
        <span class="n">best_loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        
        <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">EPOCHS</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">fine_tune_scheduler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fine_tune_scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>

            <span class="n">train_loss</span> <span class="o">=</span> <span class="n">train_fn</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">scheduler</span><span class="p">,</span> <span class="n">loss_tr</span><span class="p">,</span> <span class="n">trainloader</span><span class="p">,</span> <span class="n">DEVICE</span><span class="p">)</span>
            <span class="n">valid_loss</span><span class="p">,</span> <span class="n">valid_preds</span> <span class="o">=</span> <span class="n">valid_fn</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">validloader</span><span class="p">,</span> <span class="n">DEVICE</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;SEED: </span><span class="si">{seed_id}</span><span class="s2">, FOLD: </span><span class="si">{fold_id}</span><span class="s2">, </span><span class="si">{tag_name}</span><span class="s2">, EPOCH: </span><span class="si">{epoch}</span><span class="s2">, train_loss: </span><span class="si">{train_loss:.6f}</span><span class="s2">, valid_loss: </span><span class="si">{valid_loss:.6f}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">valid_loss</span><span class="p">):</span>
                <span class="k">break</span>
            
            <span class="k">if</span> <span class="n">valid_loss</span> <span class="o">&lt;</span> <span class="n">best_loss</span><span class="p">:</span>
                <span class="n">best_loss</span> <span class="o">=</span> <span class="n">valid_loss</span>
                <span class="n">oof</span><span class="p">[</span><span class="n">val_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">valid_preds</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">f</span><span class="s2">&quot;</span><span class="si">{tag_name}</span><span class="s2">_FOLD</span><span class="si">{fold_id}</span><span class="s2">_.pth&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">oof</span>

    <span class="n">fine_tune_scheduler</span> <span class="o">=</span> <span class="n">FineTuneScheduler</span><span class="p">(</span><span class="n">EPOCHS</span><span class="p">)</span>

    <span class="n">pretrained_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">num_features</span><span class="p">,</span> <span class="n">num_all_targets</span><span class="p">)</span>
    <span class="n">pretrained_model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>

    <span class="n">train_model</span><span class="p">(</span><span class="n">pretrained_model</span><span class="p">,</span> <span class="s1">&#39;ALL_TARGETS&#39;</span><span class="p">,</span> <span class="n">all_target_cols</span><span class="p">)</span>

    <span class="n">pretrained_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">num_features</span><span class="p">,</span> <span class="n">num_all_targets</span><span class="p">)</span>
    <span class="n">pretrained_model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;ALL_TARGETS_FOLD</span><span class="si">{fold_id}</span><span class="s2">_.pth&quot;</span><span class="p">))</span>
    <span class="n">pretrained_model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>

    <span class="n">final_model</span> <span class="o">=</span> <span class="n">fine_tune_scheduler</span><span class="o">.</span><span class="n">copy_without_top</span><span class="p">(</span><span class="n">pretrained_model</span><span class="p">,</span> <span class="n">num_features</span><span class="p">,</span> <span class="n">num_all_targets</span><span class="p">,</span> <span class="n">num_targets</span><span class="p">)</span>

    <span class="n">oof</span> <span class="o">=</span> <span class="n">train_model</span><span class="p">(</span><span class="n">final_model</span><span class="p">,</span> <span class="s1">&#39;SCORED_ONLY&#39;</span><span class="p">,</span> <span class="n">target_cols</span><span class="p">,</span> <span class="n">fine_tune_scheduler</span><span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">num_features</span><span class="p">,</span> <span class="n">num_targets</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;SCORED_ONLY_FOLD</span><span class="si">{fold_id}</span><span class="s2">_.pth&quot;</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>

    <span class="c1">#--------------------- PREDICTION---------------------</span>
    <span class="n">x_test</span> <span class="o">=</span> <span class="n">test_</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">testdataset</span> <span class="o">=</span> <span class="n">TestDataset</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
    <span class="n">testloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">testdataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">test_</span><span class="p">),</span> <span class="n">num_targets</span><span class="p">))</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">inference_fn</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">testloader</span><span class="p">,</span> <span class="n">DEVICE</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">oof</span><span class="p">,</span> <span class="n">predictions</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">run_k_fold</span><span class="p">(</span><span class="n">NFOLDS</span><span class="p">,</span> <span class="n">seed_id</span><span class="p">):</span>
    <span class="n">oof</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_cols</span><span class="p">)))</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_cols</span><span class="p">)))</span>
    
    <span class="k">for</span> <span class="n">fold_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NFOLDS</span><span class="p">):</span>
        <span class="n">oof_</span><span class="p">,</span> <span class="n">pred_</span> <span class="o">=</span> <span class="n">run_training</span><span class="p">(</span><span class="n">fold_id</span><span class="p">,</span> <span class="n">seed_id</span><span class="p">)</span>
        <span class="n">predictions</span> <span class="o">+=</span> <span class="n">pred_</span> <span class="o">/</span> <span class="n">NFOLDS</span>
        <span class="n">oof</span> <span class="o">+=</span> <span class="n">oof_</span>
        
    <span class="k">return</span> <span class="n">oof</span><span class="p">,</span> <span class="n">predictions</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is how I try to improve the result: take average on multiple seeds.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">time</span> <span class="k">import</span> <span class="n">time</span>

<span class="c1"># Averaging on multiple SEEDS</span>
<span class="n">SEED</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">oof</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_cols</span><span class="p">)))</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_cols</span><span class="p">)))</span>

<span class="n">time_begin</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

<span class="k">for</span> <span class="n">seed_id</span> <span class="ow">in</span> <span class="n">SEED</span><span class="p">:</span>
    <span class="n">oof_</span><span class="p">,</span> <span class="n">predictions_</span> <span class="o">=</span> <span class="n">run_k_fold</span><span class="p">(</span><span class="n">NFOLDS</span><span class="p">,</span> <span class="n">seed_id</span><span class="p">)</span>
    <span class="n">oof</span> <span class="o">+=</span> <span class="n">oof_</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">SEED</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">+=</span> <span class="n">predictions_</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">SEED</span><span class="p">)</span>

<span class="n">time_diff</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">time_begin</span>

<span class="n">train</span><span class="p">[</span><span class="n">target_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">oof</span>
<span class="n">test</span><span class="p">[</span><span class="n">target_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictions</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 0, train_loss: 0.493747, valid_loss: 0.020452
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 1, train_loss: 0.015521, valid_loss: 0.010895
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 2, train_loss: 0.013472, valid_loss: 0.009177
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 3, train_loss: 0.013070, valid_loss: 0.009136
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 4, train_loss: 0.012973, valid_loss: 0.008960
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 5, train_loss: 0.013472, valid_loss: 0.009183
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 6, train_loss: 0.012950, valid_loss: 0.009123
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 7, train_loss: 0.012894, valid_loss: 0.009163
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 8, train_loss: 0.012909, valid_loss: 0.009050
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 9, train_loss: 0.012871, valid_loss: 0.009271
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 10, train_loss: 0.012888, valid_loss: 0.009085
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 11, train_loss: 0.012845, valid_loss: 0.009082
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 12, train_loss: 0.012823, valid_loss: 0.008951
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 13, train_loss: 0.012785, valid_loss: 0.008946
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 14, train_loss: 0.012768, valid_loss: 0.008960
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 15, train_loss: 0.012698, valid_loss: 0.008939
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 16, train_loss: 0.012657, valid_loss: 0.008873
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 17, train_loss: 0.012585, valid_loss: 0.008778
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 18, train_loss: 0.012519, valid_loss: 0.008820
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 19, train_loss: 0.012409, valid_loss: 0.008694
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 20, train_loss: 0.012301, valid_loss: 0.008699
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 21, train_loss: 0.012175, valid_loss: 0.008648
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 22, train_loss: 0.012074, valid_loss: 0.008632
SEED: 0, FOLD: 0, ALL_TARGETS, EPOCH: 23, train_loss: 0.012016, valid_loss: 0.008624
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 0, train_loss: 0.638970, valid_loss: 0.254233
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 1, train_loss: 0.057979, valid_loss: 0.019270
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 2, train_loss: 0.021024, valid_loss: 0.016887
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 3, train_loss: 0.019998, valid_loss: 0.016633
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 4, train_loss: 0.021762, valid_loss: 0.016442
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 5, train_loss: 0.019837, valid_loss: 0.016361
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 6, train_loss: 0.019640, valid_loss: 0.016420
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 7, train_loss: 0.019513, valid_loss: 0.016448
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 8, train_loss: 0.019794, valid_loss: 0.016445
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 9, train_loss: 0.019538, valid_loss: 0.016413
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 10, train_loss: 0.019420, valid_loss: 0.016401
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 11, train_loss: 0.019370, valid_loss: 0.016578
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 12, train_loss: 0.019582, valid_loss: 0.016400
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 13, train_loss: 0.019304, valid_loss: 0.016434
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 14, train_loss: 0.019084, valid_loss: 0.016312
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 15, train_loss: 0.019005, valid_loss: 0.016270
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 16, train_loss: 0.019290, valid_loss: 0.016396
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 17, train_loss: 0.018898, valid_loss: 0.016312
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 18, train_loss: 0.018497, valid_loss: 0.016279
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 19, train_loss: 0.018145, valid_loss: 0.016311
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 20, train_loss: 0.017866, valid_loss: 0.016332
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 21, train_loss: 0.017568, valid_loss: 0.016332
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 22, train_loss: 0.017389, valid_loss: 0.016347
SEED: 0, FOLD: 0, SCORED_ONLY, EPOCH: 23, train_loss: 0.017301, valid_loss: 0.016378
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 0, train_loss: 0.497580, valid_loss: 0.020633
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 1, train_loss: 0.015573, valid_loss: 0.010406
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 2, train_loss: 0.013256, valid_loss: 0.009859
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 3, train_loss: 0.012957, valid_loss: 0.010771
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 4, train_loss: 0.012893, valid_loss: 0.009786
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 5, train_loss: 0.012817, valid_loss: 0.009817
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 6, train_loss: 0.012820, valid_loss: 0.009776
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 7, train_loss: 0.012833, valid_loss: 0.009748
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 8, train_loss: 0.012799, valid_loss: 0.009679
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 9, train_loss: 0.012788, valid_loss: 0.009726
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 10, train_loss: 0.012789, valid_loss: 0.009728
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 11, train_loss: 0.012731, valid_loss: 0.009641
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 12, train_loss: 0.012770, valid_loss: 0.009585
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 13, train_loss: 0.012704, valid_loss: 0.009693
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 14, train_loss: 0.012670, valid_loss: 0.009671
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 15, train_loss: 0.012625, valid_loss: 0.009589
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 16, train_loss: 0.012550, valid_loss: 0.009479
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 17, train_loss: 0.012519, valid_loss: 0.009471
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 18, train_loss: 0.012420, valid_loss: 0.009406
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 19, train_loss: 0.012322, valid_loss: 0.009329
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 20, train_loss: 0.012232, valid_loss: 0.009248
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 21, train_loss: 0.012112, valid_loss: 0.009198
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 22, train_loss: 0.012018, valid_loss: 0.009199
SEED: 0, FOLD: 1, ALL_TARGETS, EPOCH: 23, train_loss: 0.011964, valid_loss: 0.009200
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 0, train_loss: 0.640828, valid_loss: 0.265017
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 1, train_loss: 0.058917, valid_loss: 0.019938
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 2, train_loss: 0.021154, valid_loss: 0.017512
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 3, train_loss: 0.020109, valid_loss: 0.017244
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 4, train_loss: 0.022750, valid_loss: 0.016991
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 5, train_loss: 0.019837, valid_loss: 0.016900
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 6, train_loss: 0.019748, valid_loss: 0.016876
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 7, train_loss: 0.019582, valid_loss: 0.016892
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 8, train_loss: 0.019843, valid_loss: 0.017025
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 9, train_loss: 0.019609, valid_loss: 0.016978
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 10, train_loss: 0.019499, valid_loss: 0.016943
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 11, train_loss: 0.019422, valid_loss: 0.016815
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 12, train_loss: 0.019672, valid_loss: 0.016887
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 13, train_loss: 0.019421, valid_loss: 0.016826
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 14, train_loss: 0.019231, valid_loss: 0.016725
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 15, train_loss: 0.019146, valid_loss: 0.016827
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 16, train_loss: 0.019348, valid_loss: 0.016853
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 17, train_loss: 0.018927, valid_loss: 0.016798
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 18, train_loss: 0.018604, valid_loss: 0.016786
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 19, train_loss: 0.018237, valid_loss: 0.016762
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 20, train_loss: 0.017924, valid_loss: 0.016831
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 21, train_loss: 0.017635, valid_loss: 0.016821
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 22, train_loss: 0.017470, valid_loss: 0.016849
SEED: 0, FOLD: 1, SCORED_ONLY, EPOCH: 23, train_loss: 0.017368, valid_loss: 0.016846
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 0, train_loss: 0.496697, valid_loss: 0.024107
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 1, train_loss: 0.015370, valid_loss: 0.010722
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 2, train_loss: 0.013307, valid_loss: 0.009972
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 3, train_loss: 0.013034, valid_loss: 0.009699
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 4, train_loss: 0.012786, valid_loss: 0.009773
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 5, train_loss: 0.012933, valid_loss: 0.009611
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 6, train_loss: 0.012828, valid_loss: 0.009795
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 7, train_loss: 0.012853, valid_loss: 0.009908
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 8, train_loss: 0.012806, valid_loss: 0.009834
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 9, train_loss: 0.012814, valid_loss: 0.009725
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 10, train_loss: 0.012785, valid_loss: 0.009917
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 11, train_loss: 0.012764, valid_loss: 0.009667
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 12, train_loss: 0.012757, valid_loss: 0.009908
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 13, train_loss: 0.012705, valid_loss: 0.009684
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 14, train_loss: 0.012669, valid_loss: 0.009565
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 15, train_loss: 0.012634, valid_loss: 0.009560
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 16, train_loss: 0.012579, valid_loss: 0.009570
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 17, train_loss: 0.012510, valid_loss: 0.009638
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 18, train_loss: 0.012425, valid_loss: 0.009453
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 19, train_loss: 0.012338, valid_loss: 0.009365
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 20, train_loss: 0.012208, valid_loss: 0.009408
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 21, train_loss: 0.012113, valid_loss: 0.009251
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 22, train_loss: 0.012021, valid_loss: 0.009266
SEED: 0, FOLD: 2, ALL_TARGETS, EPOCH: 23, train_loss: 0.011952, valid_loss: 0.009271
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 0, train_loss: 0.641084, valid_loss: 0.267178
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 1, train_loss: 0.058918, valid_loss: 0.020181
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 2, train_loss: 0.021030, valid_loss: 0.018045
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 3, train_loss: 0.020020, valid_loss: 0.017674
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 4, train_loss: 0.021926, valid_loss: 0.017728
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 5, train_loss: 0.019916, valid_loss: 0.017634
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 6, train_loss: 0.019728, valid_loss: 0.017662
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 7, train_loss: 0.019593, valid_loss: 0.017632
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 8, train_loss: 0.019791, valid_loss: 0.017676
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 9, train_loss: 0.019508, valid_loss: 0.017594
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 10, train_loss: 0.019436, valid_loss: 0.017675
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 11, train_loss: 0.019387, valid_loss: 0.017553
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 12, train_loss: 0.019573, valid_loss: 0.017598
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 13, train_loss: 0.019400, valid_loss: 0.017464
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 14, train_loss: 0.019177, valid_loss: 0.017508
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 15, train_loss: 0.019035, valid_loss: 0.017542
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 16, train_loss: 0.019240, valid_loss: 0.017445
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 17, train_loss: 0.018856, valid_loss: 0.017331
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 18, train_loss: 0.018476, valid_loss: 0.017525
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 19, train_loss: 0.018179, valid_loss: 0.017481
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 20, train_loss: 0.017886, valid_loss: 0.017499
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 21, train_loss: 0.017628, valid_loss: 0.017441
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 22, train_loss: 0.017498, valid_loss: 0.017510
SEED: 0, FOLD: 2, SCORED_ONLY, EPOCH: 23, train_loss: 0.017395, valid_loss: 0.017513
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 0, train_loss: 0.496673, valid_loss: 0.022756
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 1, train_loss: 0.015814, valid_loss: 0.010658
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 2, train_loss: 0.013289, valid_loss: 0.010117
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 3, train_loss: 0.012910, valid_loss: 0.009933
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 4, train_loss: 0.013056, valid_loss: 0.009918
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 5, train_loss: 0.012782, valid_loss: 0.010451
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 6, train_loss: 0.012779, valid_loss: 0.009869
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 7, train_loss: 0.012789, valid_loss: 0.009857
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 8, train_loss: 0.012741, valid_loss: 0.009870
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 9, train_loss: 0.012750, valid_loss: 0.009874
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 10, train_loss: 0.012721, valid_loss: 0.009823
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 11, train_loss: 0.012713, valid_loss: 0.009877
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 12, train_loss: 0.012708, valid_loss: 0.009769
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 13, train_loss: 0.012671, valid_loss: 0.009779
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 14, train_loss: 0.012628, valid_loss: 0.009785
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 15, train_loss: 0.012590, valid_loss: 0.009647
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 16, train_loss: 0.012540, valid_loss: 0.009652
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 17, train_loss: 0.012453, valid_loss: 0.009578
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 18, train_loss: 0.012366, valid_loss: 0.009542
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 19, train_loss: 0.012273, valid_loss: 0.009490
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 20, train_loss: 0.012150, valid_loss: 0.009410
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 21, train_loss: 0.012036, valid_loss: 0.009408
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 22, train_loss: 0.011946, valid_loss: 0.009386
SEED: 0, FOLD: 3, ALL_TARGETS, EPOCH: 23, train_loss: 0.011884, valid_loss: 0.009378
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 0, train_loss: 0.640006, valid_loss: 0.260172
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 1, train_loss: 0.058416, valid_loss: 0.020873
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 2, train_loss: 0.020774, valid_loss: 0.018619
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 3, train_loss: 0.019739, valid_loss: 0.018292
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 4, train_loss: 0.022675, valid_loss: 0.018082
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 5, train_loss: 0.019510, valid_loss: 0.018187
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 6, train_loss: 0.019290, valid_loss: 0.018027
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 7, train_loss: 0.019171, valid_loss: 0.018192
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 8, train_loss: 0.019636, valid_loss: 0.018237
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 9, train_loss: 0.019217, valid_loss: 0.018575
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 10, train_loss: 0.019112, valid_loss: 0.018208
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 11, train_loss: 0.018991, valid_loss: 0.018194
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 12, train_loss: 0.019315, valid_loss: 0.018162
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 13, train_loss: 0.019003, valid_loss: 0.018119
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 14, train_loss: 0.018855, valid_loss: 0.018225
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 15, train_loss: 0.018725, valid_loss: 0.018109
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 16, train_loss: 0.019098, valid_loss: 0.018046
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 17, train_loss: 0.018651, valid_loss: 0.018032
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 18, train_loss: 0.018275, valid_loss: 0.018029
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 19, train_loss: 0.017927, valid_loss: 0.018039
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 20, train_loss: 0.017586, valid_loss: 0.018015
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 21, train_loss: 0.017307, valid_loss: 0.018046
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 22, train_loss: 0.017127, valid_loss: 0.018052
SEED: 0, FOLD: 3, SCORED_ONLY, EPOCH: 23, train_loss: 0.017064, valid_loss: 0.018073
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 0, train_loss: 0.496609, valid_loss: 0.020198
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 1, train_loss: 0.015507, valid_loss: 0.010143
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 2, train_loss: 0.013728, valid_loss: 0.009747
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 3, train_loss: 0.013164, valid_loss: 0.009488
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 4, train_loss: 0.012814, valid_loss: 0.009608
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 5, train_loss: 0.012832, valid_loss: 0.009451
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 6, train_loss: 0.012847, valid_loss: 0.009418
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 7, train_loss: 0.012819, valid_loss: 0.009288
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 8, train_loss: 0.012823, valid_loss: 0.009721
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 9, train_loss: 0.012825, valid_loss: 0.009364
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 10, train_loss: 0.012798, valid_loss: 0.009331
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 11, train_loss: 0.012782, valid_loss: 0.009340
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 12, train_loss: 0.012780, valid_loss: 0.009295
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 13, train_loss: 0.012737, valid_loss: 0.009470
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 14, train_loss: 0.012723, valid_loss: 0.009285
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 15, train_loss: 0.012663, valid_loss: 0.009263
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 16, train_loss: 0.012598, valid_loss: 0.009258
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 17, train_loss: 0.012550, valid_loss: 0.009151
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 18, train_loss: 0.012449, valid_loss: 0.009102
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 19, train_loss: 0.012365, valid_loss: 0.009022
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 20, train_loss: 0.012257, valid_loss: 0.009005
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 21, train_loss: 0.012144, valid_loss: 0.008949
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 22, train_loss: 0.012046, valid_loss: 0.008914
SEED: 0, FOLD: 4, ALL_TARGETS, EPOCH: 23, train_loss: 0.011995, valid_loss: 0.008914
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 0, train_loss: 0.640844, valid_loss: 0.261886
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 1, train_loss: 0.058899, valid_loss: 0.019739
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 2, train_loss: 0.020924, valid_loss: 0.017520
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 3, train_loss: 0.019901, valid_loss: 0.017212
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 4, train_loss: 0.022486, valid_loss: 0.016969
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 5, train_loss: 0.019778, valid_loss: 0.017007
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 6, train_loss: 0.019578, valid_loss: 0.016974
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 7, train_loss: 0.019482, valid_loss: 0.017058
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 8, train_loss: 0.019692, valid_loss: 0.017081
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 9, train_loss: 0.019471, valid_loss: 0.017182
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 10, train_loss: 0.019352, valid_loss: 0.017045
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 11, train_loss: 0.019249, valid_loss: 0.016961
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 12, train_loss: 0.019493, valid_loss: 0.016937
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 13, train_loss: 0.019278, valid_loss: 0.016939
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 14, train_loss: 0.019077, valid_loss: 0.016927
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 15, train_loss: 0.018917, valid_loss: 0.016917
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 16, train_loss: 0.019284, valid_loss: 0.017035
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 17, train_loss: 0.018865, valid_loss: 0.016960
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 18, train_loss: 0.018454, valid_loss: 0.016931
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 19, train_loss: 0.018110, valid_loss: 0.016923
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 20, train_loss: 0.017801, valid_loss: 0.016931
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 21, train_loss: 0.017508, valid_loss: 0.016917
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 22, train_loss: 0.017333, valid_loss: 0.016977
SEED: 0, FOLD: 4, SCORED_ONLY, EPOCH: 23, train_loss: 0.017281, valid_loss: 0.016985
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 0, train_loss: 0.496140, valid_loss: 0.021012
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 1, train_loss: 0.015557, valid_loss: 0.010284
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 2, train_loss: 0.014081, valid_loss: 0.009679
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 3, train_loss: 0.013111, valid_loss: 0.009737
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 4, train_loss: 0.012807, valid_loss: 0.009698
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 5, train_loss: 0.012819, valid_loss: 0.009735
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 6, train_loss: 0.012827, valid_loss: 0.009761
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 7, train_loss: 0.012818, valid_loss: 0.009975
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 8, train_loss: 0.012790, valid_loss: 0.009582
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 9, train_loss: 0.012804, valid_loss: 0.009596
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 10, train_loss: 0.012795, valid_loss: 0.009573
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 11, train_loss: 0.012778, valid_loss: 0.009597
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 12, train_loss: 0.012730, valid_loss: 0.009691
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 13, train_loss: 0.012732, valid_loss: 0.009513
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 14, train_loss: 0.012674, valid_loss: 0.009535
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 15, train_loss: 0.012663, valid_loss: 0.009410
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 16, train_loss: 0.012574, valid_loss: 0.009651
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 17, train_loss: 0.012515, valid_loss: 0.009346
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 18, train_loss: 0.012411, valid_loss: 0.009285
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 19, train_loss: 0.012336, valid_loss: 0.009303
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 20, train_loss: 0.012235, valid_loss: 0.009215
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 21, train_loss: 0.012117, valid_loss: 0.009146
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 22, train_loss: 0.012018, valid_loss: 0.009157
SEED: 0, FOLD: 5, ALL_TARGETS, EPOCH: 23, train_loss: 0.011965, valid_loss: 0.009157
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 0, train_loss: 0.641155, valid_loss: 0.263686
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 1, train_loss: 0.059098, valid_loss: 0.020312
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 2, train_loss: 0.020990, valid_loss: 0.018179
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 3, train_loss: 0.020010, valid_loss: 0.017821
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 4, train_loss: 0.024045, valid_loss: 0.017700
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 5, train_loss: 0.019779, valid_loss: 0.017702
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 6, train_loss: 0.019615, valid_loss: 0.017713
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 7, train_loss: 0.019504, valid_loss: 0.017657
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 8, train_loss: 0.019670, valid_loss: 0.017740
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 9, train_loss: 0.019471, valid_loss: 0.017630
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 10, train_loss: 0.019398, valid_loss: 0.017657
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 11, train_loss: 0.019275, valid_loss: 0.017672
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 12, train_loss: 0.019513, valid_loss: 0.017698
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 13, train_loss: 0.019256, valid_loss: 0.017579
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 14, train_loss: 0.019040, valid_loss: 0.017684
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 15, train_loss: 0.018942, valid_loss: 0.017517
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 16, train_loss: 0.019238, valid_loss: 0.017703
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 17, train_loss: 0.018809, valid_loss: 0.017654
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 18, train_loss: 0.018401, valid_loss: 0.017636
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 19, train_loss: 0.018107, valid_loss: 0.017697
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 20, train_loss: 0.017802, valid_loss: 0.017622
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 21, train_loss: 0.017518, valid_loss: 0.017670
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 22, train_loss: 0.017323, valid_loss: 0.017690
SEED: 0, FOLD: 5, SCORED_ONLY, EPOCH: 23, train_loss: 0.017271, valid_loss: 0.017689
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 0, train_loss: 0.498250, valid_loss: 0.022634
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 1, train_loss: 0.015385, valid_loss: 0.010620
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 2, train_loss: 0.013664, valid_loss: 0.010054
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 3, train_loss: 0.013371, valid_loss: 0.010315
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 4, train_loss: 0.012902, valid_loss: 0.009887
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 5, train_loss: 0.012715, valid_loss: 0.009772
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 6, train_loss: 0.012737, valid_loss: 0.009759
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 7, train_loss: 0.012767, valid_loss: 0.010041
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 8, train_loss: 0.012790, valid_loss: 0.010011
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 9, train_loss: 0.012748, valid_loss: 0.009904
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 10, train_loss: 0.012771, valid_loss: 0.009795
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 11, train_loss: 0.012761, valid_loss: 0.009787
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 12, train_loss: 0.012740, valid_loss: 0.009755
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 13, train_loss: 0.012705, valid_loss: 0.009755
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 14, train_loss: 0.012669, valid_loss: 0.009627
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 15, train_loss: 0.012620, valid_loss: 0.009605
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 16, train_loss: 0.012557, valid_loss: 0.009595
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 17, train_loss: 0.012492, valid_loss: 0.009517
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 18, train_loss: 0.012408, valid_loss: 0.009532
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 19, train_loss: 0.012323, valid_loss: 0.009515
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 20, train_loss: 0.012214, valid_loss: 0.009385
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 21, train_loss: 0.012113, valid_loss: 0.009352
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 22, train_loss: 0.012017, valid_loss: 0.009316
SEED: 0, FOLD: 6, ALL_TARGETS, EPOCH: 23, train_loss: 0.011965, valid_loss: 0.009299
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 0, train_loss: 0.644604, valid_loss: 0.271441
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 1, train_loss: 0.059752, valid_loss: 0.020556
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 2, train_loss: 0.020919, valid_loss: 0.018296
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 3, train_loss: 0.019977, valid_loss: 0.018030
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 4, train_loss: 0.022276, valid_loss: 0.017825
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 5, train_loss: 0.019796, valid_loss: 0.017693
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 6, train_loss: 0.019582, valid_loss: 0.017791
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 7, train_loss: 0.019483, valid_loss: 0.017749
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 8, train_loss: 0.019705, valid_loss: 0.017873
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 9, train_loss: 0.019448, valid_loss: 0.017710
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 10, train_loss: 0.019415, valid_loss: 0.017636
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 11, train_loss: 0.019329, valid_loss: 0.017699
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 12, train_loss: 0.019529, valid_loss: 0.017567
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 13, train_loss: 0.019238, valid_loss: 0.017645
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 14, train_loss: 0.019079, valid_loss: 0.017607
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 15, train_loss: 0.018927, valid_loss: 0.017583
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 16, train_loss: 0.019270, valid_loss: 0.017651
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 17, train_loss: 0.018860, valid_loss: 0.017599
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 18, train_loss: 0.018461, valid_loss: 0.017553
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 19, train_loss: 0.018169, valid_loss: 0.017529
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 20, train_loss: 0.017899, valid_loss: 0.017512
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 21, train_loss: 0.017644, valid_loss: 0.017537
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 22, train_loss: 0.017417, valid_loss: 0.017562
SEED: 0, FOLD: 6, SCORED_ONLY, EPOCH: 23, train_loss: 0.017368, valid_loss: 0.017573
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 0, train_loss: 0.495071, valid_loss: 0.020948
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 1, train_loss: 0.015795, valid_loss: 0.010902
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 2, train_loss: 0.013775, valid_loss: 0.009966
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 3, train_loss: 0.013061, valid_loss: 0.009895
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 4, train_loss: 0.012845, valid_loss: 0.009836
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 5, train_loss: 0.012806, valid_loss: 0.010220
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 6, train_loss: 0.012779, valid_loss: 0.010517
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 7, train_loss: 0.012777, valid_loss: 0.009875
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 8, train_loss: 0.012781, valid_loss: 0.009841
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 9, train_loss: 0.012747, valid_loss: 0.009958
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 10, train_loss: 0.012747, valid_loss: 0.009955
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 11, train_loss: 0.012727, valid_loss: 0.009975
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 12, train_loss: 0.012716, valid_loss: 0.009787
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 13, train_loss: 0.012696, valid_loss: 0.009819
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 14, train_loss: 0.012655, valid_loss: 0.009728
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 15, train_loss: 0.012605, valid_loss: 0.009656
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 16, train_loss: 0.012553, valid_loss: 0.009606
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 17, train_loss: 0.012498, valid_loss: 0.009545
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 18, train_loss: 0.012423, valid_loss: 0.009561
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 19, train_loss: 0.012320, valid_loss: 0.009484
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 20, train_loss: 0.012218, valid_loss: 0.009441
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 21, train_loss: 0.012123, valid_loss: 0.009385
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 22, train_loss: 0.012014, valid_loss: 0.009343
SEED: 1, FOLD: 0, ALL_TARGETS, EPOCH: 23, train_loss: 0.011965, valid_loss: 0.009363
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 0, train_loss: 0.643701, valid_loss: 0.261444
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 1, train_loss: 0.058425, valid_loss: 0.020048
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 2, train_loss: 0.020961, valid_loss: 0.017787
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 3, train_loss: 0.020007, valid_loss: 0.017455
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 4, train_loss: 0.022579, valid_loss: 0.017325
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 5, train_loss: 0.019750, valid_loss: 0.017335
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 6, train_loss: 0.019596, valid_loss: 0.017279
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 7, train_loss: 0.019539, valid_loss: 0.017182
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 8, train_loss: 0.019732, valid_loss: 0.017413
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 9, train_loss: 0.019510, valid_loss: 0.017364
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 10, train_loss: 0.019426, valid_loss: 0.017285
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 11, train_loss: 0.019317, valid_loss: 0.017281
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 12, train_loss: 0.019545, valid_loss: 0.017313
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 13, train_loss: 0.019291, valid_loss: 0.017295
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 14, train_loss: 0.019140, valid_loss: 0.017249
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 15, train_loss: 0.018979, valid_loss: 0.017283
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 16, train_loss: 0.019257, valid_loss: 0.017235
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 17, train_loss: 0.018875, valid_loss: 0.017274
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 18, train_loss: 0.018499, valid_loss: 0.017250
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 19, train_loss: 0.018179, valid_loss: 0.017223
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 20, train_loss: 0.017861, valid_loss: 0.017204
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 21, train_loss: 0.017579, valid_loss: 0.017250
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 22, train_loss: 0.017409, valid_loss: 0.017282
SEED: 1, FOLD: 0, SCORED_ONLY, EPOCH: 23, train_loss: 0.017348, valid_loss: 0.017235
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 0, train_loss: 0.496551, valid_loss: 0.020944
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 1, train_loss: 0.015819, valid_loss: 0.010354
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 2, train_loss: 0.013590, valid_loss: 0.009708
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 3, train_loss: 0.013205, valid_loss: 0.009467
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 4, train_loss: 0.013084, valid_loss: 0.010001
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 5, train_loss: 0.013038, valid_loss: 0.009430
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 6, train_loss: 0.012892, valid_loss: 0.009339
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 7, train_loss: 0.012904, valid_loss: 0.009555
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 8, train_loss: 0.012871, valid_loss: 0.009454
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 9, train_loss: 0.012834, valid_loss: 0.009679
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 10, train_loss: 0.012865, valid_loss: 0.009481
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 11, train_loss: 0.012796, valid_loss: 0.009396
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 12, train_loss: 0.012795, valid_loss: 0.009231
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 13, train_loss: 0.012765, valid_loss: 0.009533
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 14, train_loss: 0.012733, valid_loss: 0.009365
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 15, train_loss: 0.012703, valid_loss: 0.009195
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 16, train_loss: 0.012610, valid_loss: 0.009173
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 17, train_loss: 0.012540, valid_loss: 0.009205
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 18, train_loss: 0.012480, valid_loss: 0.009087
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 19, train_loss: 0.012392, valid_loss: 0.009079
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 20, train_loss: 0.012257, valid_loss: 0.009010
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 21, train_loss: 0.012145, valid_loss: 0.008950
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 22, train_loss: 0.012068, valid_loss: 0.008944
SEED: 1, FOLD: 1, ALL_TARGETS, EPOCH: 23, train_loss: 0.011997, valid_loss: 0.008932
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 0, train_loss: 0.642093, valid_loss: 0.253264
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 1, train_loss: 0.057393, valid_loss: 0.019979
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 2, train_loss: 0.020940, valid_loss: 0.017861
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 3, train_loss: 0.019945, valid_loss: 0.017632
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 4, train_loss: 0.022420, valid_loss: 0.017418
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 5, train_loss: 0.019743, valid_loss: 0.017371
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 6, train_loss: 0.019555, valid_loss: 0.017295
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 7, train_loss: 0.019476, valid_loss: 0.017465
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 8, train_loss: 0.019723, valid_loss: 0.017530
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 9, train_loss: 0.019412, valid_loss: 0.017406
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 10, train_loss: 0.019362, valid_loss: 0.017521
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 11, train_loss: 0.019234, valid_loss: 0.017320
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 12, train_loss: 0.019541, valid_loss: 0.017452
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 13, train_loss: 0.019290, valid_loss: 0.017453
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 14, train_loss: 0.019062, valid_loss: 0.017404
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 15, train_loss: 0.018913, valid_loss: 0.017477
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 16, train_loss: 0.019247, valid_loss: 0.017325
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 17, train_loss: 0.018790, valid_loss: 0.017285
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 18, train_loss: 0.018441, valid_loss: 0.017354
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 19, train_loss: 0.018102, valid_loss: 0.017348
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 20, train_loss: 0.017815, valid_loss: 0.017354
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 21, train_loss: 0.017535, valid_loss: 0.017463
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 22, train_loss: 0.017382, valid_loss: 0.017399
SEED: 1, FOLD: 1, SCORED_ONLY, EPOCH: 23, train_loss: 0.017289, valid_loss: 0.017385
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 0, train_loss: 0.496101, valid_loss: 0.020722
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 1, train_loss: 0.016162, valid_loss: 0.010351
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 2, train_loss: 0.013412, valid_loss: 0.010039
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 3, train_loss: 0.013122, valid_loss: 0.010033
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 4, train_loss: 0.013078, valid_loss: 0.009643
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 5, train_loss: 0.012856, valid_loss: 0.009669
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 6, train_loss: 0.012879, valid_loss: 0.009707
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 7, train_loss: 0.012853, valid_loss: 0.009695
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 8, train_loss: 0.012833, valid_loss: 0.009567
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 9, train_loss: 0.012825, valid_loss: 0.009697
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 10, train_loss: 0.012814, valid_loss: 0.009816
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 11, train_loss: 0.012801, valid_loss: 0.009624
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 12, train_loss: 0.012748, valid_loss: 0.009571
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 13, train_loss: 0.012727, valid_loss: 0.009552
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 14, train_loss: 0.012714, valid_loss: 0.009574
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 15, train_loss: 0.012680, valid_loss: 0.009430
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 16, train_loss: 0.012579, valid_loss: 0.009456
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 17, train_loss: 0.012528, valid_loss: 0.009468
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 18, train_loss: 0.012442, valid_loss: 0.009344
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 19, train_loss: 0.012344, valid_loss: 0.009238
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 20, train_loss: 0.012241, valid_loss: 0.009190
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 21, train_loss: 0.012138, valid_loss: 0.009171
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 22, train_loss: 0.012041, valid_loss: 0.009156
SEED: 1, FOLD: 2, ALL_TARGETS, EPOCH: 23, train_loss: 0.011983, valid_loss: 0.009152
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 0, train_loss: 0.644053, valid_loss: 0.263324
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 1, train_loss: 0.058552, valid_loss: 0.020363
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 2, train_loss: 0.020876, valid_loss: 0.018150
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 3, train_loss: 0.019918, valid_loss: 0.017943
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 4, train_loss: 0.024276, valid_loss: 0.017936
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 5, train_loss: 0.019765, valid_loss: 0.017873
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 6, train_loss: 0.019557, valid_loss: 0.017716
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 7, train_loss: 0.019474, valid_loss: 0.017725
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 8, train_loss: 0.019621, valid_loss: 0.017735
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 9, train_loss: 0.019439, valid_loss: 0.017735
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 10, train_loss: 0.019344, valid_loss: 0.017702
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 11, train_loss: 0.019272, valid_loss: 0.017646
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 12, train_loss: 0.019495, valid_loss: 0.017677
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 13, train_loss: 0.019233, valid_loss: 0.017611
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 14, train_loss: 0.019069, valid_loss: 0.017627
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 15, train_loss: 0.018915, valid_loss: 0.017619
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 16, train_loss: 0.019224, valid_loss: 0.017659
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 17, train_loss: 0.018789, valid_loss: 0.017593
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 18, train_loss: 0.018443, valid_loss: 0.017614
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 19, train_loss: 0.018090, valid_loss: 0.017636
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 20, train_loss: 0.017783, valid_loss: 0.017680
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 21, train_loss: 0.017507, valid_loss: 0.017663
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 22, train_loss: 0.017279, valid_loss: 0.017627
SEED: 1, FOLD: 2, SCORED_ONLY, EPOCH: 23, train_loss: 0.017210, valid_loss: 0.017641
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 0, train_loss: 0.497110, valid_loss: 0.021098
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 1, train_loss: 0.015434, valid_loss: 0.010317
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 2, train_loss: 0.013371, valid_loss: 0.009662
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 3, train_loss: 0.013067, valid_loss: 0.009456
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 4, train_loss: 0.012919, valid_loss: 0.009467
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 5, train_loss: 0.012822, valid_loss: 0.009381
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 6, train_loss: 0.012821, valid_loss: 0.009638
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 7, train_loss: 0.012799, valid_loss: 0.009477
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 8, train_loss: 0.012858, valid_loss: 0.009639
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 9, train_loss: 0.012811, valid_loss: 0.009680
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 10, train_loss: 0.012787, valid_loss: 0.009640
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 11, train_loss: 0.012795, valid_loss: 0.009491
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 12, train_loss: 0.012767, valid_loss: 0.009460
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 13, train_loss: 0.012746, valid_loss: 0.009373
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 14, train_loss: 0.012678, valid_loss: 0.009399
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 15, train_loss: 0.012652, valid_loss: 0.009352
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 16, train_loss: 0.012585, valid_loss: 0.009311
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 17, train_loss: 0.012525, valid_loss: 0.009254
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 18, train_loss: 0.012436, valid_loss: 0.009262
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 19, train_loss: 0.012340, valid_loss: 0.009189
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 20, train_loss: 0.012233, valid_loss: 0.009125
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 21, train_loss: 0.012122, valid_loss: 0.009048
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 22, train_loss: 0.012031, valid_loss: 0.009030
SEED: 1, FOLD: 3, ALL_TARGETS, EPOCH: 23, train_loss: 0.011975, valid_loss: 0.009019
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 0, train_loss: 0.640615, valid_loss: 0.262603
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 1, train_loss: 0.058949, valid_loss: 0.019905
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 2, train_loss: 0.020830, valid_loss: 0.017796
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 3, train_loss: 0.019864, valid_loss: 0.017506
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 4, train_loss: 0.023594, valid_loss: 0.017248
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 5, train_loss: 0.019653, valid_loss: 0.017420
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 6, train_loss: 0.019516, valid_loss: 0.017425
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 7, train_loss: 0.019401, valid_loss: 0.017342
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 8, train_loss: 0.019658, valid_loss: 0.017373
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 9, train_loss: 0.019439, valid_loss: 0.017368
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 10, train_loss: 0.019335, valid_loss: 0.017406
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 11, train_loss: 0.019236, valid_loss: 0.017443
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 12, train_loss: 0.019459, valid_loss: 0.017376
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 13, train_loss: 0.019260, valid_loss: 0.017443
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 14, train_loss: 0.019061, valid_loss: 0.017339
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 15, train_loss: 0.018900, valid_loss: 0.017334
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 16, train_loss: 0.019241, valid_loss: 0.017432
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 17, train_loss: 0.018778, valid_loss: 0.017434
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 18, train_loss: 0.018455, valid_loss: 0.017323
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 19, train_loss: 0.018154, valid_loss: 0.017370
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 20, train_loss: 0.017863, valid_loss: 0.017374
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 21, train_loss: 0.017589, valid_loss: 0.017402
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 22, train_loss: 0.017416, valid_loss: 0.017351
SEED: 1, FOLD: 3, SCORED_ONLY, EPOCH: 23, train_loss: 0.017348, valid_loss: 0.017347
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 0, train_loss: 0.496997, valid_loss: 0.021575
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 1, train_loss: 0.015574, valid_loss: 0.010071
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 2, train_loss: 0.013316, valid_loss: 0.009528
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 3, train_loss: 0.013196, valid_loss: 0.009440
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 4, train_loss: 0.012910, valid_loss: 0.009325
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 5, train_loss: 0.012900, valid_loss: 0.009530
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 6, train_loss: 0.012861, valid_loss: 0.009346
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 7, train_loss: 0.012862, valid_loss: 0.009301
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 8, train_loss: 0.012874, valid_loss: 0.009398
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 9, train_loss: 0.012864, valid_loss: 0.009373
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 10, train_loss: 0.012842, valid_loss: 0.009284
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 11, train_loss: 0.012830, valid_loss: 0.009377
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 12, train_loss: 0.012812, valid_loss: 0.009253
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 13, train_loss: 0.012782, valid_loss: 0.009235
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 14, train_loss: 0.012719, valid_loss: 0.009215
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 15, train_loss: 0.012705, valid_loss: 0.009209
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 16, train_loss: 0.012626, valid_loss: 0.009152
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 17, train_loss: 0.012576, valid_loss: 0.009105
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 18, train_loss: 0.012467, valid_loss: 0.009091
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 19, train_loss: 0.012382, valid_loss: 0.008974
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 20, train_loss: 0.012288, valid_loss: 0.008912
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 21, train_loss: 0.012172, valid_loss: 0.008885
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 22, train_loss: 0.012070, valid_loss: 0.008861
SEED: 1, FOLD: 4, ALL_TARGETS, EPOCH: 23, train_loss: 0.012019, valid_loss: 0.008849
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 0, train_loss: 0.642801, valid_loss: 0.262370
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 1, train_loss: 0.058556, valid_loss: 0.019705
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 2, train_loss: 0.021034, valid_loss: 0.017510
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 3, train_loss: 0.020007, valid_loss: 0.017170
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 4, train_loss: 0.024224, valid_loss: 0.016992
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 5, train_loss: 0.019695, valid_loss: 0.016942
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 6, train_loss: 0.019596, valid_loss: 0.016865
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 7, train_loss: 0.019510, valid_loss: 0.016840
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 8, train_loss: 0.019734, valid_loss: 0.016933
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 9, train_loss: 0.019544, valid_loss: 0.016878
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 10, train_loss: 0.019428, valid_loss: 0.016935
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 11, train_loss: 0.019369, valid_loss: 0.016899
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 12, train_loss: 0.019565, valid_loss: 0.016845
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 13, train_loss: 0.019258, valid_loss: 0.016944
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 14, train_loss: 0.019103, valid_loss: 0.016894
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 15, train_loss: 0.018962, valid_loss: 0.016837
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 16, train_loss: 0.019289, valid_loss: 0.016943
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 17, train_loss: 0.018903, valid_loss: 0.016889
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 18, train_loss: 0.018531, valid_loss: 0.016939
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 19, train_loss: 0.018222, valid_loss: 0.016870
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 20, train_loss: 0.017866, valid_loss: 0.016891
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 21, train_loss: 0.017617, valid_loss: 0.016929
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 22, train_loss: 0.017448, valid_loss: 0.016944
SEED: 1, FOLD: 4, SCORED_ONLY, EPOCH: 23, train_loss: 0.017384, valid_loss: 0.016940
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 0, train_loss: 0.495784, valid_loss: 0.020784
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 1, train_loss: 0.015628, valid_loss: 0.010607
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 2, train_loss: 0.014253, valid_loss: 0.009959
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 3, train_loss: 0.012976, valid_loss: 0.009897
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 4, train_loss: 0.012851, valid_loss: 0.009920
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 5, train_loss: 0.012822, valid_loss: 0.009778
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 6, train_loss: 0.012786, valid_loss: 0.009758
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 7, train_loss: 0.012756, valid_loss: 0.009866
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 8, train_loss: 0.012773, valid_loss: 0.009816
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 9, train_loss: 0.012761, valid_loss: 0.009869
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 10, train_loss: 0.012727, valid_loss: 0.009852
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 11, train_loss: 0.012730, valid_loss: 0.009776
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 12, train_loss: 0.012699, valid_loss: 0.009686
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 13, train_loss: 0.012669, valid_loss: 0.009777
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 14, train_loss: 0.012661, valid_loss: 0.009631
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 15, train_loss: 0.012581, valid_loss: 0.009680
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 16, train_loss: 0.012533, valid_loss: 0.009583
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 17, train_loss: 0.012461, valid_loss: 0.009562
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 18, train_loss: 0.012377, valid_loss: 0.009536
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 19, train_loss: 0.012293, valid_loss: 0.009449
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 20, train_loss: 0.012160, valid_loss: 0.009397
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 21, train_loss: 0.012048, valid_loss: 0.009375
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 22, train_loss: 0.011954, valid_loss: 0.009361
SEED: 1, FOLD: 5, ALL_TARGETS, EPOCH: 23, train_loss: 0.011901, valid_loss: 0.009352
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 0, train_loss: 0.642910, valid_loss: 0.257346
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 1, train_loss: 0.057598, valid_loss: 0.020545
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 2, train_loss: 0.020833, valid_loss: 0.018299
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 3, train_loss: 0.019807, valid_loss: 0.017910
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 4, train_loss: 0.023240, valid_loss: 0.017732
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 5, train_loss: 0.019542, valid_loss: 0.017742
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 6, train_loss: 0.019386, valid_loss: 0.017695
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 7, train_loss: 0.019281, valid_loss: 0.017609
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 8, train_loss: 0.019515, valid_loss: 0.017775
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 9, train_loss: 0.019280, valid_loss: 0.017762
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 10, train_loss: 0.019175, valid_loss: 0.017664
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 11, train_loss: 0.019123, valid_loss: 0.017464
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 12, train_loss: 0.019423, valid_loss: 0.017735
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 13, train_loss: 0.019077, valid_loss: 0.017633
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 14, train_loss: 0.018888, valid_loss: 0.017518
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 15, train_loss: 0.018750, valid_loss: 0.017551
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 16, train_loss: 0.019136, valid_loss: 0.017598
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 17, train_loss: 0.018715, valid_loss: 0.017591
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 18, train_loss: 0.018317, valid_loss: 0.017537
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 19, train_loss: 0.017975, valid_loss: 0.017493
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 20, train_loss: 0.017659, valid_loss: 0.017526
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 21, train_loss: 0.017415, valid_loss: 0.017568
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 22, train_loss: 0.017208, valid_loss: 0.017586
SEED: 1, FOLD: 5, SCORED_ONLY, EPOCH: 23, train_loss: 0.017135, valid_loss: 0.017548
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 0, train_loss: 0.497929, valid_loss: 0.023000
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 1, train_loss: 0.015428, valid_loss: 0.010485
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 2, train_loss: 0.013244, valid_loss: 0.009868
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 3, train_loss: 0.012904, valid_loss: 0.010006
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 4, train_loss: 0.012841, valid_loss: 0.009741
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 5, train_loss: 0.012804, valid_loss: 0.009882
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 6, train_loss: 0.012804, valid_loss: 0.009838
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 7, train_loss: 0.012809, valid_loss: 0.009609
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 8, train_loss: 0.012761, valid_loss: 0.009878
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 9, train_loss: 0.012754, valid_loss: 0.009710
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 10, train_loss: 0.012737, valid_loss: 0.009811
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 11, train_loss: 0.012734, valid_loss: 0.009699
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 12, train_loss: 0.012735, valid_loss: 0.009728
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 13, train_loss: 0.012702, valid_loss: 0.009687
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 14, train_loss: 0.012659, valid_loss: 0.009691
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 15, train_loss: 0.012629, valid_loss: 0.009563
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 16, train_loss: 0.012537, valid_loss: 0.009579
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 17, train_loss: 0.012489, valid_loss: 0.009604
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 18, train_loss: 0.012423, valid_loss: 0.009502
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 19, train_loss: 0.012316, valid_loss: 0.009434
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 20, train_loss: 0.012211, valid_loss: 0.009396
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 21, train_loss: 0.012103, valid_loss: 0.009333
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 22, train_loss: 0.012012, valid_loss: 0.009311
SEED: 1, FOLD: 6, ALL_TARGETS, EPOCH: 23, train_loss: 0.011967, valid_loss: 0.009301
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 0, train_loss: 0.641008, valid_loss: 0.257595
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 1, train_loss: 0.058395, valid_loss: 0.020062
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 2, train_loss: 0.020970, valid_loss: 0.017960
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 3, train_loss: 0.019963, valid_loss: 0.017622
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 4, train_loss: 0.024519, valid_loss: 0.017447
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 5, train_loss: 0.019739, valid_loss: 0.017454
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 6, train_loss: 0.019567, valid_loss: 0.017424
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 7, train_loss: 0.019488, valid_loss: 0.017435
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 8, train_loss: 0.019725, valid_loss: 0.017463
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 9, train_loss: 0.019495, valid_loss: 0.017528
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 10, train_loss: 0.019356, valid_loss: 0.017463
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 11, train_loss: 0.019308, valid_loss: 0.017366
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 12, train_loss: 0.019561, valid_loss: 0.017394
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 13, train_loss: 0.019276, valid_loss: 0.017294
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 14, train_loss: 0.019095, valid_loss: 0.017395
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 15, train_loss: 0.018958, valid_loss: 0.017385
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 16, train_loss: 0.019293, valid_loss: 0.017377
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 17, train_loss: 0.018925, valid_loss: 0.017137
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 18, train_loss: 0.018470, valid_loss: 0.017232
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 19, train_loss: 0.018154, valid_loss: 0.017287
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 20, train_loss: 0.017884, valid_loss: 0.017222
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 21, train_loss: 0.017617, valid_loss: 0.017237
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 22, train_loss: 0.017430, valid_loss: 0.017254
SEED: 1, FOLD: 6, SCORED_ONLY, EPOCH: 23, train_loss: 0.017340, valid_loss: 0.017224
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 0, train_loss: 0.496163, valid_loss: 0.022122
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 1, train_loss: 0.015367, valid_loss: 0.010997
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 2, train_loss: 0.013125, valid_loss: 0.010420
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 3, train_loss: 0.013183, valid_loss: 0.010244
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 4, train_loss: 0.012847, valid_loss: 0.010197
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 5, train_loss: 0.012680, valid_loss: 0.010359
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 6, train_loss: 0.012779, valid_loss: 0.010214
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 7, train_loss: 0.012709, valid_loss: 0.010315
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 8, train_loss: 0.012736, valid_loss: 0.010403
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 9, train_loss: 0.012707, valid_loss: 0.010240
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 10, train_loss: 0.012700, valid_loss: 0.010508
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 11, train_loss: 0.012665, valid_loss: 0.010318
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 12, train_loss: 0.012674, valid_loss: 0.010134
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 13, train_loss: 0.012664, valid_loss: 0.010096
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 14, train_loss: 0.012643, valid_loss: 0.010000
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 15, train_loss: 0.012553, valid_loss: 0.010040
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 16, train_loss: 0.012517, valid_loss: 0.009962
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 17, train_loss: 0.012450, valid_loss: 0.009999
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 18, train_loss: 0.012378, valid_loss: 0.009868
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 19, train_loss: 0.012277, valid_loss: 0.009850
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 20, train_loss: 0.012179, valid_loss: 0.009753
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 21, train_loss: 0.012072, valid_loss: 0.009709
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 22, train_loss: 0.011980, valid_loss: 0.009707
SEED: 2, FOLD: 0, ALL_TARGETS, EPOCH: 23, train_loss: 0.011919, valid_loss: 0.009709
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 0, train_loss: 0.641111, valid_loss: 0.257112
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 1, train_loss: 0.058277, valid_loss: 0.020628
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 2, train_loss: 0.021013, valid_loss: 0.018381
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 3, train_loss: 0.019990, valid_loss: 0.018086
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 4, train_loss: 0.022197, valid_loss: 0.017979
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 5, train_loss: 0.019744, valid_loss: 0.017989
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 6, train_loss: 0.019577, valid_loss: 0.017936
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 7, train_loss: 0.019470, valid_loss: 0.017954
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 8, train_loss: 0.019739, valid_loss: 0.018120
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 9, train_loss: 0.019500, valid_loss: 0.017792
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 10, train_loss: 0.019393, valid_loss: 0.017920
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 11, train_loss: 0.019295, valid_loss: 0.017991
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 12, train_loss: 0.019510, valid_loss: 0.017978
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 13, train_loss: 0.019249, valid_loss: 0.017932
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 14, train_loss: 0.019115, valid_loss: 0.017811
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 15, train_loss: 0.018999, valid_loss: 0.017895
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 16, train_loss: 0.019249, valid_loss: 0.017954
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 17, train_loss: 0.018837, valid_loss: 0.017878
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 18, train_loss: 0.018456, valid_loss: 0.017865
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 19, train_loss: 0.018152, valid_loss: 0.017855
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 20, train_loss: 0.017847, valid_loss: 0.017842
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 21, train_loss: 0.017576, valid_loss: 0.017886
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 22, train_loss: 0.017397, valid_loss: 0.017867
SEED: 2, FOLD: 0, SCORED_ONLY, EPOCH: 23, train_loss: 0.017344, valid_loss: 0.017841
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 0, train_loss: 0.495829, valid_loss: 0.020522
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 1, train_loss: 0.015359, valid_loss: 0.010471
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 2, train_loss: 0.013393, valid_loss: 0.009833
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 3, train_loss: 0.013356, valid_loss: 0.009587
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 4, train_loss: 0.012855, valid_loss: 0.009658
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 5, train_loss: 0.012795, valid_loss: 0.009827
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 6, train_loss: 0.012844, valid_loss: 0.009679
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 7, train_loss: 0.012831, valid_loss: 0.009495
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 8, train_loss: 0.012836, valid_loss: 0.009696
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 9, train_loss: 0.012825, valid_loss: 0.009516
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 10, train_loss: 0.012784, valid_loss: 0.009573
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 11, train_loss: 0.012813, valid_loss: 0.009518
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 12, train_loss: 0.012746, valid_loss: 0.009599
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 13, train_loss: 0.012732, valid_loss: 0.009371
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 14, train_loss: 0.012725, valid_loss: 0.009463
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 15, train_loss: 0.012660, valid_loss: 0.009434
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 16, train_loss: 0.012599, valid_loss: 0.009371
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 17, train_loss: 0.012530, valid_loss: 0.009354
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 18, train_loss: 0.012461, valid_loss: 0.009298
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 19, train_loss: 0.012366, valid_loss: 0.009291
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 20, train_loss: 0.012255, valid_loss: 0.009184
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 21, train_loss: 0.012148, valid_loss: 0.009130
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 22, train_loss: 0.012050, valid_loss: 0.009105
SEED: 2, FOLD: 1, ALL_TARGETS, EPOCH: 23, train_loss: 0.011997, valid_loss: 0.009094
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 0, train_loss: 0.640911, valid_loss: 0.262924
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 1, train_loss: 0.058122, valid_loss: 0.020098
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 2, train_loss: 0.020942, valid_loss: 0.017812
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 3, train_loss: 0.020013, valid_loss: 0.017456
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 4, train_loss: 0.022853, valid_loss: 0.017350
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 5, train_loss: 0.019774, valid_loss: 0.017293
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 6, train_loss: 0.019616, valid_loss: 0.017318
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 7, train_loss: 0.019550, valid_loss: 0.017232
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 8, train_loss: 0.019729, valid_loss: 0.017453
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 9, train_loss: 0.019476, valid_loss: 0.017269
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 10, train_loss: 0.019438, valid_loss: 0.017169
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 11, train_loss: 0.019303, valid_loss: 0.017149
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 12, train_loss: 0.019563, valid_loss: 0.017226
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 13, train_loss: 0.019275, valid_loss: 0.017115
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 14, train_loss: 0.019092, valid_loss: 0.017085
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 15, train_loss: 0.019006, valid_loss: 0.017133
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 16, train_loss: 0.019271, valid_loss: 0.017127
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 17, train_loss: 0.018887, valid_loss: 0.017089
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 18, train_loss: 0.018542, valid_loss: 0.016951
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 19, train_loss: 0.018216, valid_loss: 0.016941
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 20, train_loss: 0.017957, valid_loss: 0.016945
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 21, train_loss: 0.017666, valid_loss: 0.016959
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 22, train_loss: 0.017466, valid_loss: 0.016950
SEED: 2, FOLD: 1, SCORED_ONLY, EPOCH: 23, train_loss: 0.017396, valid_loss: 0.016935
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 0, train_loss: 0.497947, valid_loss: 0.022705
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 1, train_loss: 0.015724, valid_loss: 0.010302
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 2, train_loss: 0.013521, valid_loss: 0.009688
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 3, train_loss: 0.012960, valid_loss: 0.009618
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 4, train_loss: 0.012919, valid_loss: 0.009515
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 5, train_loss: 0.013034, valid_loss: 0.009511
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 6, train_loss: 0.012810, valid_loss: 0.009316
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 7, train_loss: 0.012836, valid_loss: 0.009336
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 8, train_loss: 0.012854, valid_loss: 0.009400
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 9, train_loss: 0.012836, valid_loss: 0.009428
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 10, train_loss: 0.012830, valid_loss: 0.009348
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 11, train_loss: 0.012796, valid_loss: 0.009408
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 12, train_loss: 0.012793, valid_loss: 0.009313
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 13, train_loss: 0.012765, valid_loss: 0.009294
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 14, train_loss: 0.012737, valid_loss: 0.009400
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 15, train_loss: 0.012672, valid_loss: 0.009419
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 16, train_loss: 0.012632, valid_loss: 0.009159
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 17, train_loss: 0.012554, valid_loss: 0.009177
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 18, train_loss: 0.012463, valid_loss: 0.009129
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 19, train_loss: 0.012376, valid_loss: 0.009073
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 20, train_loss: 0.012272, valid_loss: 0.009025
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 21, train_loss: 0.012170, valid_loss: 0.008980
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 22, train_loss: 0.012064, valid_loss: 0.008982
SEED: 2, FOLD: 2, ALL_TARGETS, EPOCH: 23, train_loss: 0.012019, valid_loss: 0.008968
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 0, train_loss: 0.642235, valid_loss: 0.266485
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 1, train_loss: 0.059101, valid_loss: 0.019908
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 2, train_loss: 0.020926, valid_loss: 0.017802
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 3, train_loss: 0.019988, valid_loss: 0.017469
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 4, train_loss: 0.021857, valid_loss: 0.017156
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 5, train_loss: 0.019775, valid_loss: 0.017189
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 6, train_loss: 0.019621, valid_loss: 0.017258
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 7, train_loss: 0.019488, valid_loss: 0.017184
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 8, train_loss: 0.019722, valid_loss: 0.017294
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 9, train_loss: 0.019451, valid_loss: 0.017145
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 10, train_loss: 0.019358, valid_loss: 0.017138
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 11, train_loss: 0.019304, valid_loss: 0.017122
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 12, train_loss: 0.019582, valid_loss: 0.017229
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 13, train_loss: 0.019275, valid_loss: 0.017032
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 14, train_loss: 0.019080, valid_loss: 0.017162
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 15, train_loss: 0.018972, valid_loss: 0.017141
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 16, train_loss: 0.019251, valid_loss: 0.017124
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 17, train_loss: 0.018883, valid_loss: 0.017075
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 18, train_loss: 0.018514, valid_loss: 0.017076
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 19, train_loss: 0.018207, valid_loss: 0.017071
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 20, train_loss: 0.017810, valid_loss: 0.017034
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 21, train_loss: 0.017589, valid_loss: 0.017084
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 22, train_loss: 0.017434, valid_loss: 0.017024
SEED: 2, FOLD: 2, SCORED_ONLY, EPOCH: 23, train_loss: 0.017318, valid_loss: 0.017038
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 0, train_loss: 0.496770, valid_loss: 0.024007
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 1, train_loss: 0.015602, valid_loss: 0.010732
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 2, train_loss: 0.013368, valid_loss: 0.010180
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 3, train_loss: 0.012879, valid_loss: 0.012286
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 4, train_loss: 0.013537, valid_loss: 0.009909
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 5, train_loss: 0.013118, valid_loss: 0.009977
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 6, train_loss: 0.012798, valid_loss: 0.009984
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 7, train_loss: 0.012809, valid_loss: 0.009934
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 8, train_loss: 0.012783, valid_loss: 0.010004
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 9, train_loss: 0.012770, valid_loss: 0.009913
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 10, train_loss: 0.012769, valid_loss: 0.010168
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 11, train_loss: 0.012740, valid_loss: 0.009899
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 12, train_loss: 0.012738, valid_loss: 0.009809
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 13, train_loss: 0.012708, valid_loss: 0.009923
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 14, train_loss: 0.012643, valid_loss: 0.009768
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 15, train_loss: 0.012604, valid_loss: 0.009707
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 16, train_loss: 0.012539, valid_loss: 0.009655
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 17, train_loss: 0.012459, valid_loss: 0.009603
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 18, train_loss: 0.012392, valid_loss: 0.009629
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 19, train_loss: 0.012307, valid_loss: 0.009533
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 20, train_loss: 0.012198, valid_loss: 0.009500
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 21, train_loss: 0.012089, valid_loss: 0.009418
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 22, train_loss: 0.012005, valid_loss: 0.009391
SEED: 2, FOLD: 3, ALL_TARGETS, EPOCH: 23, train_loss: 0.011936, valid_loss: 0.009394
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 0, train_loss: 0.643636, valid_loss: 0.260759
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 1, train_loss: 0.058243, valid_loss: 0.020212
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 2, train_loss: 0.021000, valid_loss: 0.018092
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 3, train_loss: 0.019960, valid_loss: 0.017634
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 4, train_loss: 0.023872, valid_loss: 0.017580
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 5, train_loss: 0.019674, valid_loss: 0.017436
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 6, train_loss: 0.019486, valid_loss: 0.017439
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 7, train_loss: 0.019486, valid_loss: 0.017368
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 8, train_loss: 0.019684, valid_loss: 0.017446
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 9, train_loss: 0.019466, valid_loss: 0.017350
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 10, train_loss: 0.019373, valid_loss: 0.017338
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 11, train_loss: 0.019319, valid_loss: 0.017324
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 12, train_loss: 0.019547, valid_loss: 0.017371
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 13, train_loss: 0.019348, valid_loss: 0.017562
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 14, train_loss: 0.019115, valid_loss: 0.017355
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 15, train_loss: 0.018950, valid_loss: 0.017365
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 16, train_loss: 0.019296, valid_loss: 0.017360
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 17, train_loss: 0.018880, valid_loss: 0.017384
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 18, train_loss: 0.018552, valid_loss: 0.017337
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 19, train_loss: 0.018181, valid_loss: 0.017302
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 20, train_loss: 0.017886, valid_loss: 0.017252
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 21, train_loss: 0.017629, valid_loss: 0.017285
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 22, train_loss: 0.017450, valid_loss: 0.017297
SEED: 2, FOLD: 3, SCORED_ONLY, EPOCH: 23, train_loss: 0.017349, valid_loss: 0.017312
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 0, train_loss: 0.494802, valid_loss: 0.019726
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 1, train_loss: 0.015765, valid_loss: 0.010498
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 2, train_loss: 0.013515, valid_loss: 0.009819
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 3, train_loss: 0.012937, valid_loss: 0.009359
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 4, train_loss: 0.012831, valid_loss: 0.009368
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 5, train_loss: 0.012867, valid_loss: 0.009668
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 6, train_loss: 0.012846, valid_loss: 0.009486
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 7, train_loss: 0.012870, valid_loss: 0.009423
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 8, train_loss: 0.012828, valid_loss: 0.010009
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 9, train_loss: 0.012831, valid_loss: 0.009483
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 10, train_loss: 0.012796, valid_loss: 0.009605
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 11, train_loss: 0.012813, valid_loss: 0.009595
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 12, train_loss: 0.012795, valid_loss: 0.009504
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 13, train_loss: 0.012748, valid_loss: 0.009454
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 14, train_loss: 0.012729, valid_loss: 0.009437
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 15, train_loss: 0.012665, valid_loss: 0.009447
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 16, train_loss: 0.012608, valid_loss: 0.009252
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 17, train_loss: 0.012553, valid_loss: 0.009231
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 18, train_loss: 0.012452, valid_loss: 0.009214
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 19, train_loss: 0.012361, valid_loss: 0.009186
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 20, train_loss: 0.012255, valid_loss: 0.009099
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 21, train_loss: 0.012149, valid_loss: 0.009065
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 22, train_loss: 0.012044, valid_loss: 0.009054
SEED: 2, FOLD: 4, ALL_TARGETS, EPOCH: 23, train_loss: 0.011997, valid_loss: 0.009045
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 0, train_loss: 0.641628, valid_loss: 0.257518
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 1, train_loss: 0.057706, valid_loss: 0.020196
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 2, train_loss: 0.020972, valid_loss: 0.017911
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 3, train_loss: 0.019932, valid_loss: 0.017596
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 4, train_loss: 0.023629, valid_loss: 0.017362
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 5, train_loss: 0.019680, valid_loss: 0.017337
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 6, train_loss: 0.019586, valid_loss: 0.017469
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 7, train_loss: 0.019496, valid_loss: 0.017416
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 8, train_loss: 0.019736, valid_loss: 0.017522
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 9, train_loss: 0.019449, valid_loss: 0.017390
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 10, train_loss: 0.019374, valid_loss: 0.017344
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 11, train_loss: 0.019322, valid_loss: 0.017392
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 12, train_loss: 0.019491, valid_loss: 0.017365
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 13, train_loss: 0.019263, valid_loss: 0.017390
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 14, train_loss: 0.019079, valid_loss: 0.017326
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 15, train_loss: 0.018957, valid_loss: 0.017245
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 16, train_loss: 0.019225, valid_loss: 0.017345
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 17, train_loss: 0.018796, valid_loss: 0.017371
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 18, train_loss: 0.018471, valid_loss: 0.017363
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 19, train_loss: 0.018161, valid_loss: 0.017406
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 20, train_loss: 0.017852, valid_loss: 0.017391
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 21, train_loss: 0.017599, valid_loss: 0.017400
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 22, train_loss: 0.017440, valid_loss: 0.017456
SEED: 2, FOLD: 4, SCORED_ONLY, EPOCH: 23, train_loss: 0.017395, valid_loss: 0.017392
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 0, train_loss: 0.495481, valid_loss: 0.020690
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 1, train_loss: 0.015529, valid_loss: 0.012788
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 2, train_loss: 0.013543, valid_loss: 0.009686
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 3, train_loss: 0.013506, valid_loss: 0.011828
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 4, train_loss: 0.013027, valid_loss: 0.011753
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 5, train_loss: 0.013193, valid_loss: 0.009521
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 6, train_loss: 0.012895, valid_loss: 0.009557
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 7, train_loss: 0.012853, valid_loss: 0.010349
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 8, train_loss: 0.012819, valid_loss: 0.009649
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 9, train_loss: 0.012815, valid_loss: 0.009544
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 10, train_loss: 0.012821, valid_loss: 0.009646
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 11, train_loss: 0.012808, valid_loss: 0.009482
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 12, train_loss: 0.012807, valid_loss: 0.009539
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 13, train_loss: 0.012780, valid_loss: 0.009374
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 14, train_loss: 0.012752, valid_loss: 0.009399
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 15, train_loss: 0.012671, valid_loss: 0.009235
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 16, train_loss: 0.012622, valid_loss: 0.009146
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 17, train_loss: 0.012541, valid_loss: 0.009199
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 18, train_loss: 0.012471, valid_loss: 0.009143
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 19, train_loss: 0.012368, valid_loss: 0.009089
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 20, train_loss: 0.012256, valid_loss: 0.009043
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 21, train_loss: 0.012149, valid_loss: 0.008980
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 22, train_loss: 0.012039, valid_loss: 0.008978
SEED: 2, FOLD: 5, ALL_TARGETS, EPOCH: 23, train_loss: 0.011998, valid_loss: 0.008946
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 0, train_loss: 0.643955, valid_loss: 0.260882
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 1, train_loss: 0.058176, valid_loss: 0.020222
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 2, train_loss: 0.021014, valid_loss: 0.017975
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 3, train_loss: 0.020003, valid_loss: 0.017787
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 4, train_loss: 0.024537, valid_loss: 0.017562
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 5, train_loss: 0.019673, valid_loss: 0.017587
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 6, train_loss: 0.019539, valid_loss: 0.017601
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 7, train_loss: 0.019429, valid_loss: 0.017578
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 8, train_loss: 0.019630, valid_loss: 0.017757
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 9, train_loss: 0.019481, valid_loss: 0.017430
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 10, train_loss: 0.019391, valid_loss: 0.017583
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 11, train_loss: 0.019214, valid_loss: 0.017536
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 12, train_loss: 0.019530, valid_loss: 0.017634
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 13, train_loss: 0.019260, valid_loss: 0.017514
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 14, train_loss: 0.019089, valid_loss: 0.017518
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 15, train_loss: 0.018951, valid_loss: 0.017501
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 16, train_loss: 0.019261, valid_loss: 0.017534
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 17, train_loss: 0.018805, valid_loss: 0.017501
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 18, train_loss: 0.018483, valid_loss: 0.017550
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 19, train_loss: 0.018127, valid_loss: 0.017541
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 20, train_loss: 0.017800, valid_loss: 0.017523
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 21, train_loss: 0.017565, valid_loss: 0.017564
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 22, train_loss: 0.017383, valid_loss: 0.017587
SEED: 2, FOLD: 5, SCORED_ONLY, EPOCH: 23, train_loss: 0.017318, valid_loss: 0.017588
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 0, train_loss: 0.495046, valid_loss: 0.020456
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 1, train_loss: 0.015432, valid_loss: 0.010216
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 2, train_loss: 0.013349, valid_loss: 0.009423
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 3, train_loss: 0.013026, valid_loss: 0.009410
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 4, train_loss: 0.012807, valid_loss: 0.009342
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 5, train_loss: 0.012904, valid_loss: 0.009232
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 6, train_loss: 0.012850, valid_loss: 0.010091
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 7, train_loss: 0.012857, valid_loss: 0.009414
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 8, train_loss: 0.012843, valid_loss: 0.009349
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 9, train_loss: 0.012852, valid_loss: 0.009566
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 10, train_loss: 0.012816, valid_loss: 0.009350
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 11, train_loss: 0.012812, valid_loss: 0.009405
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 12, train_loss: 0.012797, valid_loss: 0.009329
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 13, train_loss: 0.012765, valid_loss: 0.009229
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 14, train_loss: 0.012731, valid_loss: 0.009184
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 15, train_loss: 0.012678, valid_loss: 0.009179
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 16, train_loss: 0.012633, valid_loss: 0.009288
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 17, train_loss: 0.012568, valid_loss: 0.009075
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 18, train_loss: 0.012485, valid_loss: 0.009035
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 19, train_loss: 0.012381, valid_loss: 0.008973
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 20, train_loss: 0.012267, valid_loss: 0.008968
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 21, train_loss: 0.012160, valid_loss: 0.008889
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 22, train_loss: 0.012061, valid_loss: 0.008880
SEED: 2, FOLD: 6, ALL_TARGETS, EPOCH: 23, train_loss: 0.012012, valid_loss: 0.008874
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 0, train_loss: 0.638467, valid_loss: 0.260756
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 1, train_loss: 0.058821, valid_loss: 0.019840
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 2, train_loss: 0.020869, valid_loss: 0.017834
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 3, train_loss: 0.019940, valid_loss: 0.017422
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 4, train_loss: 0.022059, valid_loss: 0.017285
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 5, train_loss: 0.019751, valid_loss: 0.017339
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 6, train_loss: 0.019577, valid_loss: 0.017269
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 7, train_loss: 0.019455, valid_loss: 0.017334
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 8, train_loss: 0.019687, valid_loss: 0.017261
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 9, train_loss: 0.019459, valid_loss: 0.017206
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 10, train_loss: 0.019367, valid_loss: 0.017405
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 11, train_loss: 0.019276, valid_loss: 0.017225
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 12, train_loss: 0.019529, valid_loss: 0.017202
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 13, train_loss: 0.019284, valid_loss: 0.017278
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 14, train_loss: 0.019052, valid_loss: 0.017166
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 15, train_loss: 0.018917, valid_loss: 0.017243
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 16, train_loss: 0.019280, valid_loss: 0.017345
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 17, train_loss: 0.018855, valid_loss: 0.017273
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 18, train_loss: 0.018454, valid_loss: 0.017196
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 19, train_loss: 0.018174, valid_loss: 0.017153
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 20, train_loss: 0.017872, valid_loss: 0.017189
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 21, train_loss: 0.017577, valid_loss: 0.017127
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 22, train_loss: 0.017405, valid_loss: 0.017134
SEED: 2, FOLD: 6, SCORED_ONLY, EPOCH: 23, train_loss: 0.017306, valid_loss: 0.017162
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 0, train_loss: 0.495638, valid_loss: 0.020955
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 1, train_loss: 0.015660, valid_loss: 0.010222
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 2, train_loss: 0.013522, valid_loss: 0.011715
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 3, train_loss: 0.013257, valid_loss: 0.013222
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 4, train_loss: 0.013244, valid_loss: 0.011653
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 5, train_loss: 0.013424, valid_loss: 0.108210
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 6, train_loss: 0.014718, valid_loss: 0.009656
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 7, train_loss: 0.013192, valid_loss: 0.009741
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 8, train_loss: 0.013057, valid_loss: 0.009706
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 9, train_loss: 0.012988, valid_loss: 0.009544
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 10, train_loss: 0.012975, valid_loss: 0.009513
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 11, train_loss: 0.012938, valid_loss: 0.009458
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 12, train_loss: 0.012888, valid_loss: 0.009324
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 13, train_loss: 0.012864, valid_loss: 0.009816
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 14, train_loss: 0.012856, valid_loss: 0.009250
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 15, train_loss: 0.012769, valid_loss: 0.009293
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 16, train_loss: 0.012720, valid_loss: 0.009198
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 17, train_loss: 0.012640, valid_loss: 0.009130
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 18, train_loss: 0.012527, valid_loss: 0.009100
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 19, train_loss: 0.012488, valid_loss: 0.009030
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 20, train_loss: 0.012375, valid_loss: 0.008964
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 21, train_loss: 0.012250, valid_loss: 0.008918
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 22, train_loss: 0.012174, valid_loss: 0.008909
SEED: 3, FOLD: 0, ALL_TARGETS, EPOCH: 23, train_loss: 0.012118, valid_loss: 0.008919
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 0, train_loss: 0.647594, valid_loss: 0.262760
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 1, train_loss: 0.059040, valid_loss: 0.020011
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 2, train_loss: 0.021244, valid_loss: 0.017885
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 3, train_loss: 0.020211, valid_loss: 0.017811
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 4, train_loss: 0.026224, valid_loss: 0.017333
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 5, train_loss: 0.019882, valid_loss: 0.017467
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 6, train_loss: 0.019886, valid_loss: 0.017439
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 7, train_loss: 0.019909, valid_loss: 0.017477
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 8, train_loss: 0.019897, valid_loss: 0.017465
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 9, train_loss: 0.019721, valid_loss: 0.017264
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 10, train_loss: 0.019548, valid_loss: 0.017521
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 11, train_loss: 0.019692, valid_loss: 0.017306
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 12, train_loss: 0.019784, valid_loss: 0.017287
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 13, train_loss: 0.019642, valid_loss: 0.017317
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 14, train_loss: 0.019434, valid_loss: 0.017284
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 15, train_loss: 0.019256, valid_loss: 0.017255
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 16, train_loss: 0.019804, valid_loss: 0.017292
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 17, train_loss: 0.019277, valid_loss: 0.017205
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 18, train_loss: 0.018939, valid_loss: 0.017218
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 19, train_loss: 0.018508, valid_loss: 0.017202
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 20, train_loss: 0.018124, valid_loss: 0.017324
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 21, train_loss: 0.017865, valid_loss: 0.017245
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 22, train_loss: 0.017822, valid_loss: 0.017216
SEED: 3, FOLD: 0, SCORED_ONLY, EPOCH: 23, train_loss: 0.017727, valid_loss: 0.017172
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 0, train_loss: 0.496637, valid_loss: 0.020984
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 1, train_loss: 0.016364, valid_loss: 0.010067
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 2, train_loss: 0.013402, valid_loss: 0.009601
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 3, train_loss: 0.013028, valid_loss: 0.009503
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 4, train_loss: 0.012903, valid_loss: 0.009641
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 5, train_loss: 0.012807, valid_loss: 0.009440
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 6, train_loss: 0.013012, valid_loss: 0.009487
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 7, train_loss: 0.012814, valid_loss: 0.009348
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 8, train_loss: 0.012847, valid_loss: 0.009764
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 9, train_loss: 0.012804, valid_loss: 0.009448
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 10, train_loss: 0.012798, valid_loss: 0.009419
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 11, train_loss: 0.012804, valid_loss: 0.009465
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 12, train_loss: 0.012744, valid_loss: 0.009471
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 13, train_loss: 0.012715, valid_loss: 0.009418
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 14, train_loss: 0.012697, valid_loss: 0.009420
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 15, train_loss: 0.012638, valid_loss: 0.009230
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 16, train_loss: 0.012583, valid_loss: 0.009299
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 17, train_loss: 0.012547, valid_loss: 0.009203
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 18, train_loss: 0.012432, valid_loss: 0.009231
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 19, train_loss: 0.012333, valid_loss: 0.009108
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 20, train_loss: 0.012218, valid_loss: 0.009044
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 21, train_loss: 0.012115, valid_loss: 0.009024
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 22, train_loss: 0.012018, valid_loss: 0.009009
SEED: 3, FOLD: 1, ALL_TARGETS, EPOCH: 23, train_loss: 0.011960, valid_loss: 0.009007
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 0, train_loss: 0.643746, valid_loss: 0.263022
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 1, train_loss: 0.058864, valid_loss: 0.020026
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 2, train_loss: 0.021081, valid_loss: 0.017724
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 3, train_loss: 0.019991, valid_loss: 0.017308
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 4, train_loss: 0.024422, valid_loss: 0.017209
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 5, train_loss: 0.019728, valid_loss: 0.017095
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 6, train_loss: 0.019543, valid_loss: 0.017085
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 7, train_loss: 0.019442, valid_loss: 0.017030
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 8, train_loss: 0.019807, valid_loss: 0.017215
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 9, train_loss: 0.019525, valid_loss: 0.017184
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 10, train_loss: 0.019356, valid_loss: 0.017049
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 11, train_loss: 0.019303, valid_loss: 0.017022
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 12, train_loss: 0.019535, valid_loss: 0.017146
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 13, train_loss: 0.019252, valid_loss: 0.016886
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 14, train_loss: 0.019094, valid_loss: 0.016968
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 15, train_loss: 0.018966, valid_loss: 0.016992
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 16, train_loss: 0.019269, valid_loss: 0.017000
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 17, train_loss: 0.018851, valid_loss: 0.016853
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 18, train_loss: 0.018516, valid_loss: 0.016945
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 19, train_loss: 0.018200, valid_loss: 0.016894
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 20, train_loss: 0.017890, valid_loss: 0.016867
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 21, train_loss: 0.017666, valid_loss: 0.016917
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 22, train_loss: 0.017461, valid_loss: 0.016916
SEED: 3, FOLD: 1, SCORED_ONLY, EPOCH: 23, train_loss: 0.017401, valid_loss: 0.016906
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 0, train_loss: 0.496056, valid_loss: 0.048510
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 1, train_loss: 0.015603, valid_loss: 0.010426
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 2, train_loss: 0.013499, valid_loss: 0.009693
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 3, train_loss: 0.013003, valid_loss: 0.010573
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 4, train_loss: 0.012968, valid_loss: 0.010154
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 5, train_loss: 0.012891, valid_loss: 0.009524
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 6, train_loss: 0.012897, valid_loss: 0.009367
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 7, train_loss: 0.012906, valid_loss: 0.009612
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 8, train_loss: 0.012867, valid_loss: 0.009330
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 9, train_loss: 0.012849, valid_loss: 0.009372
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 10, train_loss: 0.012886, valid_loss: 0.009380
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 11, train_loss: 0.012836, valid_loss: 0.009241
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 12, train_loss: 0.012829, valid_loss: 0.009220
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 13, train_loss: 0.012774, valid_loss: 0.009237
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 14, train_loss: 0.012742, valid_loss: 0.009230
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 15, train_loss: 0.012700, valid_loss: 0.009173
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 16, train_loss: 0.012601, valid_loss: 0.009079
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 17, train_loss: 0.012583, valid_loss: 0.008989
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 18, train_loss: 0.012529, valid_loss: 0.009009
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 19, train_loss: 0.012419, valid_loss: 0.008914
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 20, train_loss: 0.012299, valid_loss: 0.008902
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 21, train_loss: 0.012195, valid_loss: 0.008814
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 22, train_loss: 0.012096, valid_loss: 0.008799
SEED: 3, FOLD: 2, ALL_TARGETS, EPOCH: 23, train_loss: 0.012044, valid_loss: 0.008771
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 0, train_loss: 0.639483, valid_loss: 0.256414
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 1, train_loss: 0.057833, valid_loss: 0.019788
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 2, train_loss: 0.021022, valid_loss: 0.017658
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 3, train_loss: 0.020025, valid_loss: 0.017426
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 4, train_loss: 0.023568, valid_loss: 0.017192
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 5, train_loss: 0.019822, valid_loss: 0.017244
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 6, train_loss: 0.019701, valid_loss: 0.017079
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 7, train_loss: 0.019563, valid_loss: 0.017169
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 8, train_loss: 0.019780, valid_loss: 0.017222
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 9, train_loss: 0.019569, valid_loss: 0.017130
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 10, train_loss: 0.019431, valid_loss: 0.017199
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 11, train_loss: 0.019452, valid_loss: 0.017108
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 12, train_loss: 0.019565, valid_loss: 0.017236
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 13, train_loss: 0.019359, valid_loss: 0.017132
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 14, train_loss: 0.019195, valid_loss: 0.017075
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 15, train_loss: 0.019061, valid_loss: 0.017073
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 16, train_loss: 0.019322, valid_loss: 0.017066
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 17, train_loss: 0.018857, valid_loss: 0.017034
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 18, train_loss: 0.018587, valid_loss: 0.017065
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 19, train_loss: 0.018267, valid_loss: 0.016989
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 20, train_loss: 0.017944, valid_loss: 0.017008
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 21, train_loss: 0.017681, valid_loss: 0.017018
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 22, train_loss: 0.017536, valid_loss: 0.017031
SEED: 3, FOLD: 2, SCORED_ONLY, EPOCH: 23, train_loss: 0.017470, valid_loss: 0.017005
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 0, train_loss: 0.496187, valid_loss: 0.022354
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 1, train_loss: 0.015764, valid_loss: 0.010573
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 2, train_loss: 0.013477, valid_loss: 0.009841
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 3, train_loss: 0.012878, valid_loss: 0.009672
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 4, train_loss: 0.013779, valid_loss: 0.009983
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 5, train_loss: 0.013056, valid_loss: 0.009665
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 6, train_loss: 0.012897, valid_loss: 0.009692
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 7, train_loss: 0.012851, valid_loss: 0.009736
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 8, train_loss: 0.012825, valid_loss: 0.009618
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 9, train_loss: 0.012817, valid_loss: 0.009863
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 10, train_loss: 0.012787, valid_loss: 0.009599
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 11, train_loss: 0.012775, valid_loss: 0.009631
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 12, train_loss: 0.012758, valid_loss: 0.009624
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 13, train_loss: 0.012717, valid_loss: 0.009616
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 14, train_loss: 0.012687, valid_loss: 0.009604
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 15, train_loss: 0.012651, valid_loss: 0.009477
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 16, train_loss: 0.012613, valid_loss: 0.009441
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 17, train_loss: 0.012534, valid_loss: 0.009434
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 18, train_loss: 0.012424, valid_loss: 0.009359
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 19, train_loss: 0.012350, valid_loss: 0.009293
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 20, train_loss: 0.012249, valid_loss: 0.009219
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 21, train_loss: 0.012138, valid_loss: 0.009159
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 22, train_loss: 0.012051, valid_loss: 0.009135
SEED: 3, FOLD: 3, ALL_TARGETS, EPOCH: 23, train_loss: 0.011991, valid_loss: 0.009114
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 0, train_loss: 0.644161, valid_loss: 0.260006
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 1, train_loss: 0.058708, valid_loss: 0.020417
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 2, train_loss: 0.020974, valid_loss: 0.018144
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 3, train_loss: 0.019968, valid_loss: 0.017798
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 4, train_loss: 0.023121, valid_loss: 0.017664
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 5, train_loss: 0.019713, valid_loss: 0.017505
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 6, train_loss: 0.019542, valid_loss: 0.017733
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 7, train_loss: 0.019484, valid_loss: 0.017627
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 8, train_loss: 0.019640, valid_loss: 0.017520
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 9, train_loss: 0.019402, valid_loss: 0.017572
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 10, train_loss: 0.019307, valid_loss: 0.017560
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 11, train_loss: 0.019237, valid_loss: 0.017582
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 12, train_loss: 0.019500, valid_loss: 0.017540
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 13, train_loss: 0.019199, valid_loss: 0.017616
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 14, train_loss: 0.019055, valid_loss: 0.017499
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 15, train_loss: 0.018892, valid_loss: 0.017564
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 16, train_loss: 0.019289, valid_loss: 0.017509
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 17, train_loss: 0.018835, valid_loss: 0.017520
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 18, train_loss: 0.018445, valid_loss: 0.017438
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 19, train_loss: 0.018116, valid_loss: 0.017416
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 20, train_loss: 0.017792, valid_loss: 0.017391
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 21, train_loss: 0.017571, valid_loss: 0.017387
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 22, train_loss: 0.017357, valid_loss: 0.017409
SEED: 3, FOLD: 3, SCORED_ONLY, EPOCH: 23, train_loss: 0.017296, valid_loss: 0.017400
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 0, train_loss: 0.497940, valid_loss: 0.020916
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 1, train_loss: 0.015302, valid_loss: 0.011286
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 2, train_loss: 0.013122, valid_loss: 0.010306
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 3, train_loss: 0.012828, valid_loss: 0.010033
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 4, train_loss: 0.013131, valid_loss: 0.010171
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 5, train_loss: 0.012746, valid_loss: 0.010090
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 6, train_loss: 0.012694, valid_loss: 0.010236
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 7, train_loss: 0.012751, valid_loss: 0.010266
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 8, train_loss: 0.012720, valid_loss: 0.010160
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 9, train_loss: 0.012706, valid_loss: 0.010230
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 10, train_loss: 0.012683, valid_loss: 0.010233
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 11, train_loss: 0.012682, valid_loss: 0.010118
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 12, train_loss: 0.012675, valid_loss: 0.010191
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 13, train_loss: 0.012649, valid_loss: 0.010037
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 14, train_loss: 0.012593, valid_loss: 0.010040
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 15, train_loss: 0.012539, valid_loss: 0.009995
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 16, train_loss: 0.012505, valid_loss: 0.009967
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 17, train_loss: 0.012397, valid_loss: 0.009898
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 18, train_loss: 0.012328, valid_loss: 0.009906
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 19, train_loss: 0.012233, valid_loss: 0.009811
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 20, train_loss: 0.012121, valid_loss: 0.009726
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 21, train_loss: 0.012016, valid_loss: 0.009694
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 22, train_loss: 0.011919, valid_loss: 0.009678
SEED: 3, FOLD: 4, ALL_TARGETS, EPOCH: 23, train_loss: 0.011867, valid_loss: 0.009672
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 0, train_loss: 0.642912, valid_loss: 0.269936
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 1, train_loss: 0.059177, valid_loss: 0.020710
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 2, train_loss: 0.020801, valid_loss: 0.018469
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 3, train_loss: 0.019756, valid_loss: 0.018201
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 4, train_loss: 0.021688, valid_loss: 0.018160
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 5, train_loss: 0.019529, valid_loss: 0.017990
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 6, train_loss: 0.019428, valid_loss: 0.018047
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 7, train_loss: 0.019327, valid_loss: 0.018236
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 8, train_loss: 0.019572, valid_loss: 0.018158
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 9, train_loss: 0.019343, valid_loss: 0.018085
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 10, train_loss: 0.019214, valid_loss: 0.018143
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 11, train_loss: 0.019093, valid_loss: 0.018107
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 12, train_loss: 0.019345, valid_loss: 0.018054
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 13, train_loss: 0.019102, valid_loss: 0.018056
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 14, train_loss: 0.018926, valid_loss: 0.018059
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 15, train_loss: 0.018770, valid_loss: 0.018018
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 16, train_loss: 0.019077, valid_loss: 0.018067
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 17, train_loss: 0.018712, valid_loss: 0.018020
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 18, train_loss: 0.018354, valid_loss: 0.018005
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 19, train_loss: 0.018049, valid_loss: 0.018016
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 20, train_loss: 0.017769, valid_loss: 0.018021
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 21, train_loss: 0.017540, valid_loss: 0.018027
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 22, train_loss: 0.017338, valid_loss: 0.018052
SEED: 3, FOLD: 4, SCORED_ONLY, EPOCH: 23, train_loss: 0.017259, valid_loss: 0.018046
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 0, train_loss: 0.494744, valid_loss: 0.021250
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 1, train_loss: 0.015419, valid_loss: 0.012746
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 2, train_loss: 0.013548, valid_loss: 0.010376
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 3, train_loss: 0.013159, valid_loss: 0.010946
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 4, train_loss: 0.013085, valid_loss: 0.010229
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 5, train_loss: 0.012927, valid_loss: 0.015199
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 6, train_loss: 0.013594, valid_loss: 0.010314
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 7, train_loss: 0.012956, valid_loss: 0.010354
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 8, train_loss: 0.012906, valid_loss: 0.010390
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 9, train_loss: 0.012911, valid_loss: 0.010026
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 10, train_loss: 0.012824, valid_loss: 0.010049
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 11, train_loss: 0.012789, valid_loss: 0.009892
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 12, train_loss: 0.012782, valid_loss: 0.009985
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 13, train_loss: 0.012771, valid_loss: 0.009839
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 14, train_loss: 0.012657, valid_loss: 0.009832
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 15, train_loss: 0.012623, valid_loss: 0.009817
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 16, train_loss: 0.012623, valid_loss: 0.009723
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 17, train_loss: 0.012547, valid_loss: 0.009705
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 18, train_loss: 0.012437, valid_loss: 0.009615
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 19, train_loss: 0.012321, valid_loss: 0.009596
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 20, train_loss: 0.012277, valid_loss: 0.009499
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 21, train_loss: 0.012175, valid_loss: 0.009487
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 22, train_loss: 0.012065, valid_loss: 0.009473
SEED: 3, FOLD: 5, ALL_TARGETS, EPOCH: 23, train_loss: 0.012039, valid_loss: 0.009461
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 0, train_loss: 0.642576, valid_loss: 0.262060
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 1, train_loss: 0.058469, valid_loss: 0.020304
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 2, train_loss: 0.021220, valid_loss: 0.018042
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 3, train_loss: 0.020331, valid_loss: 0.017770
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 4, train_loss: 0.022851, valid_loss: 0.017624
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 5, train_loss: 0.019967, valid_loss: 0.017524
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 6, train_loss: 0.019776, valid_loss: 0.017505
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 7, train_loss: 0.019673, valid_loss: 0.017525
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 8, train_loss: 0.019984, valid_loss: 0.017740
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 9, train_loss: 0.019732, valid_loss: 0.017482
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 10, train_loss: 0.019723, valid_loss: 0.017675
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 11, train_loss: 0.019548, valid_loss: 0.017554
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 12, train_loss: 0.019718, valid_loss: 0.017534
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 13, train_loss: 0.019564, valid_loss: 0.017464
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 14, train_loss: 0.019346, valid_loss: 0.017449
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 15, train_loss: 0.019320, valid_loss: 0.017516
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 16, train_loss: 0.019464, valid_loss: 0.017438
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 17, train_loss: 0.019045, valid_loss: 0.017406
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 18, train_loss: 0.018737, valid_loss: 0.017441
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 19, train_loss: 0.018639, valid_loss: 0.017415
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 20, train_loss: 0.018228, valid_loss: 0.017515
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 21, train_loss: 0.017975, valid_loss: 0.017413
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 22, train_loss: 0.017829, valid_loss: 0.017407
SEED: 3, FOLD: 5, SCORED_ONLY, EPOCH: 23, train_loss: 0.017846, valid_loss: 0.017392
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 0, train_loss: 0.494417, valid_loss: 0.020864
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 1, train_loss: 0.015428, valid_loss: 0.010272
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 2, train_loss: 0.013571, valid_loss: 0.010160
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 3, train_loss: 0.013228, valid_loss: 0.012116
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 4, train_loss: 0.013220, valid_loss: 0.009591
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 5, train_loss: 0.013138, valid_loss: 0.009839
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 6, train_loss: 0.012807, valid_loss: 0.009961
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 7, train_loss: 0.012894, valid_loss: 0.010059
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 8, train_loss: 0.012908, valid_loss: 0.009689
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 9, train_loss: 0.012821, valid_loss: 0.009495
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 10, train_loss: 0.012793, valid_loss: 0.009657
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 11, train_loss: 0.012848, valid_loss: 0.009736
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 12, train_loss: 0.012830, valid_loss: 0.009421
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 13, train_loss: 0.012791, valid_loss: 0.009498
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 14, train_loss: 0.012723, valid_loss: 0.009540
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 15, train_loss: 0.012745, valid_loss: 0.009322
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 16, train_loss: 0.012658, valid_loss: 0.009336
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 17, train_loss: 0.012569, valid_loss: 0.009352
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 18, train_loss: 0.012464, valid_loss: 0.009283
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 19, train_loss: 0.012387, valid_loss: 0.009216
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 20, train_loss: 0.012292, valid_loss: 0.009195
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 21, train_loss: 0.012214, valid_loss: 0.009125
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 22, train_loss: 0.012100, valid_loss: 0.009123
SEED: 3, FOLD: 6, ALL_TARGETS, EPOCH: 23, train_loss: 0.012045, valid_loss: 0.009094
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 0, train_loss: 0.642750, valid_loss: 0.260284
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 1, train_loss: 0.058405, valid_loss: 0.019991
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 2, train_loss: 0.021265, valid_loss: 0.017819
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 3, train_loss: 0.020205, valid_loss: 0.017449
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 4, train_loss: 0.023372, valid_loss: 0.017313
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 5, train_loss: 0.019912, valid_loss: 0.017283
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 6, train_loss: 0.019801, valid_loss: 0.017339
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 7, train_loss: 0.019677, valid_loss: 0.017196
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 8, train_loss: 0.019955, valid_loss: 0.017182
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 9, train_loss: 0.019766, valid_loss: 0.017171
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 10, train_loss: 0.019539, valid_loss: 0.017255
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 11, train_loss: 0.019420, valid_loss: 0.017378
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 12, train_loss: 0.019716, valid_loss: 0.017267
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 13, train_loss: 0.019574, valid_loss: 0.017262
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 14, train_loss: 0.019247, valid_loss: 0.017215
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 15, train_loss: 0.019236, valid_loss: 0.017248
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 16, train_loss: 0.019519, valid_loss: 0.017200
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 17, train_loss: 0.019097, valid_loss: 0.017173
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 18, train_loss: 0.018674, valid_loss: 0.017143
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 19, train_loss: 0.018461, valid_loss: 0.017111
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 20, train_loss: 0.018044, valid_loss: 0.017113
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 21, train_loss: 0.017878, valid_loss: 0.017112
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 22, train_loss: 0.017769, valid_loss: 0.017150
SEED: 3, FOLD: 6, SCORED_ONLY, EPOCH: 23, train_loss: 0.017702, valid_loss: 0.017187
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 0, train_loss: 0.495628, valid_loss: 0.019645
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 1, train_loss: 0.015502, valid_loss: 0.010747
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 2, train_loss: 0.013250, valid_loss: 0.010268
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 3, train_loss: 0.013038, valid_loss: 0.013602
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 4, train_loss: 0.013054, valid_loss: 0.010168
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 5, train_loss: 0.012813, valid_loss: 0.012709
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 6, train_loss: 0.012770, valid_loss: 0.010463
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 7, train_loss: 0.012742, valid_loss: 0.010191
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 8, train_loss: 0.012763, valid_loss: 0.010028
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 9, train_loss: 0.012714, valid_loss: 0.010229
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 10, train_loss: 0.012705, valid_loss: 0.010132
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 11, train_loss: 0.012657, valid_loss: 0.010016
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 12, train_loss: 0.012675, valid_loss: 0.010056
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 13, train_loss: 0.012651, valid_loss: 0.009920
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 14, train_loss: 0.012620, valid_loss: 0.009988
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 15, train_loss: 0.012560, valid_loss: 0.009890
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 16, train_loss: 0.012534, valid_loss: 0.009839
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 17, train_loss: 0.012423, valid_loss: 0.009765
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 18, train_loss: 0.012327, valid_loss: 0.009769
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 19, train_loss: 0.012274, valid_loss: 0.009729
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 20, train_loss: 0.012144, valid_loss: 0.009644
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 21, train_loss: 0.012026, valid_loss: 0.009582
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 22, train_loss: 0.011935, valid_loss: 0.009547
SEED: 4, FOLD: 0, ALL_TARGETS, EPOCH: 23, train_loss: 0.011882, valid_loss: 0.009558
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 0, train_loss: 0.644615, valid_loss: 0.258393
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 1, train_loss: 0.058103, valid_loss: 0.020312
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 2, train_loss: 0.020868, valid_loss: 0.018112
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 3, train_loss: 0.019853, valid_loss: 0.017857
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 4, train_loss: 0.022012, valid_loss: 0.017620
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 5, train_loss: 0.019627, valid_loss: 0.017617
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 6, train_loss: 0.019491, valid_loss: 0.017558
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 7, train_loss: 0.019334, valid_loss: 0.017689
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 8, train_loss: 0.019641, valid_loss: 0.017581
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 9, train_loss: 0.019373, valid_loss: 0.017699
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 10, train_loss: 0.019241, valid_loss: 0.017700
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 11, train_loss: 0.019156, valid_loss: 0.017626
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 12, train_loss: 0.019434, valid_loss: 0.017808
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 13, train_loss: 0.019174, valid_loss: 0.017683
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 14, train_loss: 0.018970, valid_loss: 0.017629
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 15, train_loss: 0.018813, valid_loss: 0.017654
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 16, train_loss: 0.019121, valid_loss: 0.017638
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 17, train_loss: 0.018718, valid_loss: 0.017721
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 18, train_loss: 0.018408, valid_loss: 0.017527
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 19, train_loss: 0.018062, valid_loss: 0.017650
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 20, train_loss: 0.017775, valid_loss: 0.017685
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 21, train_loss: 0.017511, valid_loss: 0.017724
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 22, train_loss: 0.017294, valid_loss: 0.017694
SEED: 4, FOLD: 0, SCORED_ONLY, EPOCH: 23, train_loss: 0.017242, valid_loss: 0.017708
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 0, train_loss: 0.496013, valid_loss: 0.031866
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 1, train_loss: 0.015829, valid_loss: 0.010802
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 2, train_loss: 0.013332, valid_loss: 0.010133
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 3, train_loss: 0.012949, valid_loss: 0.010297
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 4, train_loss: 0.012819, valid_loss: 0.009844
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 5, train_loss: 0.012843, valid_loss: 0.013152
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 6, train_loss: 0.012870, valid_loss: 0.009825
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 7, train_loss: 0.012767, valid_loss: 0.009781
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 8, train_loss: 0.012749, valid_loss: 0.009982
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 9, train_loss: 0.012749, valid_loss: 0.009716
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 10, train_loss: 0.012735, valid_loss: 0.009799
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 11, train_loss: 0.012725, valid_loss: 0.009851
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 12, train_loss: 0.012703, valid_loss: 0.009796
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 13, train_loss: 0.012701, valid_loss: 0.009762
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 14, train_loss: 0.012637, valid_loss: 0.009625
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 15, train_loss: 0.012594, valid_loss: 0.009621
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 16, train_loss: 0.012537, valid_loss: 0.009622
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 17, train_loss: 0.012462, valid_loss: 0.009622
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 18, train_loss: 0.012392, valid_loss: 0.009563
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 19, train_loss: 0.012277, valid_loss: 0.009484
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 20, train_loss: 0.012186, valid_loss: 0.009438
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 21, train_loss: 0.012080, valid_loss: 0.009376
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 22, train_loss: 0.011971, valid_loss: 0.009347
SEED: 4, FOLD: 1, ALL_TARGETS, EPOCH: 23, train_loss: 0.011920, valid_loss: 0.009316
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 0, train_loss: 0.642017, valid_loss: 0.261879
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 1, train_loss: 0.058604, valid_loss: 0.020653
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 2, train_loss: 0.020849, valid_loss: 0.018579
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 3, train_loss: 0.019825, valid_loss: 0.018258
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 4, train_loss: 0.023496, valid_loss: 0.018333
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 5, train_loss: 0.019599, valid_loss: 0.018246
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 6, train_loss: 0.019434, valid_loss: 0.018198
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 7, train_loss: 0.019307, valid_loss: 0.018092
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 8, train_loss: 0.019611, valid_loss: 0.018115
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 9, train_loss: 0.019340, valid_loss: 0.018164
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 10, train_loss: 0.019208, valid_loss: 0.018111
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 11, train_loss: 0.019113, valid_loss: 0.018256
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 12, train_loss: 0.019354, valid_loss: 0.018128
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 13, train_loss: 0.019087, valid_loss: 0.018143
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 14, train_loss: 0.018923, valid_loss: 0.018093
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 15, train_loss: 0.018773, valid_loss: 0.018079
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 16, train_loss: 0.019075, valid_loss: 0.018106
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 17, train_loss: 0.018688, valid_loss: 0.018029
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 18, train_loss: 0.018296, valid_loss: 0.018125
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 19, train_loss: 0.017940, valid_loss: 0.018024
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 20, train_loss: 0.017606, valid_loss: 0.018072
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 21, train_loss: 0.017363, valid_loss: 0.018031
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 22, train_loss: 0.017216, valid_loss: 0.017972
SEED: 4, FOLD: 1, SCORED_ONLY, EPOCH: 23, train_loss: 0.017143, valid_loss: 0.018014
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 0, train_loss: 0.497053, valid_loss: 0.020841
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 1, train_loss: 0.016141, valid_loss: 0.010033
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 2, train_loss: 0.013483, valid_loss: 0.009860
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 3, train_loss: 0.013490, valid_loss: 0.009326
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 4, train_loss: 0.012963, valid_loss: 0.009330
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 5, train_loss: 0.012941, valid_loss: 0.009352
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 6, train_loss: 0.012887, valid_loss: 0.009257
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 7, train_loss: 0.012882, valid_loss: 0.009356
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 8, train_loss: 0.012870, valid_loss: 0.009452
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 9, train_loss: 0.012850, valid_loss: 0.009617
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 10, train_loss: 0.012872, valid_loss: 0.009325
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 11, train_loss: 0.012827, valid_loss: 0.009140
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 12, train_loss: 0.012813, valid_loss: 0.009245
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 13, train_loss: 0.012793, valid_loss: 0.009146
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 14, train_loss: 0.012731, valid_loss: 0.009340
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 15, train_loss: 0.012720, valid_loss: 0.009219
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 16, train_loss: 0.012627, valid_loss: 0.009051
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 17, train_loss: 0.012581, valid_loss: 0.009018
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 18, train_loss: 0.012505, valid_loss: 0.009106
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 19, train_loss: 0.012415, valid_loss: 0.008953
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 20, train_loss: 0.012288, valid_loss: 0.008895
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 21, train_loss: 0.012187, valid_loss: 0.008852
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 22, train_loss: 0.012083, valid_loss: 0.008820
SEED: 4, FOLD: 2, ALL_TARGETS, EPOCH: 23, train_loss: 0.012034, valid_loss: 0.008808
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 0, train_loss: 0.643492, valid_loss: 0.261705
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 1, train_loss: 0.058575, valid_loss: 0.020042
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 2, train_loss: 0.020994, valid_loss: 0.017929
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 3, train_loss: 0.019980, valid_loss: 0.017465
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 4, train_loss: 0.023223, valid_loss: 0.017292
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 5, train_loss: 0.019754, valid_loss: 0.017352
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 6, train_loss: 0.019570, valid_loss: 0.017265
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 7, train_loss: 0.019502, valid_loss: 0.017249
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 8, train_loss: 0.019712, valid_loss: 0.017511
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 9, train_loss: 0.019473, valid_loss: 0.017497
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 10, train_loss: 0.019343, valid_loss: 0.017381
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 11, train_loss: 0.019294, valid_loss: 0.017355
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 12, train_loss: 0.019555, valid_loss: 0.017404
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 13, train_loss: 0.019237, valid_loss: 0.017389
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 14, train_loss: 0.019087, valid_loss: 0.017268
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 15, train_loss: 0.018982, valid_loss: 0.017374
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 16, train_loss: 0.019282, valid_loss: 0.017449
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 17, train_loss: 0.018844, valid_loss: 0.017296
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 18, train_loss: 0.018467, valid_loss: 0.017263
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 19, train_loss: 0.018144, valid_loss: 0.017247
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 20, train_loss: 0.017818, valid_loss: 0.017345
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 21, train_loss: 0.017568, valid_loss: 0.017312
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 22, train_loss: 0.017404, valid_loss: 0.017325
SEED: 4, FOLD: 2, SCORED_ONLY, EPOCH: 23, train_loss: 0.017316, valid_loss: 0.017311
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 0, train_loss: 0.495920, valid_loss: 0.022455
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 1, train_loss: 0.015583, valid_loss: 0.010506
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 2, train_loss: 0.013272, valid_loss: 0.009790
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 3, train_loss: 0.013024, valid_loss: 0.009632
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 4, train_loss: 0.012882, valid_loss: 0.009717
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 5, train_loss: 0.012925, valid_loss: 0.010366
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 6, train_loss: 0.012876, valid_loss: 0.009798
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 7, train_loss: 0.012826, valid_loss: 0.009611
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 8, train_loss: 0.012851, valid_loss: 0.009813
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 9, train_loss: 0.012780, valid_loss: 0.009698
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 10, train_loss: 0.012766, valid_loss: 0.009669
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 11, train_loss: 0.012782, valid_loss: 0.009664
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 12, train_loss: 0.012758, valid_loss: 0.009641
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 13, train_loss: 0.012704, valid_loss: 0.009594
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 14, train_loss: 0.012684, valid_loss: 0.009525
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 15, train_loss: 0.012646, valid_loss: 0.009577
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 16, train_loss: 0.012604, valid_loss: 0.009533
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 17, train_loss: 0.012517, valid_loss: 0.009432
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 18, train_loss: 0.012446, valid_loss: 0.009380
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 19, train_loss: 0.012325, valid_loss: 0.009338
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 20, train_loss: 0.012218, valid_loss: 0.009254
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 21, train_loss: 0.012108, valid_loss: 0.009234
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 22, train_loss: 0.012022, valid_loss: 0.009187
SEED: 4, FOLD: 3, ALL_TARGETS, EPOCH: 23, train_loss: 0.011962, valid_loss: 0.009202
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 0, train_loss: 0.641955, valid_loss: 0.260129
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 1, train_loss: 0.058793, valid_loss: 0.020057
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 2, train_loss: 0.021005, valid_loss: 0.017969
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 3, train_loss: 0.019952, valid_loss: 0.017556
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 4, train_loss: 0.022856, valid_loss: 0.017419
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 5, train_loss: 0.019741, valid_loss: 0.017296
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 6, train_loss: 0.019581, valid_loss: 0.017295
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 7, train_loss: 0.019465, valid_loss: 0.017334
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 8, train_loss: 0.019733, valid_loss: 0.017280
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 9, train_loss: 0.019415, valid_loss: 0.017362
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 10, train_loss: 0.019351, valid_loss: 0.017332
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 11, train_loss: 0.019257, valid_loss: 0.017320
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 12, train_loss: 0.019522, valid_loss: 0.017333
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 13, train_loss: 0.019265, valid_loss: 0.017262
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 14, train_loss: 0.019078, valid_loss: 0.017160
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 15, train_loss: 0.018985, valid_loss: 0.017177
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 16, train_loss: 0.019298, valid_loss: 0.017255
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 17, train_loss: 0.018882, valid_loss: 0.017111
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 18, train_loss: 0.018528, valid_loss: 0.017024
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 19, train_loss: 0.018174, valid_loss: 0.017106
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 20, train_loss: 0.017865, valid_loss: 0.017081
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 21, train_loss: 0.017608, valid_loss: 0.017109
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 22, train_loss: 0.017413, valid_loss: 0.017095
SEED: 4, FOLD: 3, SCORED_ONLY, EPOCH: 23, train_loss: 0.017350, valid_loss: 0.017138
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 0, train_loss: 0.498913, valid_loss: 0.023009
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 1, train_loss: 0.015427, valid_loss: 0.010297
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 2, train_loss: 0.013420, valid_loss: 0.009527
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 3, train_loss: 0.012999, valid_loss: 0.009614
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 4, train_loss: 0.012989, valid_loss: 0.009361
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 5, train_loss: 0.012869, valid_loss: 0.009333
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 6, train_loss: 0.012844, valid_loss: 0.009545
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 7, train_loss: 0.012829, valid_loss: 0.009428
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 8, train_loss: 0.012822, valid_loss: 0.009461
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 9, train_loss: 0.012795, valid_loss: 0.009520
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 10, train_loss: 0.012795, valid_loss: 0.009404
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 11, train_loss: 0.012806, valid_loss: 0.009429
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 12, train_loss: 0.012769, valid_loss: 0.009358
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 13, train_loss: 0.012728, valid_loss: 0.009321
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 14, train_loss: 0.012719, valid_loss: 0.009287
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 15, train_loss: 0.012696, valid_loss: 0.009209
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 16, train_loss: 0.012603, valid_loss: 0.009164
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 17, train_loss: 0.012541, valid_loss: 0.009173
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 18, train_loss: 0.012454, valid_loss: 0.009180
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 19, train_loss: 0.012383, valid_loss: 0.009076
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 20, train_loss: 0.012251, valid_loss: 0.009021
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 21, train_loss: 0.012143, valid_loss: 0.008986
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 22, train_loss: 0.012049, valid_loss: 0.008960
SEED: 4, FOLD: 4, ALL_TARGETS, EPOCH: 23, train_loss: 0.011992, valid_loss: 0.008957
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 0, train_loss: 0.643191, valid_loss: 0.264501
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 1, train_loss: 0.058873, valid_loss: 0.020189
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 2, train_loss: 0.020998, valid_loss: 0.017902
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 3, train_loss: 0.019953, valid_loss: 0.017491
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 4, train_loss: 0.023008, valid_loss: 0.017261
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 5, train_loss: 0.019750, valid_loss: 0.017361
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 6, train_loss: 0.019583, valid_loss: 0.017408
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 7, train_loss: 0.019476, valid_loss: 0.017321
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 8, train_loss: 0.019783, valid_loss: 0.017302
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 9, train_loss: 0.019441, valid_loss: 0.017344
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 10, train_loss: 0.019343, valid_loss: 0.017266
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 11, train_loss: 0.019223, valid_loss: 0.017229
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 12, train_loss: 0.019487, valid_loss: 0.017238
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 13, train_loss: 0.019255, valid_loss: 0.017404
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 14, train_loss: 0.019055, valid_loss: 0.017284
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 15, train_loss: 0.018943, valid_loss: 0.017244
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 16, train_loss: 0.019197, valid_loss: 0.017296
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 17, train_loss: 0.018838, valid_loss: 0.017225
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 18, train_loss: 0.018496, valid_loss: 0.017258
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 19, train_loss: 0.018178, valid_loss: 0.017284
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 20, train_loss: 0.017858, valid_loss: 0.017267
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 21, train_loss: 0.017618, valid_loss: 0.017266
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 22, train_loss: 0.017441, valid_loss: 0.017291
SEED: 4, FOLD: 4, SCORED_ONLY, EPOCH: 23, train_loss: 0.017352, valid_loss: 0.017278
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 0, train_loss: 0.497299, valid_loss: 0.021487
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 1, train_loss: 0.015567, valid_loss: 0.010122
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 2, train_loss: 0.013565, valid_loss: 0.009479
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 3, train_loss: 0.012992, valid_loss: 0.009291
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 4, train_loss: 0.012855, valid_loss: 0.009423
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 5, train_loss: 0.013220, valid_loss: 0.009338
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 6, train_loss: 0.012833, valid_loss: 0.009318
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 7, train_loss: 0.012817, valid_loss: 0.009362
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 8, train_loss: 0.012837, valid_loss: 0.009271
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 9, train_loss: 0.012829, valid_loss: 0.009258
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 10, train_loss: 0.012812, valid_loss: 0.009323
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 11, train_loss: 0.012803, valid_loss: 0.009367
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 12, train_loss: 0.012803, valid_loss: 0.009258
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 13, train_loss: 0.012769, valid_loss: 0.009298
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 14, train_loss: 0.012709, valid_loss: 0.009266
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 15, train_loss: 0.012679, valid_loss: 0.009238
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 16, train_loss: 0.012621, valid_loss: 0.009115
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 17, train_loss: 0.012560, valid_loss: 0.009167
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 18, train_loss: 0.012469, valid_loss: 0.009135
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 19, train_loss: 0.012372, valid_loss: 0.009037
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 20, train_loss: 0.012269, valid_loss: 0.009023
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 21, train_loss: 0.012159, valid_loss: 0.008927
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 22, train_loss: 0.012069, valid_loss: 0.008874
SEED: 4, FOLD: 5, ALL_TARGETS, EPOCH: 23, train_loss: 0.012006, valid_loss: 0.008875
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 0, train_loss: 0.638298, valid_loss: 0.256718
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 1, train_loss: 0.057799, valid_loss: 0.019877
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 2, train_loss: 0.021001, valid_loss: 0.017641
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 3, train_loss: 0.020017, valid_loss: 0.017386
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 4, train_loss: 0.024286, valid_loss: 0.017082
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 5, train_loss: 0.019808, valid_loss: 0.017145
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 6, train_loss: 0.019641, valid_loss: 0.017248
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 7, train_loss: 0.019566, valid_loss: 0.017100
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 8, train_loss: 0.019780, valid_loss: 0.017091
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 9, train_loss: 0.019545, valid_loss: 0.017158
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 10, train_loss: 0.019452, valid_loss: 0.017114
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 11, train_loss: 0.019366, valid_loss: 0.017146
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 12, train_loss: 0.019591, valid_loss: 0.017182
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 13, train_loss: 0.019338, valid_loss: 0.017062
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 14, train_loss: 0.019193, valid_loss: 0.017000
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 15, train_loss: 0.019018, valid_loss: 0.016982
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 16, train_loss: 0.019362, valid_loss: 0.017150
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 17, train_loss: 0.018859, valid_loss: 0.016976
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 18, train_loss: 0.018562, valid_loss: 0.017005
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 19, train_loss: 0.018230, valid_loss: 0.016997
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 20, train_loss: 0.017912, valid_loss: 0.017028
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 21, train_loss: 0.017635, valid_loss: 0.016998
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 22, train_loss: 0.017455, valid_loss: 0.017003
SEED: 4, FOLD: 5, SCORED_ONLY, EPOCH: 23, train_loss: 0.017397, valid_loss: 0.016987
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 0, train_loss: 0.498097, valid_loss: 0.019544
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 1, train_loss: 0.015368, valid_loss: 0.010856
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 2, train_loss: 0.013259, valid_loss: 0.009816
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 3, train_loss: 0.012986, valid_loss: 0.009758
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 4, train_loss: 0.012916, valid_loss: 0.009593
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 5, train_loss: 0.012860, valid_loss: 0.009833
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 6, train_loss: 0.012846, valid_loss: 0.009630
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 7, train_loss: 0.012819, valid_loss: 0.009907
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 8, train_loss: 0.012804, valid_loss: 0.009694
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 9, train_loss: 0.012770, valid_loss: 0.009739
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 10, train_loss: 0.012773, valid_loss: 0.009684
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 11, train_loss: 0.012781, valid_loss: 0.009643
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 12, train_loss: 0.012740, valid_loss: 0.009654
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 13, train_loss: 0.012726, valid_loss: 0.009557
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 14, train_loss: 0.012693, valid_loss: 0.009667
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 15, train_loss: 0.012643, valid_loss: 0.009475
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 16, train_loss: 0.012567, valid_loss: 0.009410
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 17, train_loss: 0.012500, valid_loss: 0.009376
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 18, train_loss: 0.012442, valid_loss: 0.009345
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 19, train_loss: 0.012355, valid_loss: 0.009328
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 20, train_loss: 0.012244, valid_loss: 0.009254
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 21, train_loss: 0.012139, valid_loss: 0.009223
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 22, train_loss: 0.012053, valid_loss: 0.009186
SEED: 4, FOLD: 6, ALL_TARGETS, EPOCH: 23, train_loss: 0.011997, valid_loss: 0.009185
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 0, train_loss: 0.641000, valid_loss: 0.266833
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 1, train_loss: 0.059256, valid_loss: 0.019847
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 2, train_loss: 0.021154, valid_loss: 0.017535
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 3, train_loss: 0.020166, valid_loss: 0.017355
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 4, train_loss: 0.022070, valid_loss: 0.016987
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 5, train_loss: 0.019908, valid_loss: 0.017083
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 6, train_loss: 0.019749, valid_loss: 0.016987
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 7, train_loss: 0.019653, valid_loss: 0.017070
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 8, train_loss: 0.019849, valid_loss: 0.016973
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 9, train_loss: 0.019603, valid_loss: 0.017104
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 10, train_loss: 0.019518, valid_loss: 0.017110
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 11, train_loss: 0.019425, valid_loss: 0.016979
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 12, train_loss: 0.019722, valid_loss: 0.017001
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 13, train_loss: 0.019360, valid_loss: 0.016936
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 14, train_loss: 0.019251, valid_loss: 0.016841
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 15, train_loss: 0.019114, valid_loss: 0.016984
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 16, train_loss: 0.019385, valid_loss: 0.016881
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 17, train_loss: 0.018968, valid_loss: 0.016947
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 18, train_loss: 0.018668, valid_loss: 0.016868
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 19, train_loss: 0.018340, valid_loss: 0.016883
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 20, train_loss: 0.018056, valid_loss: 0.016822
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 21, train_loss: 0.017815, valid_loss: 0.016855
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 22, train_loss: 0.017644, valid_loss: 0.016869
SEED: 4, FOLD: 6, SCORED_ONLY, EPOCH: 23, train_loss: 0.017559, valid_loss: 0.016857
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 0, train_loss: 0.495965, valid_loss: 0.022508
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 1, train_loss: 0.015680, valid_loss: 0.010205
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 2, train_loss: 0.013392, valid_loss: 0.009821
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 3, train_loss: 0.013315, valid_loss: 0.010308
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 4, train_loss: 0.013010, valid_loss: 0.009531
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 5, train_loss: 0.012875, valid_loss: 0.009440
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 6, train_loss: 0.012908, valid_loss: 0.009453
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 7, train_loss: 0.012835, valid_loss: 0.009512
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 8, train_loss: 0.012845, valid_loss: 0.009578
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 9, train_loss: 0.012836, valid_loss: 0.009632
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 10, train_loss: 0.012819, valid_loss: 0.009681
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 11, train_loss: 0.012819, valid_loss: 0.009459
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 12, train_loss: 0.012806, valid_loss: 0.009465
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 13, train_loss: 0.012761, valid_loss: 0.009347
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 14, train_loss: 0.012716, valid_loss: 0.009461
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 15, train_loss: 0.012669, valid_loss: 0.009338
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 16, train_loss: 0.012584, valid_loss: 0.009183
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 17, train_loss: 0.012555, valid_loss: 0.009223
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 18, train_loss: 0.012474, valid_loss: 0.009139
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 19, train_loss: 0.012372, valid_loss: 0.009063
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 20, train_loss: 0.012266, valid_loss: 0.009038
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 21, train_loss: 0.012160, valid_loss: 0.009010
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 22, train_loss: 0.012059, valid_loss: 0.008965
SEED: 5, FOLD: 0, ALL_TARGETS, EPOCH: 23, train_loss: 0.012010, valid_loss: 0.008966
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 0, train_loss: 0.644137, valid_loss: 0.260632
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 1, train_loss: 0.058827, valid_loss: 0.020091
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 2, train_loss: 0.021102, valid_loss: 0.017761
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 3, train_loss: 0.020042, valid_loss: 0.017450
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 4, train_loss: 0.025456, valid_loss: 0.017245
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 5, train_loss: 0.019754, valid_loss: 0.017190
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 6, train_loss: 0.019632, valid_loss: 0.017377
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 7, train_loss: 0.019511, valid_loss: 0.017243
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 8, train_loss: 0.019787, valid_loss: 0.017218
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 9, train_loss: 0.019539, valid_loss: 0.017179
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 10, train_loss: 0.019378, valid_loss: 0.017184
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 11, train_loss: 0.019321, valid_loss: 0.017180
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 12, train_loss: 0.019529, valid_loss: 0.017131
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 13, train_loss: 0.019320, valid_loss: 0.017238
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 14, train_loss: 0.019170, valid_loss: 0.017043
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 15, train_loss: 0.018986, valid_loss: 0.017031
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 16, train_loss: 0.019310, valid_loss: 0.017074
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 17, train_loss: 0.018878, valid_loss: 0.017087
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 18, train_loss: 0.018548, valid_loss: 0.017031
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 19, train_loss: 0.018204, valid_loss: 0.017095
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 20, train_loss: 0.017916, valid_loss: 0.017100
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 21, train_loss: 0.017648, valid_loss: 0.017065
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 22, train_loss: 0.017462, valid_loss: 0.017050
SEED: 5, FOLD: 0, SCORED_ONLY, EPOCH: 23, train_loss: 0.017397, valid_loss: 0.017094
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 0, train_loss: 0.495594, valid_loss: 0.019146
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 1, train_loss: 0.015803, valid_loss: 0.011113
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 2, train_loss: 0.013563, valid_loss: 0.047650
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 3, train_loss: 0.013268, valid_loss: 0.012577
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 4, train_loss: 0.013699, valid_loss: 0.009827
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 5, train_loss: 0.013109, valid_loss: 0.009649
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 6, train_loss: 0.012993, valid_loss: 0.009673
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 7, train_loss: 0.012976, valid_loss: 0.009625
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 8, train_loss: 0.012920, valid_loss: 0.009560
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 9, train_loss: 0.012934, valid_loss: 0.009552
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 10, train_loss: 0.012924, valid_loss: 0.009526
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 11, train_loss: 0.012869, valid_loss: 0.009490
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 12, train_loss: 0.012909, valid_loss: 0.009552
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 13, train_loss: 0.012966, valid_loss: 0.009431
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 14, train_loss: 0.012853, valid_loss: 0.009366
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 15, train_loss: 0.012765, valid_loss: 0.009389
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 16, train_loss: 0.012738, valid_loss: 0.009337
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 17, train_loss: 0.012642, valid_loss: 0.009233
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 18, train_loss: 0.012569, valid_loss: 0.009249
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 19, train_loss: 0.012543, valid_loss: 0.009153
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 20, train_loss: 0.012338, valid_loss: 0.009109
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 21, train_loss: 0.012258, valid_loss: 0.009023
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 22, train_loss: 0.012141, valid_loss: 0.009000
SEED: 5, FOLD: 1, ALL_TARGETS, EPOCH: 23, train_loss: 0.012083, valid_loss: 0.009003
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 0, train_loss: 0.644921, valid_loss: 0.259952
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 1, train_loss: 0.059219, valid_loss: 0.020396
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 2, train_loss: 0.021244, valid_loss: 0.018356
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 3, train_loss: 0.020186, valid_loss: 0.018132
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 4, train_loss: 0.021593, valid_loss: 0.017898
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 5, train_loss: 0.020096, valid_loss: 0.017966
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 6, train_loss: 0.019942, valid_loss: 0.017828
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 7, train_loss: 0.019950, valid_loss: 0.018051
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 8, train_loss: 0.020025, valid_loss: 0.017976
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 9, train_loss: 0.020068, valid_loss: 0.017894
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 10, train_loss: 0.019807, valid_loss: 0.017931
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 11, train_loss: 0.019817, valid_loss: 0.017849
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 12, train_loss: 0.019844, valid_loss: 0.017933
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 13, train_loss: 0.019620, valid_loss: 0.017898
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 14, train_loss: 0.019276, valid_loss: 0.017851
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 15, train_loss: 0.019299, valid_loss: 0.017840
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 16, train_loss: 0.019851, valid_loss: 0.017835
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 17, train_loss: 0.019505, valid_loss: 0.017872
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 18, train_loss: 0.019151, valid_loss: 0.017774
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 19, train_loss: 0.018761, valid_loss: 0.017759
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 20, train_loss: 0.018510, valid_loss: 0.017774
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 21, train_loss: 0.018446, valid_loss: 0.017764
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 22, train_loss: 0.018370, valid_loss: 0.017833
SEED: 5, FOLD: 1, SCORED_ONLY, EPOCH: 23, train_loss: 0.018245, valid_loss: 0.017810
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 0, train_loss: 0.494791, valid_loss: 0.021485
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 1, train_loss: 0.015826, valid_loss: 0.010389
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 2, train_loss: 0.013300, valid_loss: 0.010633
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 3, train_loss: 0.012883, valid_loss: 0.009699
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 4, train_loss: 0.013658, valid_loss: 0.010177
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 5, train_loss: 0.013028, valid_loss: 0.009806
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 6, train_loss: 0.012828, valid_loss: 0.009624
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 7, train_loss: 0.012843, valid_loss: 0.009703
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 8, train_loss: 0.012854, valid_loss: 0.009700
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 9, train_loss: 0.012851, valid_loss: 0.009936
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 10, train_loss: 0.012820, valid_loss: 0.009645
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 11, train_loss: 0.012790, valid_loss: 0.009620
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 12, train_loss: 0.012778, valid_loss: 0.009547
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 13, train_loss: 0.012762, valid_loss: 0.009664
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 14, train_loss: 0.012711, valid_loss: 0.009527
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 15, train_loss: 0.012661, valid_loss: 0.009449
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 16, train_loss: 0.012595, valid_loss: 0.009427
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 17, train_loss: 0.012528, valid_loss: 0.009426
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 18, train_loss: 0.012463, valid_loss: 0.009340
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 19, train_loss: 0.012367, valid_loss: 0.009351
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 20, train_loss: 0.012315, valid_loss: 0.009283
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 21, train_loss: 0.012169, valid_loss: 0.009175
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 22, train_loss: 0.012074, valid_loss: 0.009137
SEED: 5, FOLD: 2, ALL_TARGETS, EPOCH: 23, train_loss: 0.012032, valid_loss: 0.009166
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 0, train_loss: 0.643483, valid_loss: 0.261177
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 1, train_loss: 0.058680, valid_loss: 0.020033
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 2, train_loss: 0.021134, valid_loss: 0.017691
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 3, train_loss: 0.020050, valid_loss: 0.017383
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 4, train_loss: 0.022818, valid_loss: 0.017106
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 5, train_loss: 0.019834, valid_loss: 0.017101
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 6, train_loss: 0.019695, valid_loss: 0.016992
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 7, train_loss: 0.019604, valid_loss: 0.017099
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 8, train_loss: 0.019817, valid_loss: 0.017136
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 9, train_loss: 0.019588, valid_loss: 0.017033
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 10, train_loss: 0.019536, valid_loss: 0.017090
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 11, train_loss: 0.019407, valid_loss: 0.017056
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 12, train_loss: 0.019689, valid_loss: 0.017048
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 13, train_loss: 0.019357, valid_loss: 0.016983
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 14, train_loss: 0.019266, valid_loss: 0.017009
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 15, train_loss: 0.019082, valid_loss: 0.017000
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 16, train_loss: 0.019362, valid_loss: 0.016992
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 17, train_loss: 0.019006, valid_loss: 0.016896
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 18, train_loss: 0.018624, valid_loss: 0.016982
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 19, train_loss: 0.018311, valid_loss: 0.016999
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 20, train_loss: 0.018017, valid_loss: 0.016928
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 21, train_loss: 0.017808, valid_loss: 0.016988
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 22, train_loss: 0.017650, valid_loss: 0.016969
SEED: 5, FOLD: 2, SCORED_ONLY, EPOCH: 23, train_loss: 0.017552, valid_loss: 0.016977
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 0, train_loss: 0.496301, valid_loss: 0.043195
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 1, train_loss: 0.015636, valid_loss: 0.010903
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 2, train_loss: 0.013310, valid_loss: 0.010273
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 3, train_loss: 0.012943, valid_loss: 0.010182
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 4, train_loss: 0.012785, valid_loss: 0.010237
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 5, train_loss: 0.013320, valid_loss: 0.010259
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 6, train_loss: 0.012837, valid_loss: 0.010113
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 7, train_loss: 0.012806, valid_loss: 0.010093
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 8, train_loss: 0.012759, valid_loss: 0.010076
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 9, train_loss: 0.012756, valid_loss: 0.010237
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 10, train_loss: 0.012732, valid_loss: 0.010138
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 11, train_loss: 0.012721, valid_loss: 0.010067
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 12, train_loss: 0.012668, valid_loss: 0.010083
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 13, train_loss: 0.012662, valid_loss: 0.010037
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 14, train_loss: 0.012635, valid_loss: 0.009941
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 15, train_loss: 0.012565, valid_loss: 0.009922
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 16, train_loss: 0.012508, valid_loss: 0.009923
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 17, train_loss: 0.012442, valid_loss: 0.009872
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 18, train_loss: 0.012376, valid_loss: 0.009896
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 19, train_loss: 0.012269, valid_loss: 0.009764
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 20, train_loss: 0.012174, valid_loss: 0.009678
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 21, train_loss: 0.012060, valid_loss: 0.009637
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 22, train_loss: 0.011964, valid_loss: 0.009607
SEED: 5, FOLD: 3, ALL_TARGETS, EPOCH: 23, train_loss: 0.011915, valid_loss: 0.009603
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 0, train_loss: 0.644016, valid_loss: 0.265498
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 1, train_loss: 0.059385, valid_loss: 0.019935
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 2, train_loss: 0.020915, valid_loss: 0.017745
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 3, train_loss: 0.019926, valid_loss: 0.017429
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 4, train_loss: 0.023907, valid_loss: 0.017249
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 5, train_loss: 0.019693, valid_loss: 0.017224
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 6, train_loss: 0.019569, valid_loss: 0.017228
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 7, train_loss: 0.019556, valid_loss: 0.017152
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 8, train_loss: 0.019735, valid_loss: 0.017160
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 9, train_loss: 0.019540, valid_loss: 0.017088
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 10, train_loss: 0.019374, valid_loss: 0.017167
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 11, train_loss: 0.019341, valid_loss: 0.017177
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 12, train_loss: 0.019604, valid_loss: 0.017216
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 13, train_loss: 0.019260, valid_loss: 0.017077
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 14, train_loss: 0.019182, valid_loss: 0.017109
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 15, train_loss: 0.019003, valid_loss: 0.017037
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 16, train_loss: 0.019349, valid_loss: 0.017015
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 17, train_loss: 0.018869, valid_loss: 0.017071
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 18, train_loss: 0.018555, valid_loss: 0.017110
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 19, train_loss: 0.018204, valid_loss: 0.017080
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 20, train_loss: 0.017905, valid_loss: 0.017162
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 21, train_loss: 0.017654, valid_loss: 0.017191
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 22, train_loss: 0.017459, valid_loss: 0.017180
SEED: 5, FOLD: 3, SCORED_ONLY, EPOCH: 23, train_loss: 0.017354, valid_loss: 0.017146
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 0, train_loss: 0.493373, valid_loss: 0.021019
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 1, train_loss: 0.015472, valid_loss: 0.009974
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 2, train_loss: 0.013302, valid_loss: 0.010260
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 3, train_loss: 0.012926, valid_loss: 0.009658
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 4, train_loss: 0.013761, valid_loss: 0.009417
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 5, train_loss: 0.012882, valid_loss: 0.009352
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 6, train_loss: 0.012832, valid_loss: 0.009277
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 7, train_loss: 0.012864, valid_loss: 0.009365
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 8, train_loss: 0.012808, valid_loss: 0.009550
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 9, train_loss: 0.012837, valid_loss: 0.009445
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 10, train_loss: 0.012826, valid_loss: 0.009418
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 11, train_loss: 0.012825, valid_loss: 0.009340
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 12, train_loss: 0.012788, valid_loss: 0.009366
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 13, train_loss: 0.012763, valid_loss: 0.009331
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 14, train_loss: 0.012710, valid_loss: 0.009336
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 15, train_loss: 0.012681, valid_loss: 0.009138
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 16, train_loss: 0.012614, valid_loss: 0.009309
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 17, train_loss: 0.012554, valid_loss: 0.009180
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 18, train_loss: 0.012467, valid_loss: 0.009145
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 19, train_loss: 0.012367, valid_loss: 0.009045
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 20, train_loss: 0.012280, valid_loss: 0.008983
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 21, train_loss: 0.012142, valid_loss: 0.008968
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 22, train_loss: 0.012031, valid_loss: 0.008925
SEED: 5, FOLD: 4, ALL_TARGETS, EPOCH: 23, train_loss: 0.011992, valid_loss: 0.008909
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 0, train_loss: 0.641172, valid_loss: 0.261555
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 1, train_loss: 0.058390, valid_loss: 0.020003
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 2, train_loss: 0.020948, valid_loss: 0.017814
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 3, train_loss: 0.019951, valid_loss: 0.017500
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 4, train_loss: 0.024021, valid_loss: 0.017293
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 5, train_loss: 0.019658, valid_loss: 0.017245
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 6, train_loss: 0.019522, valid_loss: 0.017167
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 7, train_loss: 0.019450, valid_loss: 0.017225
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 8, train_loss: 0.019674, valid_loss: 0.017528
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 9, train_loss: 0.019441, valid_loss: 0.017199
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 10, train_loss: 0.019311, valid_loss: 0.017267
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 11, train_loss: 0.019238, valid_loss: 0.017171
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 12, train_loss: 0.019462, valid_loss: 0.017177
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 13, train_loss: 0.019169, valid_loss: 0.017224
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 14, train_loss: 0.019044, valid_loss: 0.017228
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 15, train_loss: 0.018907, valid_loss: 0.017207
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 16, train_loss: 0.019226, valid_loss: 0.017164
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 17, train_loss: 0.018797, valid_loss: 0.017226
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 18, train_loss: 0.018459, valid_loss: 0.017231
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 19, train_loss: 0.018107, valid_loss: 0.017158
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 20, train_loss: 0.017745, valid_loss: 0.017132
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 21, train_loss: 0.017481, valid_loss: 0.017181
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 22, train_loss: 0.017268, valid_loss: 0.017213
SEED: 5, FOLD: 4, SCORED_ONLY, EPOCH: 23, train_loss: 0.017209, valid_loss: 0.017187
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 0, train_loss: 0.497177, valid_loss: 0.022076
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 1, train_loss: 0.015701, valid_loss: 0.010587
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 2, train_loss: 0.013527, valid_loss: 0.010907
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 3, train_loss: 0.012981, valid_loss: 0.009818
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 4, train_loss: 0.012929, valid_loss: 0.009887
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 5, train_loss: 0.012727, valid_loss: 0.009819
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 6, train_loss: 0.012792, valid_loss: 0.009896
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 7, train_loss: 0.012759, valid_loss: 0.009857
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 8, train_loss: 0.012747, valid_loss: 0.009829
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 9, train_loss: 0.012723, valid_loss: 0.009888
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 10, train_loss: 0.012749, valid_loss: 0.009933
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 11, train_loss: 0.012743, valid_loss: 0.009802
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 12, train_loss: 0.012712, valid_loss: 0.009750
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 13, train_loss: 0.012663, valid_loss: 0.009846
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 14, train_loss: 0.012626, valid_loss: 0.009801
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 15, train_loss: 0.012580, valid_loss: 0.009722
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 16, train_loss: 0.012510, valid_loss: 0.009697
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 17, train_loss: 0.012468, valid_loss: 0.009659
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 18, train_loss: 0.012366, valid_loss: 0.009540
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 19, train_loss: 0.012289, valid_loss: 0.009519
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 20, train_loss: 0.012171, valid_loss: 0.009497
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 21, train_loss: 0.012076, valid_loss: 0.009436
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 22, train_loss: 0.011973, valid_loss: 0.009437
SEED: 5, FOLD: 5, ALL_TARGETS, EPOCH: 23, train_loss: 0.011922, valid_loss: 0.009426
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 0, train_loss: 0.643867, valid_loss: 0.266582
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 1, train_loss: 0.059282, valid_loss: 0.020735
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 2, train_loss: 0.020832, valid_loss: 0.018700
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 3, train_loss: 0.019811, valid_loss: 0.018348
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 4, train_loss: 0.024789, valid_loss: 0.018228
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 5, train_loss: 0.019596, valid_loss: 0.018296
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 6, train_loss: 0.019470, valid_loss: 0.018267
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 7, train_loss: 0.019338, valid_loss: 0.018157
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 8, train_loss: 0.019528, valid_loss: 0.018388
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 9, train_loss: 0.019324, valid_loss: 0.018208
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 10, train_loss: 0.019232, valid_loss: 0.018119
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 11, train_loss: 0.019130, valid_loss: 0.018134
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 12, train_loss: 0.019374, valid_loss: 0.018335
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 13, train_loss: 0.019122, valid_loss: 0.018086
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 14, train_loss: 0.018967, valid_loss: 0.018089
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 15, train_loss: 0.018852, valid_loss: 0.018100
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 16, train_loss: 0.019093, valid_loss: 0.018245
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 17, train_loss: 0.018724, valid_loss: 0.018059
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 18, train_loss: 0.018399, valid_loss: 0.018037
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 19, train_loss: 0.018047, valid_loss: 0.017973
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 20, train_loss: 0.017756, valid_loss: 0.018002
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 21, train_loss: 0.017537, valid_loss: 0.018007
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 22, train_loss: 0.017334, valid_loss: 0.018022
SEED: 5, FOLD: 5, SCORED_ONLY, EPOCH: 23, train_loss: 0.017264, valid_loss: 0.018030
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 0, train_loss: 0.497093, valid_loss: 0.042362
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 1, train_loss: 0.015607, valid_loss: 0.010234
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 2, train_loss: 0.013565, valid_loss: 0.009693
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 3, train_loss: 0.013124, valid_loss: 0.009540
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 4, train_loss: 0.012902, valid_loss: 0.009368
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 5, train_loss: 0.012968, valid_loss: 0.009481
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 6, train_loss: 0.012881, valid_loss: 0.009481
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 7, train_loss: 0.012841, valid_loss: 0.009519
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 8, train_loss: 0.012905, valid_loss: 0.009512
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 9, train_loss: 0.012856, valid_loss: 0.009429
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 10, train_loss: 0.012803, valid_loss: 0.009421
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 11, train_loss: 0.012815, valid_loss: 0.009374
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 12, train_loss: 0.012773, valid_loss: 0.009404
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 13, train_loss: 0.012780, valid_loss: 0.009396
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 14, train_loss: 0.012722, valid_loss: 0.009330
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 15, train_loss: 0.012678, valid_loss: 0.009281
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 16, train_loss: 0.012613, valid_loss: 0.009322
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 17, train_loss: 0.012536, valid_loss: 0.009157
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 18, train_loss: 0.012459, valid_loss: 0.009078
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 19, train_loss: 0.012357, valid_loss: 0.009126
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 20, train_loss: 0.012259, valid_loss: 0.009018
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 21, train_loss: 0.012145, valid_loss: 0.009007
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 22, train_loss: 0.012046, valid_loss: 0.008980
SEED: 5, FOLD: 6, ALL_TARGETS, EPOCH: 23, train_loss: 0.011990, valid_loss: 0.008967
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 0, train_loss: 0.643776, valid_loss: 0.262048
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 1, train_loss: 0.058914, valid_loss: 0.019968
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 2, train_loss: 0.021082, valid_loss: 0.017800
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 3, train_loss: 0.019964, valid_loss: 0.017410
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 4, train_loss: 0.025323, valid_loss: 0.017214
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 5, train_loss: 0.019723, valid_loss: 0.017328
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 6, train_loss: 0.019534, valid_loss: 0.017319
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 7, train_loss: 0.019449, valid_loss: 0.017291
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 8, train_loss: 0.019702, valid_loss: 0.017281
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 9, train_loss: 0.019454, valid_loss: 0.017390
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 10, train_loss: 0.019379, valid_loss: 0.017222
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 11, train_loss: 0.019304, valid_loss: 0.017293
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 12, train_loss: 0.019537, valid_loss: 0.017291
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 13, train_loss: 0.019277, valid_loss: 0.017226
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 14, train_loss: 0.019116, valid_loss: 0.017322
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 15, train_loss: 0.018958, valid_loss: 0.017205
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 16, train_loss: 0.019285, valid_loss: 0.017171
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 17, train_loss: 0.018898, valid_loss: 0.017121
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 18, train_loss: 0.018469, valid_loss: 0.017228
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 19, train_loss: 0.018163, valid_loss: 0.017301
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 20, train_loss: 0.017884, valid_loss: 0.017257
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 21, train_loss: 0.017607, valid_loss: 0.017329
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 22, train_loss: 0.017406, valid_loss: 0.017287
SEED: 5, FOLD: 6, SCORED_ONLY, EPOCH: 23, train_loss: 0.017357, valid_loss: 0.017324
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 0, train_loss: 0.497819, valid_loss: 0.021606
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 1, train_loss: 0.015653, valid_loss: 0.010613
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 2, train_loss: 0.013326, valid_loss: 0.009956
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 3, train_loss: 0.012908, valid_loss: 0.009876
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 4, train_loss: 0.012942, valid_loss: 0.009915
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 5, train_loss: 0.013071, valid_loss: 0.009829
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 6, train_loss: 0.012839, valid_loss: 0.009755
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 7, train_loss: 0.012817, valid_loss: 0.009820
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 8, train_loss: 0.012778, valid_loss: 0.009791
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 9, train_loss: 0.012787, valid_loss: 0.009813
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 10, train_loss: 0.012775, valid_loss: 0.009798
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 11, train_loss: 0.012755, valid_loss: 0.009968
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 12, train_loss: 0.012720, valid_loss: 0.009713
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 13, train_loss: 0.012712, valid_loss: 0.009699
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 14, train_loss: 0.012675, valid_loss: 0.009705
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 15, train_loss: 0.012622, valid_loss: 0.009666
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 16, train_loss: 0.012556, valid_loss: 0.009613
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 17, train_loss: 0.012506, valid_loss: 0.009600
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 18, train_loss: 0.012410, valid_loss: 0.009500
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 19, train_loss: 0.012325, valid_loss: 0.009459
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 20, train_loss: 0.012218, valid_loss: 0.009388
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 21, train_loss: 0.012100, valid_loss: 0.009360
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 22, train_loss: 0.012000, valid_loss: 0.009335
SEED: 6, FOLD: 0, ALL_TARGETS, EPOCH: 23, train_loss: 0.011950, valid_loss: 0.009324
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 0, train_loss: 0.642373, valid_loss: 0.262213
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 1, train_loss: 0.058519, valid_loss: 0.020179
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 2, train_loss: 0.020932, valid_loss: 0.018006
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 3, train_loss: 0.019891, valid_loss: 0.017772
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 4, train_loss: 0.021961, valid_loss: 0.017519
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 5, train_loss: 0.019685, valid_loss: 0.017545
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 6, train_loss: 0.019498, valid_loss: 0.017552
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 7, train_loss: 0.019429, valid_loss: 0.017524
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 8, train_loss: 0.019615, valid_loss: 0.017541
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 9, train_loss: 0.019406, valid_loss: 0.017727
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 10, train_loss: 0.019264, valid_loss: 0.017674
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 11, train_loss: 0.019145, valid_loss: 0.017651
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 12, train_loss: 0.019386, valid_loss: 0.017396
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 13, train_loss: 0.019142, valid_loss: 0.017536
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 14, train_loss: 0.018946, valid_loss: 0.017472
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 15, train_loss: 0.018821, valid_loss: 0.017480
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 16, train_loss: 0.019134, valid_loss: 0.017751
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 17, train_loss: 0.018703, valid_loss: 0.017580
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 18, train_loss: 0.018350, valid_loss: 0.017600
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 19, train_loss: 0.017978, valid_loss: 0.017571
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 20, train_loss: 0.017637, valid_loss: 0.017598
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 21, train_loss: 0.017357, valid_loss: 0.017588
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 22, train_loss: 0.017178, valid_loss: 0.017593
SEED: 6, FOLD: 0, SCORED_ONLY, EPOCH: 23, train_loss: 0.017089, valid_loss: 0.017602
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 0, train_loss: 0.498202, valid_loss: 0.022744
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 1, train_loss: 0.015351, valid_loss: 0.010375
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 2, train_loss: 0.013312, valid_loss: 0.010334
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 3, train_loss: 0.013198, valid_loss: 0.009568
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 4, train_loss: 0.012826, valid_loss: 0.009509
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 5, train_loss: 0.012835, valid_loss: 0.009524
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 6, train_loss: 0.012834, valid_loss: 0.009484
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 7, train_loss: 0.012854, valid_loss: 0.009583
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 8, train_loss: 0.012839, valid_loss: 0.009660
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 9, train_loss: 0.012821, valid_loss: 0.009531
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 10, train_loss: 0.012804, valid_loss: 0.009592
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 11, train_loss: 0.012801, valid_loss: 0.009524
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 12, train_loss: 0.012779, valid_loss: 0.009534
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 13, train_loss: 0.012731, valid_loss: 0.009398
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 14, train_loss: 0.012716, valid_loss: 0.009563
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 15, train_loss: 0.012667, valid_loss: 0.009325
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 16, train_loss: 0.012605, valid_loss: 0.009359
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 17, train_loss: 0.012530, valid_loss: 0.009356
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 18, train_loss: 0.012433, valid_loss: 0.009231
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 19, train_loss: 0.012339, valid_loss: 0.009162
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 20, train_loss: 0.012249, valid_loss: 0.009118
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 21, train_loss: 0.012127, valid_loss: 0.009024
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 22, train_loss: 0.012023, valid_loss: 0.009039
SEED: 6, FOLD: 1, ALL_TARGETS, EPOCH: 23, train_loss: 0.011974, valid_loss: 0.009018
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 0, train_loss: 0.639095, valid_loss: 0.261421
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 1, train_loss: 0.058627, valid_loss: 0.020335
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 2, train_loss: 0.020851, valid_loss: 0.018181
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 3, train_loss: 0.019885, valid_loss: 0.017930
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 4, train_loss: 0.021458, valid_loss: 0.017755
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 5, train_loss: 0.019594, valid_loss: 0.017682
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 6, train_loss: 0.019481, valid_loss: 0.017596
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 7, train_loss: 0.019453, valid_loss: 0.017621
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 8, train_loss: 0.019643, valid_loss: 0.017574
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 9, train_loss: 0.019389, valid_loss: 0.017786
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 10, train_loss: 0.019273, valid_loss: 0.017526
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 11, train_loss: 0.019151, valid_loss: 0.017463
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 12, train_loss: 0.019418, valid_loss: 0.017697
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 13, train_loss: 0.019128, valid_loss: 0.017548
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 14, train_loss: 0.018987, valid_loss: 0.017598
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 15, train_loss: 0.018867, valid_loss: 0.017497
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 16, train_loss: 0.019186, valid_loss: 0.017582
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 17, train_loss: 0.018702, valid_loss: 0.017566
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 18, train_loss: 0.018391, valid_loss: 0.017453
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 19, train_loss: 0.018052, valid_loss: 0.017493
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 20, train_loss: 0.017774, valid_loss: 0.017487
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 21, train_loss: 0.017505, valid_loss: 0.017498
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 22, train_loss: 0.017337, valid_loss: 0.017470
SEED: 6, FOLD: 1, SCORED_ONLY, EPOCH: 23, train_loss: 0.017252, valid_loss: 0.017502
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 0, train_loss: 0.497485, valid_loss: 0.022218
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 1, train_loss: 0.015439, valid_loss: 0.010281
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 2, train_loss: 0.013198, valid_loss: 0.009683
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 3, train_loss: 0.012927, valid_loss: 0.009658
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 4, train_loss: 0.013257, valid_loss: 0.009707
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 5, train_loss: 0.012932, valid_loss: 0.009895
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 6, train_loss: 0.013137, valid_loss: 0.009612
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 7, train_loss: 0.012858, valid_loss: 0.009590
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 8, train_loss: 0.012879, valid_loss: 0.009485
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 9, train_loss: 0.012829, valid_loss: 0.009489
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 10, train_loss: 0.012807, valid_loss: 0.009490
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 11, train_loss: 0.012803, valid_loss: 0.009525
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 12, train_loss: 0.012798, valid_loss: 0.009454
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 13, train_loss: 0.012767, valid_loss: 0.009517
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 14, train_loss: 0.012723, valid_loss: 0.009536
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 15, train_loss: 0.012711, valid_loss: 0.009407
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 16, train_loss: 0.012602, valid_loss: 0.009332
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 17, train_loss: 0.012561, valid_loss: 0.009271
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 18, train_loss: 0.012484, valid_loss: 0.009193
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 19, train_loss: 0.012386, valid_loss: 0.009170
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 20, train_loss: 0.012272, valid_loss: 0.009087
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 21, train_loss: 0.012170, valid_loss: 0.009027
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 22, train_loss: 0.012078, valid_loss: 0.009003
SEED: 6, FOLD: 2, ALL_TARGETS, EPOCH: 23, train_loss: 0.012032, valid_loss: 0.009000
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 0, train_loss: 0.642322, valid_loss: 0.264483
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 1, train_loss: 0.059018, valid_loss: 0.019872
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 2, train_loss: 0.021026, valid_loss: 0.017643
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 3, train_loss: 0.020032, valid_loss: 0.017148
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 4, train_loss: 0.021920, valid_loss: 0.016914
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 5, train_loss: 0.019809, valid_loss: 0.017000
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 6, train_loss: 0.019693, valid_loss: 0.016979
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 7, train_loss: 0.019586, valid_loss: 0.016869
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 8, train_loss: 0.019870, valid_loss: 0.017220
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 9, train_loss: 0.019652, valid_loss: 0.016867
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 10, train_loss: 0.019431, valid_loss: 0.016894
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 11, train_loss: 0.019362, valid_loss: 0.016871
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 12, train_loss: 0.019642, valid_loss: 0.016912
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 13, train_loss: 0.019344, valid_loss: 0.016920
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 14, train_loss: 0.019187, valid_loss: 0.016933
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 15, train_loss: 0.019042, valid_loss: 0.016859
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 16, train_loss: 0.019348, valid_loss: 0.016882
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 17, train_loss: 0.018952, valid_loss: 0.016763
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 18, train_loss: 0.018611, valid_loss: 0.016745
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 19, train_loss: 0.018255, valid_loss: 0.016734
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 20, train_loss: 0.017984, valid_loss: 0.016788
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 21, train_loss: 0.017705, valid_loss: 0.016791
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 22, train_loss: 0.017537, valid_loss: 0.016817
SEED: 6, FOLD: 2, SCORED_ONLY, EPOCH: 23, train_loss: 0.017440, valid_loss: 0.016806
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 0, train_loss: 0.495982, valid_loss: 0.020813
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 1, train_loss: 0.015546, valid_loss: 0.010092
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 2, train_loss: 0.013328, valid_loss: 0.009609
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 3, train_loss: 0.012967, valid_loss: 0.009415
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 4, train_loss: 0.013113, valid_loss: 0.009346
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 5, train_loss: 0.012853, valid_loss: 0.009464
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 6, train_loss: 0.012845, valid_loss: 0.009518
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 7, train_loss: 0.012830, valid_loss: 0.009528
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 8, train_loss: 0.012829, valid_loss: 0.009440
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 9, train_loss: 0.012837, valid_loss: 0.009436
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 10, train_loss: 0.012824, valid_loss: 0.009547
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 11, train_loss: 0.012810, valid_loss: 0.009447
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 12, train_loss: 0.012785, valid_loss: 0.009334
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 13, train_loss: 0.012773, valid_loss: 0.009415
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 14, train_loss: 0.012734, valid_loss: 0.009326
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 15, train_loss: 0.012686, valid_loss: 0.009298
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 16, train_loss: 0.012634, valid_loss: 0.009325
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 17, train_loss: 0.012573, valid_loss: 0.009251
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 18, train_loss: 0.012480, valid_loss: 0.009173
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 19, train_loss: 0.012383, valid_loss: 0.009120
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 20, train_loss: 0.012276, valid_loss: 0.009122
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 21, train_loss: 0.012161, valid_loss: 0.009031
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 22, train_loss: 0.012067, valid_loss: 0.009018
SEED: 6, FOLD: 3, ALL_TARGETS, EPOCH: 23, train_loss: 0.012010, valid_loss: 0.009002
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 0, train_loss: 0.640732, valid_loss: 0.264290
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 1, train_loss: 0.058763, valid_loss: 0.020174
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 2, train_loss: 0.020867, valid_loss: 0.017937
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 3, train_loss: 0.019908, valid_loss: 0.017662
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 4, train_loss: 0.021764, valid_loss: 0.017774
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 5, train_loss: 0.019740, valid_loss: 0.017451
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 6, train_loss: 0.019550, valid_loss: 0.017469
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 7, train_loss: 0.019468, valid_loss: 0.017455
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 8, train_loss: 0.019689, valid_loss: 0.017520
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 9, train_loss: 0.019478, valid_loss: 0.017496
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 10, train_loss: 0.019361, valid_loss: 0.017368
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 11, train_loss: 0.019231, valid_loss: 0.017410
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 12, train_loss: 0.019526, valid_loss: 0.017469
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 13, train_loss: 0.019287, valid_loss: 0.017437
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 14, train_loss: 0.019119, valid_loss: 0.017454
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 15, train_loss: 0.018952, valid_loss: 0.017391
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 16, train_loss: 0.019287, valid_loss: 0.017502
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 17, train_loss: 0.018868, valid_loss: 0.017391
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 18, train_loss: 0.018472, valid_loss: 0.017465
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 19, train_loss: 0.018174, valid_loss: 0.017496
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 20, train_loss: 0.017826, valid_loss: 0.017479
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 21, train_loss: 0.017554, valid_loss: 0.017508
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 22, train_loss: 0.017365, valid_loss: 0.017545
SEED: 6, FOLD: 3, SCORED_ONLY, EPOCH: 23, train_loss: 0.017315, valid_loss: 0.017540
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 0, train_loss: 0.495104, valid_loss: 0.056255
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 1, train_loss: 0.015644, valid_loss: 0.012116
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 2, train_loss: 0.013280, valid_loss: 0.010062
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 3, train_loss: 0.014183, valid_loss: 0.010970
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 4, train_loss: 0.013325, valid_loss: 0.010289
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 5, train_loss: 0.012932, valid_loss: 0.010058
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 6, train_loss: 0.012854, valid_loss: 0.010037
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 7, train_loss: 0.012882, valid_loss: 0.010334
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 8, train_loss: 0.012867, valid_loss: 0.011336
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 9, train_loss: 0.012870, valid_loss: 0.010213
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 10, train_loss: 0.012819, valid_loss: 0.009991
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 11, train_loss: 0.012784, valid_loss: 0.009916
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 12, train_loss: 0.012734, valid_loss: 0.009873
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 13, train_loss: 0.012718, valid_loss: 0.009933
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 14, train_loss: 0.012684, valid_loss: 0.009736
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 15, train_loss: 0.012581, valid_loss: 0.009767
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 16, train_loss: 0.012582, valid_loss: 0.009886
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 17, train_loss: 0.012536, valid_loss: 0.009766
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 18, train_loss: 0.012546, valid_loss: 0.009601
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 19, train_loss: 0.012337, valid_loss: 0.009596
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 20, train_loss: 0.012242, valid_loss: 0.009521
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 21, train_loss: 0.012113, valid_loss: 0.009480
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 22, train_loss: 0.012025, valid_loss: 0.009460
SEED: 6, FOLD: 4, ALL_TARGETS, EPOCH: 23, train_loss: 0.011965, valid_loss: 0.009481
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 0, train_loss: 0.643752, valid_loss: 0.257377
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 1, train_loss: 0.057892, valid_loss: 0.020389
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 2, train_loss: 0.021096, valid_loss: 0.018415
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 3, train_loss: 0.020126, valid_loss: 0.018106
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 4, train_loss: 0.022855, valid_loss: 0.017891
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 5, train_loss: 0.019785, valid_loss: 0.017865
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 6, train_loss: 0.019722, valid_loss: 0.017874
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 7, train_loss: 0.019667, valid_loss: 0.017911
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 8, train_loss: 0.019885, valid_loss: 0.018141
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 9, train_loss: 0.019768, valid_loss: 0.017950
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 10, train_loss: 0.019479, valid_loss: 0.017850
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 11, train_loss: 0.019465, valid_loss: 0.017752
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 12, train_loss: 0.019617, valid_loss: 0.017794
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 13, train_loss: 0.019357, valid_loss: 0.017820
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 14, train_loss: 0.019258, valid_loss: 0.017746
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 15, train_loss: 0.019088, valid_loss: 0.017877
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 16, train_loss: 0.019366, valid_loss: 0.017777
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 17, train_loss: 0.018910, valid_loss: 0.017761
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 18, train_loss: 0.018612, valid_loss: 0.017734
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 19, train_loss: 0.018357, valid_loss: 0.017728
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 20, train_loss: 0.018120, valid_loss: 0.017784
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 21, train_loss: 0.017849, valid_loss: 0.017713
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 22, train_loss: 0.017641, valid_loss: 0.017731
SEED: 6, FOLD: 4, SCORED_ONLY, EPOCH: 23, train_loss: 0.017695, valid_loss: 0.017742
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 0, train_loss: 0.494438, valid_loss: 0.019997
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 1, train_loss: 0.015430, valid_loss: 0.010454
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 2, train_loss: 0.013532, valid_loss: 0.010670
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 3, train_loss: 0.013354, valid_loss: 0.010052
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 4, train_loss: 0.012896, valid_loss: 0.009898
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 5, train_loss: 0.013262, valid_loss: 0.009868
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 6, train_loss: 0.012767, valid_loss: 0.010003
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 7, train_loss: 0.012799, valid_loss: 0.009898
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 8, train_loss: 0.012771, valid_loss: 0.009956
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 9, train_loss: 0.012777, valid_loss: 0.009916
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 10, train_loss: 0.012755, valid_loss: 0.010017
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 11, train_loss: 0.012727, valid_loss: 0.010101
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 12, train_loss: 0.012730, valid_loss: 0.009884
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 13, train_loss: 0.012678, valid_loss: 0.009911
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 14, train_loss: 0.012659, valid_loss: 0.009884
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 15, train_loss: 0.012607, valid_loss: 0.009770
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 16, train_loss: 0.012536, valid_loss: 0.009846
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 17, train_loss: 0.012475, valid_loss: 0.009634
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 18, train_loss: 0.012391, valid_loss: 0.009656
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 19, train_loss: 0.012283, valid_loss: 0.009572
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 20, train_loss: 0.012201, valid_loss: 0.009524
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 21, train_loss: 0.012096, valid_loss: 0.009502
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 22, train_loss: 0.012006, valid_loss: 0.009461
SEED: 6, FOLD: 5, ALL_TARGETS, EPOCH: 23, train_loss: 0.011938, valid_loss: 0.009479
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 0, train_loss: 0.643252, valid_loss: 0.259941
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 1, train_loss: 0.058139, valid_loss: 0.020269
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 2, train_loss: 0.021039, valid_loss: 0.017864
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 3, train_loss: 0.020078, valid_loss: 0.017640
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 4, train_loss: 0.023459, valid_loss: 0.017909
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 5, train_loss: 0.019915, valid_loss: 0.017392
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 6, train_loss: 0.019685, valid_loss: 0.017458
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 7, train_loss: 0.019563, valid_loss: 0.017416
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 8, train_loss: 0.019803, valid_loss: 0.017434
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 9, train_loss: 0.019512, valid_loss: 0.017540
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 10, train_loss: 0.019459, valid_loss: 0.017353
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 11, train_loss: 0.019357, valid_loss: 0.017389
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 12, train_loss: 0.019602, valid_loss: 0.017568
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 13, train_loss: 0.019353, valid_loss: 0.017417
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 14, train_loss: 0.019185, valid_loss: 0.017421
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 15, train_loss: 0.019047, valid_loss: 0.017424
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 16, train_loss: 0.019332, valid_loss: 0.017537
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 17, train_loss: 0.018873, valid_loss: 0.017447
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 18, train_loss: 0.018570, valid_loss: 0.017392
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 19, train_loss: 0.018223, valid_loss: 0.017357
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 20, train_loss: 0.017907, valid_loss: 0.017391
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 21, train_loss: 0.017637, valid_loss: 0.017416
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 22, train_loss: 0.017463, valid_loss: 0.017452
SEED: 6, FOLD: 5, SCORED_ONLY, EPOCH: 23, train_loss: 0.017438, valid_loss: 0.017408
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 0, train_loss: 0.495617, valid_loss: 0.021106
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 1, train_loss: 0.015585, valid_loss: 0.010003
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 2, train_loss: 0.013411, valid_loss: 0.009500
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 3, train_loss: 0.014167, valid_loss: 0.011785
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 4, train_loss: 0.013695, valid_loss: 0.009436
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 5, train_loss: 0.013169, valid_loss: 0.009403
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 6, train_loss: 0.013065, valid_loss: 0.009258
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 7, train_loss: 0.012991, valid_loss: 0.009311
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 8, train_loss: 0.012983, valid_loss: 0.009204
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 9, train_loss: 0.012930, valid_loss: 0.009163
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 10, train_loss: 0.012920, valid_loss: 0.009222
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 11, train_loss: 0.012904, valid_loss: 0.009293
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 12, train_loss: 0.012861, valid_loss: 0.009312
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 13, train_loss: 0.012819, valid_loss: 0.009158
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 14, train_loss: 0.012759, valid_loss: 0.009077
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 15, train_loss: 0.012704, valid_loss: 0.009168
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 16, train_loss: 0.012659, valid_loss: 0.009052
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 17, train_loss: 0.012591, valid_loss: 0.009045
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 18, train_loss: 0.012498, valid_loss: 0.008944
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 19, train_loss: 0.012395, valid_loss: 0.008930
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 20, train_loss: 0.012296, valid_loss: 0.008877
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 21, train_loss: 0.012181, valid_loss: 0.008820
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 22, train_loss: 0.012087, valid_loss: 0.008784
SEED: 6, FOLD: 6, ALL_TARGETS, EPOCH: 23, train_loss: 0.012024, valid_loss: 0.008794
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 0, train_loss: 0.643984, valid_loss: 0.260074
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 1, train_loss: 0.058708, valid_loss: 0.020089
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 2, train_loss: 0.020987, valid_loss: 0.017758
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 3, train_loss: 0.019998, valid_loss: 0.017380
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 4, train_loss: 0.024210, valid_loss: 0.017289
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 5, train_loss: 0.019693, valid_loss: 0.017163
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 6, train_loss: 0.019603, valid_loss: 0.017059
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 7, train_loss: 0.019537, valid_loss: 0.017161
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 8, train_loss: 0.019710, valid_loss: 0.017123
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 9, train_loss: 0.019514, valid_loss: 0.017001
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 10, train_loss: 0.019369, valid_loss: 0.017054
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 11, train_loss: 0.019303, valid_loss: 0.017087
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 12, train_loss: 0.019580, valid_loss: 0.017102
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 13, train_loss: 0.019255, valid_loss: 0.017070
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 14, train_loss: 0.019125, valid_loss: 0.017166
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 15, train_loss: 0.018960, valid_loss: 0.017058
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 16, train_loss: 0.019371, valid_loss: 0.016992
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 17, train_loss: 0.018881, valid_loss: 0.017005
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 18, train_loss: 0.018560, valid_loss: 0.016865
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 19, train_loss: 0.018160, valid_loss: 0.016876
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 20, train_loss: 0.017810, valid_loss: 0.016851
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 21, train_loss: 0.017524, valid_loss: 0.016907
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 22, train_loss: 0.017345, valid_loss: 0.016917
SEED: 6, FOLD: 6, SCORED_ONLY, EPOCH: 23, train_loss: 0.017301, valid_loss: 0.016901
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">timedelta</span>
<span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">time_diff</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[41]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#39;1:11:30.610859&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_targets_scored</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[42]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sig_id</th>
      <th>5-alpha_reductase_inhibitor</th>
      <th>11-beta-hsd1_inhibitor</th>
      <th>acat_inhibitor</th>
      <th>acetylcholine_receptor_agonist</th>
      <th>acetylcholine_receptor_antagonist</th>
      <th>acetylcholinesterase_inhibitor</th>
      <th>adenosine_receptor_agonist</th>
      <th>adenosine_receptor_antagonist</th>
      <th>adenylyl_cyclase_activator</th>
      <th>...</th>
      <th>tropomyosin_receptor_kinase_inhibitor</th>
      <th>trpv_agonist</th>
      <th>trpv_antagonist</th>
      <th>tubulin_inhibitor</th>
      <th>tyrosine_kinase_inhibitor</th>
      <th>ubiquitin_specific_protease_inhibitor</th>
      <th>vegfr_inhibitor</th>
      <th>vitamin_b</th>
      <th>vitamin_d_receptor_agonist</th>
      <th>wnt_inhibitor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id_000644bb2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id_000779bfc</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id_000a6266a</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id_0015fd391</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id_001626bd3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows  207 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[43]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">target_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[43]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>206</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[44]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">valid_results</span> <span class="o">=</span> <span class="n">train_targets_scored</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">target_cols</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">train</span><span class="p">[[</span><span class="s1">&#39;sig_id&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">target_cols</span><span class="p">],</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;sig_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">y_true</span> <span class="o">=</span> <span class="n">train_targets_scored</span><span class="p">[</span><span class="n">target_cols</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">valid_results</span><span class="p">[</span><span class="n">target_cols</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">target_cols</span><span class="p">)):</span>
    <span class="n">score</span> <span class="o">+=</span> <span class="n">log_loss</span><span class="p">(</span><span class="n">y_true</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CV log_loss: &quot;</span><span class="p">,</span> <span class="n">score</span> <span class="o">/</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>CV log_loss:  0.01562060391771847
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The log loss score for model 1 is  0.01562060391771847.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[45]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sub1</span> <span class="o">=</span> <span class="n">sample_submission</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">target_cols</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">test</span><span class="p">[[</span><span class="s1">&#39;sig_id&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">target_cols</span><span class="p">],</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;sig_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[46]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="err">!</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">../</span><span class="nb">input</span><span class="o">/</span><span class="n">pytorch16gpu</span><span class="o">/</span><span class="n">torch</span><span class="o">-</span><span class="mf">1.6</span><span class="o">.</span><span class="mi">0</span><span class="n">cu101</span><span class="o">-</span><span class="n">cp37</span><span class="o">-</span><span class="n">cp37m</span><span class="o">-</span><span class="n">linux_x86_64</span><span class="o">.</span><span class="n">whl</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Processing /kaggle/input/pytorch16gpu/torch-1.6.0cu101-cp37-cp37m-linux_x86_64.whl
Requirement already satisfied: numpy in /opt/conda/lib/python3.7/site-packages (from torch==1.6.0cu101) (1.18.5)
Requirement already satisfied: future in /opt/conda/lib/python3.7/site-packages (from torch==1.6.0cu101) (0.18.2)
Installing collected packages: torch
  Attempting uninstall: torch
    Found existing installation: torch 1.5.1
    Uninstalling torch-1.5.1:
      Successfully uninstalled torch-1.5.1
<span class="ansi-red-fg">ERROR: After October 2020 you may experience errors when installing or updating packages. This is because pip will change the way that it resolves dependency conflicts.

We recommend you use --use-feature=2020-resolver to test your packages with the new resolver before it becomes the default.

kornia 0.3.2 requires torch&lt;1.6.0,&gt;=1.5.0, but you&#39;ll have torch 1.6.0+cu101 which is incompatible.
allennlp 1.0.0 requires torch&lt;1.6.0,&gt;=1.5.0, but you&#39;ll have torch 1.6.0+cu101 which is incompatible.</span>
Successfully installed torch-1.6.0+cu101
<span class="ansi-yellow-fg">WARNING: You are using pip version 20.2.2; however, version 20.3.3 is available.
You should consider upgrading via the &#39;/opt/conda/bin/python3.7 -m pip install --upgrade pip&#39; command.</span>
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[47]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="o">../</span><span class="nb">input</span><span class="o">/</span><span class="n">iterative</span><span class="o">-</span><span class="n">stratification</span><span class="o">-</span><span class="n">tabnet</span><span class="o">/</span><span class="n">iterative_stratification</span><span class="o">-</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">6</span><span class="o">-</span><span class="n">py3</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="nb">any</span><span class="o">.</span><span class="n">whl</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Requirement already satisfied: iterative-stratification==0.1.6 from file:///kaggle/input/iterative-stratification-tabnet/iterative_stratification-0.1.6-py3-none-any.whl in /opt/conda/lib/python3.7/site-packages (0.1.6)
Requirement already satisfied: scikit-learn in /opt/conda/lib/python3.7/site-packages (from iterative-stratification==0.1.6) (0.23.2)
Requirement already satisfied: numpy in /opt/conda/lib/python3.7/site-packages (from iterative-stratification==0.1.6) (1.18.5)
Requirement already satisfied: scipy in /opt/conda/lib/python3.7/site-packages (from iterative-stratification==0.1.6) (1.4.1)
Requirement already satisfied: joblib&gt;=0.11 in /opt/conda/lib/python3.7/site-packages (from scikit-learn-&gt;iterative-stratification==0.1.6) (0.14.1)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /opt/conda/lib/python3.7/site-packages (from scikit-learn-&gt;iterative-stratification==0.1.6) (2.1.0)
<span class="ansi-yellow-fg">WARNING: You are using pip version 20.2.2; however, version 20.3.3 is available.
You should consider upgrading via the &#39;/opt/conda/bin/python3.7 -m pip install --upgrade pip&#39; command.</span>
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now I start to work on the second model and train on multiple fold. The basic idea is the same as the first model (with rank gaussian function added and feature statistics recombination, and parameters tuned.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><p>In the fit() function, a neural network stored in self.network is trained using train_dataloader for training data and valid_dataloader for validation. Parameter weight determines no balancing (0) / balancing (1).</p>
</li>
<li><p>In fit_epoch(), network is evaluated and updated for one epoch.</p>
</li>
<li><p>Three abstract methods, train_epoch, train_batch, predict_epoch are added in. In train_epoch, one epoch of the network in self.network is trained; In train_batch, one batch of data is trained.</p>
</li>
<li><p>In predict_epoch, one epoch of the network in self.network is validated; In predict batch, predictions are made on a every valid batch.</p>
</li>
<li><p>In the class defined as Tabnet regressor, a list of weight is provided. Training and validation dataloaders are returned as torch.DataLoader, torch.DataLoader.</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;../input/tabnetdevelop/tabnet-develop&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[49]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="k">import</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">Dataset</span>
<span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">RobustScaler</span>
<span class="kn">from</span> <span class="nn">torch.optim.lr_scheduler</span> <span class="k">import</span> <span class="n">ReduceLROnPlateau</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">StratifiedKFold</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">StandardScaler</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">QuantileTransformer</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_LAUNCH_BLOCKING&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="k">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">log_loss</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[50]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../input/lish-moa/train_features.csv&#39;</span><span class="p">)</span>
<span class="n">train_targets_scored</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../input/lish-moa/train_targets_scored.csv&#39;</span><span class="p">)</span>
<span class="n">train_targets_nonscored</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../input/lish-moa/train_targets_nonscored.csv&#39;</span><span class="p">)</span>

<span class="n">test_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../input/lish-moa/test_features.csv&#39;</span><span class="p">)</span>
<span class="n">submission</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../input/lish-moa/sample_submission.csv&#39;</span><span class="p">)</span>
<span class="n">GENES</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">train_features</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;g-&#39;</span><span class="p">)]</span>
<span class="n">CELLS</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">train_features</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;c-&#39;</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">(</span><span class="n">GENES</span> <span class="o">+</span> <span class="n">CELLS</span><span class="p">):</span>

    <span class="n">transformer</span> <span class="o">=</span> <span class="n">QuantileTransformer</span><span class="p">(</span><span class="n">n_quantiles</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">output_distribution</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>
    <span class="n">vec_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_features</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">vec_len_test</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_features</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">raw_vec</span> <span class="o">=</span> <span class="n">train_features</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">vec_len</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">transformer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">raw_vec</span><span class="p">)</span>

    <span class="n">train_features</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">raw_vec</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">vec_len</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">test_features</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_features</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">vec_len_test</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">vec_len_test</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    
<span class="k">def</span> <span class="nf">seed_everything</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">):</span>
    <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYTHONHASHSEED&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cudnn</span><span class="o">.</span><span class="n">deterministic</span> <span class="o">=</span> <span class="kc">True</span>
    
<span class="n">seed_everything</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>



<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="k">import</span> <span class="n">PCA</span>
<span class="n">n_comp</span> <span class="o">=</span> <span class="mi">600</span>  <span class="c1">#&lt;--Update</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_features</span><span class="p">[</span><span class="n">GENES</span><span class="p">]),</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test_features</span><span class="p">[</span><span class="n">GENES</span><span class="p">])])</span>
<span class="n">data2</span> <span class="o">=</span> <span class="p">(</span><span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_comp</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">GENES</span><span class="p">]))</span>
<span class="n">train2</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[:</span><span class="n">train_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span> <span class="n">test2</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[</span><span class="o">-</span><span class="n">test_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:]</span>

<span class="n">train2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;pca_G-</span><span class="si">{i}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_comp</span><span class="p">)])</span>
<span class="n">test2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;pca_G-</span><span class="si">{i}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_comp</span><span class="p">)])</span>

<span class="c1"># drop_cols = [f&#39;c-{i}&#39; for i in range(n_comp,len(GENES))]</span>
<span class="n">train_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">train_features</span><span class="p">,</span> <span class="n">train2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">test_features</span><span class="p">,</span> <span class="n">test2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>



<span class="n">n_comp</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1">#&lt;--Update</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_features</span><span class="p">[</span><span class="n">CELLS</span><span class="p">]),</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test_features</span><span class="p">[</span><span class="n">CELLS</span><span class="p">])])</span>
<span class="n">data2</span> <span class="o">=</span> <span class="p">(</span><span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_comp</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">CELLS</span><span class="p">]))</span>
<span class="n">train2</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[:</span><span class="n">train_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span> <span class="n">test2</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[</span><span class="o">-</span><span class="n">test_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:]</span>

<span class="n">train2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;pca_C-</span><span class="si">{i}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_comp</span><span class="p">)])</span>
<span class="n">test2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;pca_C-</span><span class="si">{i}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_comp</span><span class="p">)])</span>

<span class="c1"># drop_cols = [f&#39;c-{i}&#39; for i in range(n_comp,len(CELLS))]</span>
<span class="n">train_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">train_features</span><span class="p">,</span> <span class="n">train2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">test_features</span><span class="p">,</span> <span class="n">test2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="k">import</span> <span class="n">VarianceThreshold</span>


<span class="n">var_thresh</span> <span class="o">=</span> <span class="n">VarianceThreshold</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>  <span class="c1">#&lt;-- Update</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">train_features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_features</span><span class="p">)</span>
<span class="n">data_transformed</span> <span class="o">=</span> <span class="n">var_thresh</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:])</span>

<span class="n">train_features_transformed</span> <span class="o">=</span> <span class="n">data_transformed</span><span class="p">[</span> <span class="p">:</span> <span class="n">train_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">test_features_transformed</span> <span class="o">=</span> <span class="n">data_transformed</span><span class="p">[</span><span class="o">-</span><span class="n">test_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="p">]</span>


<span class="n">train_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_features</span><span class="p">[[</span><span class="s1">&#39;sig_id&#39;</span><span class="p">,</span><span class="s1">&#39;cp_type&#39;</span><span class="p">,</span><span class="s1">&#39;cp_time&#39;</span><span class="p">,</span><span class="s1">&#39;cp_dose&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>\
                              <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sig_id&#39;</span><span class="p">,</span><span class="s1">&#39;cp_type&#39;</span><span class="p">,</span><span class="s1">&#39;cp_time&#39;</span><span class="p">,</span><span class="s1">&#39;cp_dose&#39;</span><span class="p">])</span>

<span class="n">train_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train_features</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_features_transformed</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


<span class="n">test_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test_features</span><span class="p">[[</span><span class="s1">&#39;sig_id&#39;</span><span class="p">,</span><span class="s1">&#39;cp_type&#39;</span><span class="p">,</span><span class="s1">&#39;cp_time&#39;</span><span class="p">,</span><span class="s1">&#39;cp_dose&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>\
                             <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sig_id&#39;</span><span class="p">,</span><span class="s1">&#39;cp_type&#39;</span><span class="p">,</span><span class="s1">&#39;cp_time&#39;</span><span class="p">,</span><span class="s1">&#39;cp_dose&#39;</span><span class="p">])</span>

<span class="n">test_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">test_features</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test_features_transformed</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">train_features</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[50]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(23814, 1040)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[51]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_ratio_labels</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">columns</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ratios</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">toremove</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ratios</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">counts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">toremove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;remove {len(toremove)} columns&quot;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">toremove</span><span class="p">:</span>
        <span class="n">columns</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">columns</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ratios</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="n">columns</span><span class="p">,</span> <span class="n">ratios</span> <span class="o">=</span> <span class="n">get_ratio_labels</span><span class="p">(</span><span class="n">train_targets_scored</span><span class="p">)</span>
<span class="n">columns_nonscored</span><span class="p">,</span> <span class="n">ratios_nonscored</span> <span class="o">=</span> <span class="n">get_ratio_labels</span><span class="p">(</span><span class="n">train_targets_nonscored</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>remove 0 columns
remove 71 columns
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[52]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">remove_vehicle</span><span class="o">=</span><span class="kc">True</span>
<span class="k">def</span> <span class="nf">transform_data</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">removed_vehicle</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        the first 3 columns represents categories, the others numericals features</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cp_type&quot;</span><span class="p">:{</span><span class="s2">&quot;trt_cp&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;ctl_vehicle&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
               <span class="s2">&quot;cp_time&quot;</span><span class="p">:{</span><span class="mi">48</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="mi">72</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="mi">24</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span>
               <span class="s2">&quot;cp_dose&quot;</span><span class="p">:{</span><span class="s2">&quot;D1&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;D2&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">}}</span>
    
    <span class="k">if</span> <span class="n">removed_vehicle</span><span class="p">:</span>
        <span class="n">categories_tr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span> <span class="n">train</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mapping</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">categories_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span> <span class="n">test</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mapping</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">categories_tr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span> <span class="n">train</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mapping</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">col</span><span class="p">[:</span><span class="mi">3</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">categories_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span> <span class="n">test</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mapping</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">col</span><span class="p">[:</span><span class="mi">3</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">max_</span> <span class="o">=</span> <span class="mf">10.</span>
    <span class="n">min_</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10.</span>
   
    <span class="k">if</span> <span class="n">removed_vehicle</span><span class="p">:</span>
        <span class="n">numerical_tr</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">col</span><span class="p">[</span><span class="mi">3</span><span class="p">:]]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">numerical_test</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">col</span><span class="p">[</span><span class="mi">3</span><span class="p">:]]</span><span class="o">.</span><span class="n">values</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">numerical_tr</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">col</span><span class="p">[</span><span class="mi">3</span><span class="p">:]]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">numerical_test</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">col</span><span class="p">[</span><span class="mi">3</span><span class="p">:]]</span><span class="o">.</span><span class="n">values</span>
    <span class="k">if</span> <span class="n">normalize</span><span class="p">:</span>
        <span class="n">numerical_tr</span> <span class="o">=</span> <span class="p">(</span><span class="n">numerical_tr</span><span class="o">-</span><span class="n">min_</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">max_</span> <span class="o">-</span> <span class="n">min_</span><span class="p">)</span>
        <span class="n">numerical_test</span> <span class="o">=</span> <span class="p">(</span><span class="n">numerical_test</span><span class="o">-</span><span class="n">min_</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">max_</span> <span class="o">-</span> <span class="n">min_</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">categories_tr</span><span class="p">,</span> <span class="n">categories_test</span><span class="p">,</span> <span class="n">numerical_tr</span><span class="p">,</span> <span class="n">numerical_test</span>
<span class="n">col_features</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">train_features</span><span class="o">.</span><span class="n">columns</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">cat_tr</span><span class="p">,</span> <span class="n">cat_test</span><span class="p">,</span> <span class="n">numerical_tr</span><span class="p">,</span> <span class="n">numerical_test</span> <span class="o">=</span> <span class="n">transform_data</span><span class="p">(</span><span class="n">train_features</span><span class="p">,</span> <span class="n">test_features</span><span class="p">,</span> <span class="n">col_features</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">removed_vehicle</span><span class="o">=</span><span class="n">remove_vehicle</span><span class="p">)</span>
<span class="n">targets_tr</span> <span class="o">=</span> <span class="n">train_targets_scored</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">targets2_tr</span> <span class="o">=</span> <span class="n">train_targets_nonscored</span><span class="p">[</span><span class="n">columns_nonscored</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[53]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">inference_fn</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span> <span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="n">y_preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span> <span class="n">X</span> <span class="p">)</span>
        <span class="n">y_preds</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">y_preds</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">y_preds</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[54]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">log_loss_score</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">predicted</span><span class="p">,</span>  <span class="n">eps</span><span class="o">=</span><span class="mf">1e-15</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param predicted:   The predicted probabilities as floats between 0-1</span>
<span class="sd">        :param actual:      The binary labels. Either 0 or 1.</span>
<span class="sd">        :param eps:         Log(0) is equal to infinity, so we need to offset our predicted values slightly by eps from 0 or 1</span>
<span class="sd">        :return:            The logarithmic loss between between the predicted probability assigned to the possible outcomes for item i, and the actual outcome.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        
        <span class="n">p1</span> <span class="o">=</span> <span class="n">actual</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">predicted</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span>
        <span class="n">p0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">actual</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">predicted</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">p0</span> <span class="o">+</span> <span class="n">p1</span>

        <span class="k">return</span> <span class="o">-</span><span class="n">loss</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[55]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">log_loss_multi</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">y_true</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
        <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_loss_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">results</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[56]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">check_targets</span><span class="p">(</span><span class="n">targets</span><span class="p">):</span>
    <span class="c1">### check if targets are all binary in training set</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">targets</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">targets</span><span class="p">[:,</span><span class="n">i</span><span class="p">]))</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[57]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">auc_multi</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">y_true</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="n">results</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[58]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="k">import</span> <span class="n">csc_matrix</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="k">import</span> <span class="n">abstractmethod</span>
<span class="kn">from</span> <span class="nn">pytorch_tabnet</span> <span class="k">import</span> <span class="n">tab_network</span>
<span class="kn">from</span> <span class="nn">pytorch_tabnet.multiclass_utils</span> <span class="k">import</span> <span class="n">unique_labels</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">torch.nn.utils</span> <span class="k">import</span> <span class="n">clip_grad_norm_</span>
<span class="kn">from</span> <span class="nn">pytorch_tabnet.utils</span> <span class="k">import</span> <span class="p">(</span><span class="n">PredictDataset</span><span class="p">,</span>
                                  <span class="n">create_dataloaders</span><span class="p">,</span>
                                  <span class="n">create_explain_matrix</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="k">import</span> <span class="n">BaseEstimator</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="k">import</span> <span class="n">DataLoader</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">deepcopy</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="k">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">zipfile</span>

<span class="k">class</span> <span class="nc">TabModel</span><span class="p">(</span><span class="n">BaseEstimator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_d</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">n_a</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">1.3</span><span class="p">,</span> <span class="n">cat_idxs</span><span class="o">=</span><span class="p">[],</span> <span class="n">cat_dims</span><span class="o">=</span><span class="p">[],</span> <span class="n">cat_emb_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">n_independent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_shared</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-15</span><span class="p">,</span>  <span class="n">momentum</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
                 <span class="n">lambda_sparse</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">clip_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">optimizer_fn</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">,</span>
                 <span class="n">optimizer_params</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">2e-2</span><span class="p">),</span>
                 <span class="n">scheduler_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scheduler_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">mask_type</span><span class="o">=</span><span class="s2">&quot;sparsemax&quot;</span><span class="p">,</span>
                 <span class="n">input_dim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_dim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">device_name</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Class for TabNet model</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            device_name: str</span>
<span class="sd">                &#39;cuda&#39; if running on GPU, &#39;cpu&#39; if not, &#39;auto&#39; to autodetect</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">n_d</span> <span class="o">=</span> <span class="n">n_d</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_a</span> <span class="o">=</span> <span class="n">n_a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_steps</span> <span class="o">=</span> <span class="n">n_steps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cat_idxs</span> <span class="o">=</span> <span class="n">cat_idxs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cat_dims</span> <span class="o">=</span> <span class="n">cat_dims</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cat_emb_dim</span> <span class="o">=</span> <span class="n">cat_emb_dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_independent</span> <span class="o">=</span> <span class="n">n_independent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_shared</span> <span class="o">=</span> <span class="n">n_shared</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="n">epsilon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">momentum</span> <span class="o">=</span> <span class="n">momentum</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lambda_sparse</span> <span class="o">=</span> <span class="n">lambda_sparse</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clip_value</span> <span class="o">=</span> <span class="n">clip_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer_fn</span> <span class="o">=</span> <span class="n">optimizer_fn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer_params</span> <span class="o">=</span> <span class="n">optimizer_params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device_name</span> <span class="o">=</span> <span class="n">device_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scheduler_params</span> <span class="o">=</span> <span class="n">scheduler_params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scheduler_fn</span> <span class="o">=</span> <span class="n">scheduler_fn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask_type</span> <span class="o">=</span> <span class="n">mask_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_dim</span> <span class="o">=</span> <span class="n">input_dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_dim</span> <span class="o">=</span> <span class="n">output_dim</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">1024</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
        <span class="c1"># Defining device</span>
        <span class="k">if</span> <span class="n">device_name</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
                <span class="n">device_name</span> <span class="o">=</span> <span class="s1">&#39;cuda&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">device_name</span> <span class="o">=</span> <span class="s1">&#39;cpu&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">device_name</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Device used : </span><span class="si">{self.device}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">construct_loaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">,</span>
                          <span class="n">weights</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">num_workers</span><span class="p">,</span> <span class="n">drop_last</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        train_dataloader, valid_dataloader : torch.DataLoader, torch.DataLoader</span>
<span class="sd">            Training and validation dataloaders</span>
<span class="sd">        -------</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">init_network</span><span class="p">(</span>
                     <span class="bp">self</span><span class="p">,</span>
                     <span class="n">input_dim</span><span class="p">,</span>
                     <span class="n">output_dim</span><span class="p">,</span>
                     <span class="n">n_d</span><span class="p">,</span>
                     <span class="n">n_a</span><span class="p">,</span>
                     <span class="n">n_steps</span><span class="p">,</span>
                     <span class="n">gamma</span><span class="p">,</span>
                     <span class="n">cat_idxs</span><span class="p">,</span>
                     <span class="n">cat_dims</span><span class="p">,</span>
                     <span class="n">cat_emb_dim</span><span class="p">,</span>
                     <span class="n">n_independent</span><span class="p">,</span>
                     <span class="n">n_shared</span><span class="p">,</span>
                     <span class="n">epsilon</span><span class="p">,</span>
                     <span class="n">virtual_batch_size</span><span class="p">,</span>
                     <span class="n">momentum</span><span class="p">,</span>
                     <span class="n">device_name</span><span class="p">,</span>
                     <span class="n">mask_type</span><span class="p">,</span>
                     <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">network</span> <span class="o">=</span> <span class="n">tab_network</span><span class="o">.</span><span class="n">TabNet</span><span class="p">(</span>
            <span class="n">input_dim</span><span class="p">,</span>
            <span class="n">output_dim</span><span class="p">,</span>
            <span class="n">n_d</span><span class="o">=</span><span class="n">n_d</span><span class="p">,</span>
            <span class="n">n_a</span><span class="o">=</span><span class="n">n_a</span><span class="p">,</span>
            <span class="n">n_steps</span><span class="o">=</span><span class="n">n_steps</span><span class="p">,</span>
            <span class="n">gamma</span><span class="o">=</span><span class="n">gamma</span><span class="p">,</span>
            <span class="n">cat_idxs</span><span class="o">=</span><span class="n">cat_idxs</span><span class="p">,</span>
            <span class="n">cat_dims</span><span class="o">=</span><span class="n">cat_dims</span><span class="p">,</span>
            <span class="n">cat_emb_dim</span><span class="o">=</span><span class="n">cat_emb_dim</span><span class="p">,</span>
            <span class="n">n_independent</span><span class="o">=</span><span class="n">n_independent</span><span class="p">,</span>
            <span class="n">n_shared</span><span class="o">=</span><span class="n">n_shared</span><span class="p">,</span>
            <span class="n">epsilon</span><span class="o">=</span><span class="n">epsilon</span><span class="p">,</span>
            <span class="n">virtual_batch_size</span><span class="o">=</span><span class="n">virtual_batch_size</span><span class="p">,</span>
            <span class="n">momentum</span><span class="o">=</span><span class="n">momentum</span><span class="p">,</span>
            <span class="n">device_name</span><span class="o">=</span><span class="n">device_name</span><span class="p">,</span>
            <span class="n">mask_type</span><span class="o">=</span><span class="n">mask_type</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">reducing_matrix</span> <span class="o">=</span> <span class="n">create_explain_matrix</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">input_dim</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">cat_emb_dim</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">cat_idxs</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">post_embed_dim</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_valid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">loss_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">weights</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
            <span class="n">virtual_batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            X_train: np.ndarray</span>
<span class="sd">                Train set</span>
<span class="sd">            y_train : np.array</span>
<span class="sd">                Train targets</span>
<span class="sd">            X_train: np.ndarray</span>
<span class="sd">                Train set</span>
<span class="sd">            y_train : np.array</span>
<span class="sd">                Train targets</span>
<span class="sd">            weights : bool or dictionnary</span>
<span class="sd">                0 for no balancing</span>
<span class="sd">                1 for automated balancing</span>
<span class="sd">                dict for custom weights per class</span>
<span class="sd">            max_epochs : int</span>
<span class="sd">                Maximum number of epochs during training</span>
<span class="sd">            patience : int</span>
<span class="sd">                Number of consecutive non improving epoch before early stopping</span>
<span class="sd">            batch_size : int</span>
<span class="sd">                Training batch size</span>
<span class="sd">            virtual_batch_size : int</span>
<span class="sd">                Batch size for Ghost Batch Normalization (virtual_batch_size &lt; batch_size)</span>
<span class="sd">            num_workers : int</span>
<span class="sd">                Number of workers used in torch.utils.data.DataLoader</span>
<span class="sd">            drop_last : bool</span>
<span class="sd">                Whether to drop last batch during training</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># update model name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_fit_params</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span>
                               <span class="n">weights</span><span class="p">,</span> <span class="n">max_epochs</span><span class="p">,</span> <span class="n">patience</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span>
                               <span class="n">virtual_batch_size</span><span class="p">,</span> <span class="n">num_workers</span><span class="p">,</span> <span class="n">drop_last</span><span class="p">)</span>

        <span class="n">train_dataloader</span><span class="p">,</span> <span class="n">valid_dataloader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">construct_loaders</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span>
                                                                    <span class="n">y_train</span><span class="p">,</span>
                                                                    <span class="n">X_valid</span><span class="p">,</span>
                                                                    <span class="n">y_valid</span><span class="p">,</span>
                                                                    <span class="bp">self</span><span class="o">.</span><span class="n">updated_weights</span><span class="p">,</span>
                                                                    <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span>
                                                                    <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">,</span>
                                                                    <span class="bp">self</span><span class="o">.</span><span class="n">drop_last</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_network</span><span class="p">(</span>
            <span class="n">input_dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">input_dim</span><span class="p">,</span>
            <span class="n">output_dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dim</span><span class="p">,</span>
            <span class="n">n_d</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_d</span><span class="p">,</span>
            <span class="n">n_a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_a</span><span class="p">,</span>
            <span class="n">n_steps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_steps</span><span class="p">,</span>
            <span class="n">gamma</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">,</span>
            <span class="n">cat_idxs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cat_idxs</span><span class="p">,</span>
            <span class="n">cat_dims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cat_dims</span><span class="p">,</span>
            <span class="n">cat_emb_dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cat_emb_dim</span><span class="p">,</span>
            <span class="n">n_independent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_independent</span><span class="p">,</span>
            <span class="n">n_shared</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_shared</span><span class="p">,</span>
            <span class="n">epsilon</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="p">,</span>
            <span class="n">virtual_batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">virtual_batch_size</span><span class="p">,</span>
            <span class="n">momentum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">momentum</span><span class="p">,</span>
            <span class="n">device_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span>
            <span class="n">mask_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mask_type</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer_fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span>
                                           <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">optimizer_params</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheduler_fn</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheduler_fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">scheduler_params</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">losses_train</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">losses_valid</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">learning_rates</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_train</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_valid</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Will train until validation stopping metric&quot;</span><span class="p">,</span>
                  <span class="n">f</span><span class="s2">&quot;hasn&#39;t improved in </span><span class="si">{self.patience}</span><span class="s2"> rounds.&quot;</span><span class="p">)</span>
            <span class="n">msg_epoch</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;| EPOCH |  train  |   valid  | total time (s)&#39;</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------------&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">msg_epoch</span><span class="p">)</span>

        <span class="n">total_time</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">epoch</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_epochs</span> <span class="ow">and</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">patience_counter</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">patience</span><span class="p">):</span>
            <span class="n">starting_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="c1"># updates learning rate history</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">learning_rates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">param_groups</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;lr&quot;</span><span class="p">])</span>

            <span class="n">fit_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_epoch</span><span class="p">(</span><span class="n">train_dataloader</span><span class="p">,</span> <span class="n">valid_dataloader</span><span class="p">)</span>

            <span class="c1"># leaving it here, may be used for callbacks later</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">losses_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fit_metrics</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">][</span><span class="s1">&#39;loss_avg&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">losses_valid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fit_metrics</span><span class="p">[</span><span class="s1">&#39;valid&#39;</span><span class="p">][</span><span class="s1">&#39;total_loss&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metrics_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fit_metrics</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">][</span><span class="s1">&#39;stopping_loss&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metrics_valid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fit_metrics</span><span class="p">[</span><span class="s1">&#39;valid&#39;</span><span class="p">][</span><span class="s1">&#39;stopping_loss&#39;</span><span class="p">])</span>

            <span class="n">stopping_loss</span> <span class="o">=</span> <span class="n">fit_metrics</span><span class="p">[</span><span class="s1">&#39;valid&#39;</span><span class="p">][</span><span class="s1">&#39;stopping_loss&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">stopping_loss</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_cost</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">best_cost</span> <span class="o">=</span> <span class="n">stopping_loss</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">patience_counter</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="c1"># Saving model</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">best_network</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="p">)</span>
                <span class="n">has_improved</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">patience_counter</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">has_improved</span><span class="o">=</span><span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">epoch</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">total_time</span> <span class="o">+=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">starting_time</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">epoch</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">separator</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span>
                    <span class="n">msg_epoch</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;| </span><span class="si">{self.epoch:&lt;5}</span><span class="s2"> | &quot;</span>
                    <span class="n">msg_epoch</span> <span class="o">+=</span> <span class="n">f</span><span class="s2">&quot; </span><span class="si">{fit_metrics[&#39;train&#39;][&#39;stopping_loss&#39;]:.5f}</span><span class="s2">&quot;</span>
                    <span class="n">msg_epoch</span> <span class="o">+=</span> <span class="n">f</span><span class="s1">&#39; </span><span class="si">{separator:&lt;2}</span><span class="s1"> &#39;</span>
                    <span class="n">msg_epoch</span> <span class="o">+=</span> <span class="n">f</span><span class="s2">&quot; </span><span class="si">{fit_metrics[&#39;valid&#39;][&#39;stopping_loss&#39;]:.5f}</span><span class="s2">&quot;</span>
                    <span class="n">msg_epoch</span> <span class="o">+=</span> <span class="n">f</span><span class="s1">&#39; </span><span class="si">{separator:&lt;2}</span><span class="s1"> &#39;</span>
                    <span class="n">msg_epoch</span> <span class="o">+=</span> <span class="n">f</span><span class="s2">&quot; {np.round(total_time, 1):&lt;10}&quot;</span>
                    <span class="n">msg_epoch</span> <span class="o">+=</span> <span class="n">f</span><span class="s2">&quot; </span><span class="si">{has_improved}</span><span class="s2">&quot;</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">msg_epoch</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">patience_counter</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">patience</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Early stopping occured at epoch </span><span class="si">{self.epoch}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Training done in </span><span class="si">{total_time:.3f}</span><span class="s2"> seconds.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------------------------&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">losses_train</span><span class="p">,</span>
                                  <span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics_train</span><span class="p">,</span>
                                  <span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rates</span><span class="p">},</span>
                        <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">losses_valid</span><span class="p">,</span>
                                  <span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics_valid</span><span class="p">}}</span>
        <span class="c1"># load best models post training</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_best_model</span><span class="p">()</span>

        <span class="c1"># compute feature importance once the best model is defined</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_compute_feature_importances</span><span class="p">(</span><span class="n">train_dataloader</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">save_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saving model with two distinct files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">saved_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
                <span class="c1"># Don&#39;t save torch specific params</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">saved_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

        <span class="c1"># Create folder</span>
        <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Save models params</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;model_params.json&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">saved_params</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

        <span class="c1"># Save state_dict</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;network.pt&quot;</span><span class="p">))</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">make_archive</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;zip&#39;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Successfully saved model at </span><span class="si">{path}</span><span class="s2">.zip&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span><span class="s2">&quot;</span><span class="si">{path}</span><span class="s2">.zip&quot;</span>

    <span class="k">def</span> <span class="nf">load_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">):</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">z</span><span class="p">:</span>
                    <span class="k">with</span> <span class="n">z</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;model_params.json&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                        <span class="n">loaded_params</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                    <span class="k">with</span> <span class="n">z</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;network.pt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">saved_state_dict</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                        <span class="k">except</span> <span class="n">io</span><span class="o">.</span><span class="n">UnsupportedOperation</span><span class="p">:</span>
                            <span class="n">saved_state_dict</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>
                            
            <span class="k">except</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;model_params.json&quot;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                        <span class="n">loaded_params</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

                <span class="n">saved_state_dict</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;network.pt&quot;</span><span class="p">),</span> <span class="n">map_location</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
 
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Your zip file is missing at least one component&quot;</span><span class="p">)</span>

        <span class="c1">#print(loaded_params)</span>
        <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
            <span class="n">device_name</span> <span class="o">=</span> <span class="s1">&#39;cuda&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">device_name</span> <span class="o">=</span> <span class="s1">&#39;cpu&#39;</span>
        <span class="n">loaded_params</span><span class="p">[</span><span class="s2">&quot;device_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">device_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">loaded_params</span><span class="p">)</span>
        
        

        <span class="bp">self</span><span class="o">.</span><span class="n">init_network</span><span class="p">(</span>
            <span class="n">input_dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">input_dim</span><span class="p">,</span>
            <span class="n">output_dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dim</span><span class="p">,</span>
            <span class="n">n_d</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_d</span><span class="p">,</span>
            <span class="n">n_a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_a</span><span class="p">,</span>
            <span class="n">n_steps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_steps</span><span class="p">,</span>
            <span class="n">gamma</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">,</span>
            <span class="n">cat_idxs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cat_idxs</span><span class="p">,</span>
            <span class="n">cat_dims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cat_dims</span><span class="p">,</span>
            <span class="n">cat_emb_dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cat_emb_dim</span><span class="p">,</span>
            <span class="n">n_independent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_independent</span><span class="p">,</span>
            <span class="n">n_shared</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_shared</span><span class="p">,</span>
            <span class="n">epsilon</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="p">,</span>
            <span class="n">virtual_batch_size</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
            <span class="n">momentum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">momentum</span><span class="p">,</span>
            <span class="n">device_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_name</span><span class="p">,</span>
            <span class="n">mask_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mask_type</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">saved_state_dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">fit_epoch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_dataloader</span><span class="p">,</span> <span class="n">valid_dataloader</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            train_dataloader: a :class: `torch.utils.data.Dataloader`</span>
<span class="sd">                DataLoader with train set</span>
<span class="sd">            valid_dataloader: a :class: `torch.utils.data.Dataloader`</span>
<span class="sd">                DataLoader with valid set</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">train_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_epoch</span><span class="p">(</span><span class="n">train_dataloader</span><span class="p">)</span>
        <span class="n">valid_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_epoch</span><span class="p">(</span><span class="n">valid_dataloader</span><span class="p">)</span>

        <span class="n">fit_metrics</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;train&#39;</span><span class="p">:</span> <span class="n">train_metrics</span><span class="p">,</span>
                       <span class="s1">&#39;valid&#39;</span><span class="p">:</span> <span class="n">valid_metrics</span><span class="p">}</span>

        <span class="k">return</span> <span class="n">fit_metrics</span>
    
    
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">train_epoch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            train_loader: a :class: `torch.utils.data.Dataloader`</span>
<span class="sd">                DataLoader with train set</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;users must define train_epoch to use this base class&#39;</span><span class="p">)</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">train_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            data: a :tensor: `torch.tensor`</span>
<span class="sd">                Input data</span>
<span class="sd">            target: a :tensor: `torch.tensor`</span>
<span class="sd">                Target data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;users must define train_batch to use this base class&#39;</span><span class="p">)</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">predict_epoch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loader</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            loader: a :class: `torch.utils.data.Dataloader`</span>
<span class="sd">                    DataLoader with validation set</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;users must define predict_epoch to use this base class&#39;</span><span class="p">)</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">predict_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            data: a :tensor: `torch.Tensor`</span>
<span class="sd">                Input data</span>
<span class="sd">            target: a :tensor: `torch.Tensor`</span>
<span class="sd">                Target data</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            batch_outs: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;users must define predict_batch to use this base class&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_best_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_network</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">network</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_network</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            data: a :tensor: `torch.Tensor`</span>
<span class="sd">                Input data</span>
<span class="sd">            target: a :tensor: `torch.Tensor`</span>
<span class="sd">                Target data</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            predictions: np.array</span>
<span class="sd">                Predictions of the regression problem or the last class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;users must define predict to use this base class&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">explain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            data: a :tensor: `torch.Tensor`</span>
<span class="sd">                Input data</span>
<span class="sd">            target: a :tensor: `torch.Tensor`</span>
<span class="sd">                Target data</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            M_explain: matrix</span>
<span class="sd">                Importance per sample, per columns.</span>
<span class="sd">            masks: matrix</span>
<span class="sd">                Sparse matrix showing attention masks used by network.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

        <span class="n">dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">PredictDataset</span><span class="p">(</span><span class="n">X</span><span class="p">),</span>
                                <span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">batch_nb</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataloader</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>

            <span class="n">M_explain</span><span class="p">,</span> <span class="n">masks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">forward_masks</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">masks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">masks</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">csc_matrix</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">reducing_matrix</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">batch_nb</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">res_explain</span> <span class="o">=</span> <span class="n">csc_matrix</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">M_explain</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">reducing_matrix</span><span class="p">)</span>
                <span class="n">res_masks</span> <span class="o">=</span> <span class="n">masks</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res_explain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">res_explain</span><span class="p">,</span>
                                         <span class="n">csc_matrix</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">M_explain</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">reducing_matrix</span><span class="p">)])</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">masks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">res_masks</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">res_masks</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">value</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">res_explain</span><span class="p">,</span> <span class="n">res_masks</span>

    <span class="k">def</span> <span class="nf">_compute_feature_importances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loader</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        <span class="n">feature_importances_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">post_embed_dim</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">targets</span> <span class="ow">in</span> <span class="n">loader</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
            <span class="n">M_explain</span><span class="p">,</span> <span class="n">masks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">forward_masks</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">feature_importances_</span> <span class="o">+=</span> <span class="n">M_explain</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

        <span class="n">feature_importances_</span> <span class="o">=</span> <span class="n">csc_matrix</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">feature_importances_</span><span class="p">,</span>
                                              <span class="bp">self</span><span class="o">.</span><span class="n">reducing_matrix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_importances_</span> <span class="o">=</span> <span class="n">feature_importances_</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">feature_importances_</span><span class="p">)</span>
        
        
<span class="k">class</span> <span class="nc">TabNetRegressor</span><span class="p">(</span><span class="n">TabModel</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">construct_loaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span>
                          <span class="n">batch_size</span><span class="p">,</span> <span class="n">num_workers</span><span class="p">,</span> <span class="n">drop_last</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        train_dataloader, valid_dataloader : torch.DataLoader, torch.DataLoader</span>
<span class="sd">            Training and validation dataloaders</span>
<span class="sd">        -------</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">weights</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please provide a list of weights for regression.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please provide a list of weights for regression.&quot;</span><span class="p">)</span>

        <span class="n">train_dataloader</span><span class="p">,</span> <span class="n">valid_dataloader</span> <span class="o">=</span> <span class="n">create_dataloaders</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span>
                                                                <span class="n">y_train</span><span class="p">,</span>
                                                                <span class="n">X_valid</span><span class="p">,</span>
                                                                <span class="n">y_valid</span><span class="p">,</span>
                                                                <span class="n">weights</span><span class="p">,</span>
                                                                <span class="n">batch_size</span><span class="p">,</span>
                                                                <span class="n">num_workers</span><span class="p">,</span>
                                                                <span class="n">drop_last</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">train_dataloader</span><span class="p">,</span> <span class="n">valid_dataloader</span>

    <span class="k">def</span> <span class="nf">update_fit_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span>
                          <span class="n">weights</span><span class="p">,</span> <span class="n">max_epochs</span><span class="p">,</span> <span class="n">patience</span><span class="p">,</span>
                          <span class="n">batch_size</span><span class="p">,</span> <span class="n">virtual_batch_size</span><span class="p">,</span> <span class="n">num_workers</span><span class="p">,</span> <span class="n">drop_last</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">loss_fn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">mse_loss</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span> <span class="o">=</span> <span class="n">loss_fn</span>

        <span class="k">assert</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">X_valid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Dimension mismatch X_train X_valid&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_dim</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Please apply reshape(-1, 1) to your targets</span>
<span class="s2">                                if doing single regression.&quot;&quot;&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">y_valid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Dimension mismatch y_train y_valid&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_dim</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">updated_weights</span> <span class="o">=</span> <span class="n">weights</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">max_epochs</span> <span class="o">=</span> <span class="n">max_epochs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patience</span> <span class="o">=</span> <span class="n">patience</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">virtual_batch_size</span> <span class="o">=</span> <span class="n">virtual_batch_size</span>
        <span class="c1"># Initialize counters and histories.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patience_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epoch</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">best_cost</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">=</span> <span class="n">num_workers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drop_last</span> <span class="o">=</span> <span class="n">drop_last</span>

    <span class="k">def</span> <span class="nf">train_epoch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            train_loader: a :class: `torch.utils.data.Dataloader`</span>
<span class="sd">                DataLoader with train set</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
        <span class="n">y_preds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">total_loss</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">targets</span> <span class="ow">in</span> <span class="n">train_loader</span><span class="p">:</span>
            <span class="n">batch_outs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_batch</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
            <span class="n">y_preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_outs</span><span class="p">[</span><span class="s2">&quot;y_preds&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
            <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_outs</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
            <span class="n">total_loss</span> <span class="o">+=</span> <span class="n">batch_outs</span><span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">]</span>

        <span class="n">y_preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">y_preds</span><span class="p">)</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>

        <span class="c1">#stopping_loss = mean_squared_error(y_true=ys, y_pred=y_preds)</span>
        <span class="n">stopping_loss</span> <span class="o">=</span><span class="n">log_loss_multi</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">y_preds</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>  <span class="p">)</span>
        <span class="n">total_loss</span> <span class="o">=</span> <span class="n">total_loss</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_loader</span><span class="p">)</span>
        <span class="n">epoch_metrics</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;loss_avg&#39;</span><span class="p">:</span> <span class="n">total_loss</span><span class="p">,</span>
                         <span class="s1">&#39;stopping_loss&#39;</span><span class="p">:</span> <span class="n">total_loss</span><span class="p">,</span>
                         <span class="p">}</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">epoch_metrics</span>

    <span class="k">def</span> <span class="nf">train_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            data: a :tensor: `torch.tensor`</span>
<span class="sd">                Input data</span>
<span class="sd">            target: a :tensor: `torch.tensor`</span>
<span class="sd">                Target data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>

        <span class="n">targets</span> <span class="o">=</span> <span class="n">targets</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>

        <span class="n">output</span><span class="p">,</span> <span class="n">M_loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
        
        <span class="n">loss</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda_sparse</span><span class="o">*</span><span class="n">M_loss</span>

        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">clip_value</span><span class="p">:</span>
            <span class="n">clip_grad_norm_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">clip_value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="n">loss_value</span> <span class="o">=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="n">batch_outs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="n">loss_value</span><span class="p">,</span>
                      <span class="s1">&#39;y_preds&#39;</span><span class="p">:</span> <span class="n">output</span><span class="p">,</span>
                      <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">targets</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">batch_outs</span>

    <span class="k">def</span> <span class="nf">predict_epoch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loader</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            loader: a :class: `torch.utils.data.Dataloader`</span>
<span class="sd">                    DataLoader with validation set</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y_preds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        <span class="n">total_loss</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">targets</span> <span class="ow">in</span> <span class="n">loader</span><span class="p">:</span>
            <span class="n">batch_outs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_batch</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
            <span class="n">total_loss</span> <span class="o">+=</span> <span class="n">batch_outs</span><span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">]</span>
            <span class="n">y_preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_outs</span><span class="p">[</span><span class="s2">&quot;y_preds&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
            <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">batch_outs</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>

        <span class="n">y_preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">y_preds</span><span class="p">)</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>

        <span class="n">stopping_loss</span> <span class="o">=</span><span class="n">log_loss_multi</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">y_preds</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>  <span class="p">)</span> <span class="c1">#mean_squared_error(y_true=ys, y_pred=y_preds)</span>

        <span class="n">total_loss</span> <span class="o">=</span> <span class="n">total_loss</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">loader</span><span class="p">)</span>
        <span class="n">epoch_metrics</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;total_loss&#39;</span><span class="p">:</span> <span class="n">total_loss</span><span class="p">,</span>
                         <span class="s1">&#39;stopping_loss&#39;</span><span class="p">:</span> <span class="n">stopping_loss</span><span class="p">}</span>

        <span class="k">return</span> <span class="n">epoch_metrics</span>

    <span class="k">def</span> <span class="nf">predict_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            data: a :tensor: `torch.Tensor`</span>
<span class="sd">                Input data</span>
<span class="sd">            target: a :tensor: `torch.Tensor`</span>
<span class="sd">                Target data</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            batch_outs: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
        <span class="n">targets</span> <span class="o">=</span> <span class="n">targets</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>

        <span class="n">output</span><span class="p">,</span> <span class="n">M_loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
       
        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
        <span class="c1">#print(self.loss_fn, loss)</span>
        <span class="n">loss</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda_sparse</span><span class="o">*</span><span class="n">M_loss</span>
        <span class="c1">#print(loss)</span>
        <span class="n">loss_value</span> <span class="o">=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="n">batch_outs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="n">loss_value</span><span class="p">,</span>
                      <span class="s1">&#39;y_preds&#39;</span><span class="p">:</span> <span class="n">output</span><span class="p">,</span>
                      <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">targets</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">batch_outs</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            data: a :tensor: `torch.Tensor`</span>
<span class="sd">                Input data</span>
<span class="sd">            target: a :tensor: `torch.Tensor`</span>
<span class="sd">                Target data</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            predictions: np.array</span>
<span class="sd">                Predictions of the regression problem</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        <span class="n">dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">PredictDataset</span><span class="p">(</span><span class="n">X</span><span class="p">),</span>
                                <span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">batch_nb</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataloader</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>

            <span class="n">output</span><span class="p">,</span> <span class="n">M_loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[59]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">iterstrat.ml_stratifiers</span> <span class="k">import</span> <span class="n">MultilabelStratifiedKFold</span><span class="p">,</span> <span class="n">MultilabelStratifiedShuffleSplit</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">roc_auc_score</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[60]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Config</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_class</span> <span class="o">=</span> <span class="n">targets_tr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;cuda&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SPLITS</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EPOCHS</span> <span class="o">=</span> <span class="mi">200</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_ensembling</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Parameters model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cat_emb_dim</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">cat_tr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#to choose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cats_idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">cat_tr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cat_dims</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">cat_tr</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cat_tr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_numericals</span><span class="o">=</span> <span class="n">numerical_tr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># save</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_name</span> <span class="o">=</span> <span class="s2">&quot;../input/tabnet-smoothing/tabnet_raw_step1&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">strategy</span> <span class="o">=</span> <span class="s2">&quot;KFOLD&quot;</span> <span class="c1"># </span>
<span class="n">cfg</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[61]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">cat_test</span><span class="p">,</span> <span class="n">numerical_test</span> <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[62]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SEED</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;KFOLD&quot;</span><span class="p">:</span>
    <span class="n">oof_preds_all</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">oof_targets_all</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">scores_all</span> <span class="o">=</span>  <span class="p">[]</span>
    <span class="n">scores_auc_all</span><span class="o">=</span> <span class="p">[]</span>
    <span class="n">preds_test</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="n">SEED</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## SEED : &quot;</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
        <span class="n">mskf</span> <span class="o">=</span> <span class="n">MultilabelStratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">seed</span><span class="o">+</span><span class="n">seed</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">oof_preds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">oof_targets</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">scores_auc</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">p</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="p">(</span><span class="n">train_idx</span><span class="p">,</span> <span class="n">val_idx</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mskf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cat_tr</span><span class="p">)),</span> <span class="n">targets_tr</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;FOLDS : &quot;</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>

            <span class="c1">## model</span>
            <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">cat_tr</span><span class="p">[</span><span class="n">train_idx</span><span class="p">],</span> <span class="n">numerical_tr</span><span class="p">[</span><span class="n">train_idx</span><span class="p">]</span> <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">targets_tr</span><span class="p">[</span><span class="n">train_idx</span><span class="p">])</span>
            <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">cat_tr</span><span class="p">[</span><span class="n">val_idx</span><span class="p">],</span> <span class="n">numerical_tr</span><span class="p">[</span><span class="n">val_idx</span><span class="p">]</span> <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">targets_tr</span><span class="p">[</span><span class="n">val_idx</span><span class="p">])</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">TabNetRegressor</span><span class="p">(</span><span class="n">n_d</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">n_a</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">1.3</span><span class="p">,</span> <span class="n">lambda_sparse</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cat_dims</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">cat_dims</span><span class="p">,</span> <span class="n">cat_emb_dim</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">cat_emb_dim</span><span class="p">,</span> <span class="n">cat_idxs</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">cats_idx</span><span class="p">,</span> <span class="n">optimizer_fn</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">,</span>
                                   <span class="n">optimizer_params</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">2e-2</span><span class="p">),</span> <span class="n">mask_type</span><span class="o">=</span><span class="s1">&#39;entmax&#39;</span><span class="p">,</span> <span class="n">device_name</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">scheduler_params</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">milestones</span><span class="o">=</span><span class="p">[</span> <span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">150</span><span class="p">],</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.9</span><span class="p">),</span> <span class="n">scheduler_fn</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">MultiStepLR</span><span class="p">)</span>
            <span class="c1">#&#39;sparsemax&#39;</span>
            
            <span class="n">name</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">save_name</span> <span class="o">+</span> <span class="n">f</span><span class="s2">&quot;_fold</span><span class="si">{j}</span><span class="s2">_</span><span class="si">{seed}</span><span class="s2">&quot;</span>
            <span class="n">model</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="c1"># preds on val</span>
            <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
            <span class="n">preds</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">preds</span><span class="p">))</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">log_loss_multi</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span>
            
            <span class="c1"># preds on test</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
            <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
            <span class="c1">## save oof to compute the CV later</span>
            <span class="n">oof_preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
            <span class="n">oof_targets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_val</span><span class="p">)</span>
            <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
            <span class="n">scores_auc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">auc_multi</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span><span class="n">preds</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;validation fold </span><span class="si">{j}</span><span class="s2"> : </span><span class="si">{score}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">preds_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">oof_preds_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">oof_preds</span><span class="p">))</span>
        <span class="n">oof_targets_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">oof_targets</span><span class="p">))</span>
        <span class="n">scores_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scores</span><span class="p">))</span>
        <span class="n">scores_auc_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scores_auc</span><span class="p">))</span>
    <span class="n">preds_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">preds_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>## SEED :  0
FOLDS :  0
Device used : cuda
Device used : cuda
validation fold 0 : 0.015792234810080505
FOLDS :  1
Device used : cuda
Device used : cuda
validation fold 1 : 0.01589894192705826
FOLDS :  2
Device used : cuda
Device used : cuda
validation fold 2 : 0.015809682970674418
FOLDS :  3
Device used : cuda
Device used : cuda
validation fold 3 : 0.0157982509253203
FOLDS :  4
Device used : cuda
Device used : cuda
validation fold 4 : 0.015770091121684017
## SEED :  1
FOLDS :  0
Device used : cuda
Device used : cuda
validation fold 0 : 0.01575729768390957
FOLDS :  1
Device used : cuda
Device used : cuda
validation fold 1 : 0.01575164423969538
FOLDS :  2
Device used : cuda
Device used : cuda
validation fold 2 : 0.01578274279639568
FOLDS :  3
Device used : cuda
Device used : cuda
validation fold 3 : 0.015903922528010404
FOLDS :  4
Device used : cuda
Device used : cuda
validation fold 4 : 0.01569360916958263
## SEED :  2
FOLDS :  0
Device used : cuda
Device used : cuda
validation fold 0 : 0.0157813005685101
FOLDS :  1
Device used : cuda
Device used : cuda
validation fold 1 : 0.015695559846472393
FOLDS :  2
Device used : cuda
Device used : cuda
validation fold 2 : 0.015849373167724286
FOLDS :  3
Device used : cuda
Device used : cuda
validation fold 3 : 0.015829239073390303
FOLDS :  4
Device used : cuda
Device used : cuda
validation fold 4 : 0.015902244694162505
## SEED :  3
FOLDS :  0
Device used : cuda
Device used : cuda
validation fold 0 : 0.015516872268262798
FOLDS :  1
Device used : cuda
Device used : cuda
validation fold 1 : 0.01584552142862909
FOLDS :  2
Device used : cuda
Device used : cuda
validation fold 2 : 0.015831884221078882
FOLDS :  3
Device used : cuda
Device used : cuda
validation fold 3 : 0.015824035770492628
FOLDS :  4
Device used : cuda
Device used : cuda
validation fold 4 : 0.015800122583615007
## SEED :  4
FOLDS :  0
Device used : cuda
Device used : cuda
validation fold 0 : 0.01563522198917887
FOLDS :  1
Device used : cuda
Device used : cuda
validation fold 1 : 0.015964119014719013
FOLDS :  2
Device used : cuda
Device used : cuda
validation fold 2 : 0.015712610799118478
FOLDS :  3
Device used : cuda
Device used : cuda
validation fold 3 : 0.015784891844428713
FOLDS :  4
Device used : cuda
Device used : cuda
validation fold 4 : 0.015699808382953616
## SEED :  5
FOLDS :  0
Device used : cuda
Device used : cuda
validation fold 0 : 0.015907240789089786
FOLDS :  1
Device used : cuda
Device used : cuda
validation fold 1 : 0.01572797976821905
FOLDS :  2
Device used : cuda
Device used : cuda
validation fold 2 : 0.015717567495088482
FOLDS :  3
Device used : cuda
Device used : cuda
validation fold 3 : 0.01574247453256637
FOLDS :  4
Device used : cuda
Device used : cuda
validation fold 4 : 0.015763709384629288
## SEED :  6
FOLDS :  0
Device used : cuda
Device used : cuda
validation fold 0 : 0.015890300609013155
FOLDS :  1
Device used : cuda
Device used : cuda
validation fold 1 : 0.01575464780020835
FOLDS :  2
Device used : cuda
Device used : cuda
validation fold 2 : 0.015866215914110336
FOLDS :  3
Device used : cuda
Device used : cuda
validation fold 3 : 0.015745332284301555
FOLDS :  4
Device used : cuda
Device used : cuda
validation fold 4 : 0.015793564805684123
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[63]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;KFOLD&quot;</span><span class="p">:</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">num_ensembling</span><span class="p">):</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CV score fold : &quot;</span><span class="p">,</span> <span class="n">log_loss_multi</span><span class="p">(</span><span class="n">oof_targets_all</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">oof_preds_all</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;auc mean : &quot;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">scores_auc_all</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">scores_auc_all</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>CV score fold :  0.01581384091258266
auc mean :  0.7514048487098565
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The final cv score on multiple folds is 0.01581384091258266 and the accuracy mean is 0.7514048487098565, which is improved compared with single fold trainning.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[64]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">submission</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">preds_test</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">submission</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test_features</span><span class="p">[</span><span class="s1">&#39;cp_type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;ctl_vehicle&#39;</span><span class="p">,</span> <span class="n">submission</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[65]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sub2</span>  <span class="o">=</span> <span class="n">submission</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the third model, 1-5 layers deep neural network are combined and predictors are got from public kernels for the resnet type model. Still, each model is trained with multiple seeds and average the predictions. Inference are made based on the output of the 5 models seperately and the final result is from first blend 5l, 4l, 3l and l2 dnn model and then blend the result of the previous model with the dnn resnet type model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[66]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../input&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">iterstrat.ml_stratifiers</span> <span class="k">import</span> <span class="n">MultilabelStratifiedKFold</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">tensorflow.keras.backend</span> <span class="k">as</span> <span class="nn">K</span>
<span class="kn">import</span> <span class="nn">tensorflow_addons</span> <span class="k">as</span> <span class="nn">tfa</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">log_loss</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">RobustScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="k">import</span> <span class="n">PCA</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[67]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">FOLDS</span> <span class="o">=</span> <span class="mi">10</span>
<span class="c1"># Number of epochs to train each model</span>
<span class="n">EPOCHS</span> <span class="o">=</span> <span class="mi">80</span>
<span class="c1"># Batch size</span>
<span class="n">BATCH_SIZE</span> <span class="o">=</span> <span class="mi">124</span>
<span class="c1"># Learning rate</span>
<span class="n">LR</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="c1"># Verbosity</span>
<span class="n">VERBOSE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># Seed for deterministic results</span>
<span class="c1"># Seed for deterministic results</span>
<span class="n">SEEDS1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="n">SEEDS2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">]</span>
<span class="n">SEEDS3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">]</span>
<span class="n">SEEDS4</span> <span class="o">=</span> <span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">]</span>
<span class="n">SEEDS5</span> <span class="o">=</span> <span class="p">[</span><span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">]</span>

<span class="c1"># Function to seed everything</span>
<span class="k">def</span> <span class="nf">seed_everything</span><span class="p">(</span><span class="n">seed</span><span class="p">):</span>
    <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYTHONHASHSEED&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[68]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mapping_and_filter</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">,</span> <span class="n">test</span><span class="p">):</span>
    <span class="n">cp_type</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;trt_cp&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ctl_vehicle&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
    <span class="n">cp_dose</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;D1&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;D2&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="p">[</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">]:</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cp_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cp_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">cp_type</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cp_dose&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cp_dose&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">cp_dose</span><span class="p">)</span>
    <span class="n">train_targets</span> <span class="o">=</span> <span class="n">train_targets</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;cp_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;cp_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">train_targets</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;sig_id&#39;</span><span class="p">],</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">train</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">,</span> <span class="n">test</span>

<span class="c1"># Function to scale our data</span>
<span class="k">def</span> <span class="nf">scaling</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">):</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
    <span class="n">scaler</span> <span class="o">=</span> <span class="n">RobustScaler</span><span class="p">()</span>
    <span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">[</span><span class="n">features</span><span class="p">],</span> <span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">]],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">train</span><span class="p">[</span><span class="n">features</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
    <span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">features</span>

<span class="c1"># Function to extract pca features</span>
<span class="k">def</span> <span class="nf">fe_pca</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">n_components_g</span> <span class="o">=</span> <span class="mi">70</span><span class="p">,</span> <span class="n">n_components_c</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">SEED</span> <span class="o">=</span> <span class="mi">123</span><span class="p">):</span>
    
    <span class="n">features_g</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">776</span><span class="p">])</span>
    <span class="n">features_c</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">776</span><span class="p">:</span><span class="mi">876</span><span class="p">])</span>
    
    <span class="k">def</span> <span class="nf">create_pca</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">n_components</span> <span class="o">=</span> <span class="n">n_components_g</span><span class="p">):</span>
        <span class="n">train_</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">test_</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train_</span><span class="p">,</span> <span class="n">test_</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span> <span class="o">=</span> <span class="n">n_components</span><span class="p">,</span>  <span class="n">random_state</span> <span class="o">=</span> <span class="n">SEED</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="s1">&#39;pca_</span><span class="si">{kind}</span><span class="s1">{i + 1}&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_components</span><span class="p">)]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="p">)</span>
        <span class="n">train_</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">test_</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">,</span> <span class="n">train_</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">test</span><span class="p">,</span> <span class="n">test_</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span>
    
    <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">create_pca</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">features_g</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">n_components</span> <span class="o">=</span> <span class="n">n_components_g</span><span class="p">)</span>
    <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">create_pca</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">features_c</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">n_components</span> <span class="o">=</span> <span class="n">n_components_c</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span>

<span class="c1"># Function to extract common stats features</span>
<span class="k">def</span> <span class="nf">fe_stats</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">):</span>
    
    <span class="n">features_g</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">776</span><span class="p">])</span>
    <span class="n">features_c</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">776</span><span class="p">:</span><span class="mi">876</span><span class="p">])</span>
    
    <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="p">[</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">]:</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;g_sum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;g_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;g_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;g_kurt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span><span class="p">]</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;g_skew&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span><span class="p">]</span><span class="o">.</span><span class="n">skew</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c_sum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c_kurt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;c_skew&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">skew</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gc_sum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span> <span class="o">+</span> <span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gc_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span> <span class="o">+</span> <span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gc_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span> <span class="o">+</span> <span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gc_kurt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span> <span class="o">+</span> <span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gc_skew&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features_g</span> <span class="o">+</span> <span class="n">features_c</span><span class="p">]</span><span class="o">.</span><span class="n">skew</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span>

<span class="k">def</span> <span class="nf">c_squared</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">):</span>
    
    <span class="n">features_c</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">776</span><span class="p">:</span><span class="mi">876</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="p">[</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">features_c</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{feature}</span><span class="s1">_squared&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span>

<span class="c1"># Function to calculate the mean log loss of the targets including clipping</span>
<span class="k">def</span> <span class="nf">mean_log_loss</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="mf">1e-15</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">1e-15</span><span class="p">)</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">206</span><span class="p">):</span>
        <span class="n">metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">log_loss</span><span class="p">(</span><span class="n">y_true</span><span class="p">[:,</span> <span class="n">target</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">[:,</span> <span class="n">target</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">create_model_rs</span><span class="p">(</span><span class="n">shape1</span><span class="p">,</span> <span class="n">shape2</span><span class="p">):</span>    
    <span class="n">input_1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">shape1</span><span class="p">))</span>
    <span class="n">input_2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">shape2</span><span class="p">))</span>
    
    <span class="n">head_1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">input_1</span><span class="p">)</span>
    <span class="n">head_1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)(</span><span class="n">head_1</span><span class="p">)</span>
    <span class="n">head_1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s2">&quot;elu&quot;</span><span class="p">)(</span><span class="n">head_1</span><span class="p">)</span>
    <span class="n">head_1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">head_1</span><span class="p">)</span>
    <span class="n">input_3</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s2">&quot;elu&quot;</span><span class="p">)(</span><span class="n">head_1</span><span class="p">)</span>

    <span class="n">input_3_concat</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Concatenate</span><span class="p">()([</span><span class="n">input_2</span><span class="p">,</span> <span class="n">input_3</span><span class="p">])</span>
    
    <span class="n">head_2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">input_3_concat</span><span class="p">)</span>
    <span class="n">head_2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)(</span><span class="n">head_2</span><span class="p">)</span>
    <span class="n">head_2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="s2">&quot;relu&quot;</span><span class="p">)(</span><span class="n">head_2</span><span class="p">)</span>
    <span class="n">head_2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">head_2</span><span class="p">)</span>
    <span class="n">head_2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="s2">&quot;elu&quot;</span><span class="p">)(</span><span class="n">head_2</span><span class="p">)</span>
    <span class="n">head_2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">head_2</span><span class="p">)</span>
    <span class="n">head_2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="s2">&quot;relu&quot;</span><span class="p">)(</span><span class="n">head_2</span><span class="p">)</span>
    <span class="n">head_2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">head_2</span><span class="p">)</span>
    <span class="n">input_4</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="s2">&quot;elu&quot;</span><span class="p">)(</span><span class="n">head_2</span><span class="p">)</span>

    <span class="n">input_4_avg</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Average</span><span class="p">()([</span><span class="n">input_3</span><span class="p">,</span> <span class="n">input_4</span><span class="p">])</span> 
    
    <span class="n">head_3</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">input_4_avg</span><span class="p">)</span>
    <span class="n">head_3</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">kernel_initializer</span> <span class="o">=</span> <span class="s1">&#39;lecun_normal&#39;</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;selu&#39;</span><span class="p">)(</span><span class="n">head_3</span><span class="p">)</span>
    <span class="n">head_3</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">head_3</span><span class="p">)</span>
    <span class="n">head_3</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">206</span><span class="p">,</span> <span class="n">kernel_initializer</span> <span class="o">=</span> <span class="s1">&#39;lecun_normal&#39;</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;selu&#39;</span><span class="p">)(</span><span class="n">head_3</span><span class="p">)</span>
    <span class="n">head_3</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">head_3</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">206</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s2">&quot;sigmoid&quot;</span><span class="p">)(</span><span class="n">head_3</span><span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">input_1</span><span class="p">,</span> <span class="n">input_2</span><span class="p">],</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">output</span><span class="p">)</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="n">LR</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">opt</span><span class="p">,</span> 
                  <span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">BinaryCrossentropy</span><span class="p">(</span><span class="n">label_smoothing</span> <span class="o">=</span> <span class="mf">0.0015</span><span class="p">),</span> 
                  <span class="n">metrics</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">BinaryCrossentropy</span><span class="p">())</span>
    
    <span class="k">return</span> <span class="n">model</span>


<span class="c1"># Function to create our 5 layer dnn model</span>
<span class="k">def</span> <span class="nf">create_model_5l</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>
    <span class="n">inp</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">shape</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">inp</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2560</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1524</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1012</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">780</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">206</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;sigmoid&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inp</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">out</span><span class="p">)</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="n">LR</span><span class="p">)</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">tfa</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">SWA</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">opt</span><span class="p">,</span> 
                  <span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">BinaryCrossentropy</span><span class="p">(</span><span class="n">label_smoothing</span> <span class="o">=</span> <span class="mf">0.0020</span><span class="p">),</span>
                  <span class="n">metrics</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">BinaryCrossentropy</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">model</span>

<span class="c1"># Function to create our 4 layer dnn model</span>
<span class="k">def</span> <span class="nf">create_model_4l</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>
    <span class="n">inp</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">shape</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">inp</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1524</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1012</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1012</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">206</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;sigmoid&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inp</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">out</span><span class="p">)</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="n">LR</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">opt</span><span class="p">,</span> 
                  <span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">BinaryCrossentropy</span><span class="p">(</span><span class="n">label_smoothing</span> <span class="o">=</span> <span class="mf">0.0020</span><span class="p">),</span>
                  <span class="n">metrics</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">BinaryCrossentropy</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">model</span>

<span class="c1"># Function to create our 3 layer dnn model</span>
<span class="k">def</span> <span class="nf">create_model_3l</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>
    <span class="n">inp</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">shape</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">inp</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.4914099166744246</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tfa</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">WeightNormalization</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1159</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.18817607797795838</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tfa</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">WeightNormalization</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">960</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.12542057776853896</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tfa</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">WeightNormalization</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1811</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.20175242230280122</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">tfa</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">WeightNormalization</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">206</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;sigmoid&#39;</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inp</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">out</span><span class="p">)</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="n">LR</span><span class="p">)</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">tfa</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Lookahead</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">sync_period</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">opt</span><span class="p">,</span> 
                  <span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">BinaryCrossentropy</span><span class="p">(</span><span class="n">label_smoothing</span> <span class="o">=</span> <span class="mf">0.0015</span><span class="p">),</span>
                  <span class="n">metrics</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">BinaryCrossentropy</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">model</span>

<span class="c1"># Function to create our 2 layer dnn model</span>
<span class="k">def</span> <span class="nf">create_model_2l</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>
    <span class="n">inp</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">shape</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">inp</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2688628097505064</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tfa</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">WeightNormalization</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1292</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.4598218403250696</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tfa</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">WeightNormalization</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">983</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.4703144018483698</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">tfa</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">WeightNormalization</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">206</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;sigmoid&#39;</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inp</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">out</span><span class="p">)</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="n">LR</span><span class="p">)</span>
    <span class="n">opt</span> <span class="o">=</span> <span class="n">tfa</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Lookahead</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">sync_period</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">opt</span><span class="p">,</span> 
                  <span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">BinaryCrossentropy</span><span class="p">(</span><span class="n">label_smoothing</span> <span class="o">=</span> <span class="mf">0.0015</span><span class="p">),</span>
                  <span class="n">metrics</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">BinaryCrossentropy</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">model</span>


<span class="c1"># Function to train our dnn</span>
<span class="k">def</span> <span class="nf">train_and_evaluate</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">start_predictors</span><span class="p">,</span> <span class="n">SEED</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span> <span class="n">MODEL</span> <span class="o">=</span> <span class="s1">&#39;3l&#39;</span><span class="p">):</span>
    <span class="n">seed_everything</span><span class="p">(</span><span class="n">SEED</span><span class="p">)</span>
    <span class="n">oof_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">206</span><span class="p">))</span>
    <span class="n">test_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">206</span><span class="p">))</span>   
    <span class="k">for</span> <span class="n">fold</span><span class="p">,</span> <span class="p">(</span><span class="n">trn_ind</span><span class="p">,</span> <span class="n">val_ind</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">MultilabelStratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span> <span class="o">=</span> <span class="n">FOLDS</span><span class="p">,</span> 
                                                                        <span class="n">random_state</span> <span class="o">=</span> <span class="n">SEED</span><span class="p">,</span> 
                                                                        <span class="n">shuffle</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>\
                                              <span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">train_targets</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">)):</span>
        <span class="n">K</span><span class="o">.</span><span class="n">clear_session</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">MODEL</span> <span class="o">==</span> <span class="s1">&#39;5l&#39;</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">create_model_5l</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">MODEL</span> <span class="o">==</span> <span class="s1">&#39;4l&#39;</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">create_model_4l</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">MODEL</span> <span class="o">==</span> <span class="s1">&#39;3l&#39;</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">create_model_3l</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">MODEL</span> <span class="o">==</span> <span class="s1">&#39;2l&#39;</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">create_model_2l</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">MODEL</span> <span class="o">==</span> <span class="s2">&quot;rs&quot;</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">create_model_rs</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">start_predictors</span><span class="p">))</span>
        
        <span class="n">early_stopping</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span> <span class="o">=</span> <span class="s1">&#39;val_binary_crossentropy&#39;</span><span class="p">,</span>
                                                          <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span>
                                                          <span class="n">patience</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                                                          <span class="n">restore_best_weights</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                                          <span class="n">verbose</span> <span class="o">=</span> <span class="n">VERBOSE</span><span class="p">)</span>
        
        <span class="n">reduce_lr</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">ReduceLROnPlateau</span><span class="p">(</span><span class="n">monitor</span> <span class="o">=</span> <span class="s1">&#39;val_binary_crossentropy&#39;</span><span class="p">,</span>
                                                         <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span>
                                                         <span class="n">factor</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
                                                         <span class="n">patience</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
                                                         <span class="n">verbose</span> <span class="o">=</span> <span class="n">VERBOSE</span><span class="p">)</span>
        
        <span class="n">checkpoint</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">ModelCheckpoint</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{MODEL}</span><span class="s1">_</span><span class="si">{fold}</span><span class="s1">_</span><span class="si">{SEED}</span><span class="s1">.h5&#39;</span><span class="p">,</span>
                                                        <span class="n">monitor</span> <span class="o">=</span> <span class="s1">&#39;val_binary_crossentropy&#39;</span><span class="p">,</span>
                                                        <span class="n">verbose</span> <span class="o">=</span> <span class="n">VERBOSE</span><span class="p">,</span>
                                                        <span class="n">save_best_only</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                                        <span class="n">save_weights_only</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        
        <span class="n">x_train</span><span class="p">,</span> <span class="n">x_val</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">trn_ind</span><span class="p">],</span> <span class="n">train</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">val_ind</span><span class="p">]</span>
        <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_targets</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">trn_ind</span><span class="p">],</span> <span class="n">train_targets</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">val_ind</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">MODEL</span> <span class="o">==</span> <span class="s2">&quot;rs&quot;</span><span class="p">:</span>
            <span class="n">x_train_</span><span class="p">,</span> <span class="n">x_val_</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">start_predictors</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">trn_ind</span><span class="p">],</span> <span class="n">train</span><span class="p">[</span><span class="n">start_predictors</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">val_ind</span><span class="p">]</span>

            <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">x_train</span><span class="p">,</span> <span class="n">x_train_</span><span class="p">],</span> <span class="n">y_train</span><span class="p">,</span>
                  <span class="n">validation_data</span> <span class="o">=</span> <span class="p">([</span><span class="n">x_val</span><span class="p">,</span> <span class="n">x_val_</span><span class="p">],</span> <span class="n">y_val</span><span class="p">),</span>
                  <span class="n">epochs</span> <span class="o">=</span> <span class="n">EPOCHS</span><span class="p">,</span> 
                  <span class="n">batch_size</span> <span class="o">=</span> <span class="n">BATCH_SIZE</span><span class="p">,</span>
                  <span class="n">callbacks</span> <span class="o">=</span> <span class="p">[</span><span class="n">early_stopping</span><span class="p">,</span> <span class="n">reduce_lr</span><span class="p">,</span>  <span class="n">checkpoint</span><span class="p">],</span>
                  <span class="n">verbose</span> <span class="o">=</span> <span class="n">VERBOSE</span><span class="p">)</span>
        
            <span class="n">model</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{MODEL}</span><span class="s1">_</span><span class="si">{fold}</span><span class="s1">_</span><span class="si">{SEED}</span><span class="s1">.h5&#39;</span><span class="p">)</span>

            <span class="n">oof_pred</span><span class="p">[</span><span class="n">val_ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">x_val</span><span class="p">,</span> <span class="n">x_val_</span><span class="p">])</span>
            <span class="n">test_pred</span> <span class="o">+=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">test</span><span class="p">[</span><span class="n">start_predictors</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])</span> <span class="o">/</span> <span class="n">FOLDS</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
                  <span class="n">validation_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">),</span>
                  <span class="n">epochs</span> <span class="o">=</span> <span class="n">EPOCHS</span><span class="p">,</span> 
                  <span class="n">batch_size</span> <span class="o">=</span> <span class="n">BATCH_SIZE</span><span class="p">,</span>
                  <span class="n">callbacks</span> <span class="o">=</span> <span class="p">[</span><span class="n">early_stopping</span><span class="p">,</span> <span class="n">reduce_lr</span><span class="p">,</span>  <span class="n">checkpoint</span><span class="p">],</span>
                  <span class="n">verbose</span> <span class="o">=</span> <span class="n">VERBOSE</span><span class="p">)</span>
        
            <span class="n">model</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{MODEL}</span><span class="s1">_</span><span class="si">{fold}</span><span class="s1">_</span><span class="si">{SEED}</span><span class="s1">.h5&#39;</span><span class="p">)</span>

            <span class="n">oof_pred</span><span class="p">[</span><span class="n">val_ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_val</span><span class="p">)</span>
            <span class="n">test_pred</span> <span class="o">+=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">/</span> <span class="n">FOLDS</span>


    <span class="n">oof_score</span> <span class="o">=</span> <span class="n">mean_log_loss</span><span class="p">(</span><span class="n">train_targets</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">oof_pred</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Our out of folds mean log loss score is </span><span class="si">{oof_score}</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">test_pred</span><span class="p">,</span> <span class="n">oof_pred</span>

<span class="c1"># Function to train our dnn</span>
<span class="k">def</span> <span class="nf">inference</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">start_predictors</span><span class="p">,</span> <span class="n">SEED</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span> <span class="n">MODEL</span> <span class="o">=</span> <span class="s1">&#39;3l&#39;</span><span class="p">,</span> <span class="n">PATH</span> <span class="o">=</span> <span class="s1">&#39;../input/moa-3layer&#39;</span><span class="p">):</span>
    <span class="n">seed_everything</span><span class="p">(</span><span class="n">SEED</span><span class="p">)</span>
    <span class="n">oof_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">206</span><span class="p">))</span>
    <span class="n">test_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">206</span><span class="p">))</span>   
    <span class="k">for</span> <span class="n">fold</span><span class="p">,</span> <span class="p">(</span><span class="n">trn_ind</span><span class="p">,</span> <span class="n">val_ind</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">MultilabelStratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span> <span class="o">=</span> <span class="n">FOLDS</span><span class="p">,</span> 
                                                                        <span class="n">random_state</span> <span class="o">=</span> <span class="n">SEED</span><span class="p">,</span> 
                                                                        <span class="n">shuffle</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>\
                                              <span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">train_targets</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">)):</span>
        <span class="n">K</span><span class="o">.</span><span class="n">clear_session</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">MODEL</span> <span class="o">==</span> <span class="s1">&#39;5l&#39;</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">create_model_5l</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">MODEL</span> <span class="o">==</span> <span class="s1">&#39;4l&#39;</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">create_model_4l</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">MODEL</span> <span class="o">==</span> <span class="s1">&#39;3l&#39;</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">create_model_3l</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">MODEL</span> <span class="o">==</span> <span class="s1">&#39;2l&#39;</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">create_model_2l</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">MODEL</span> <span class="o">==</span> <span class="s2">&quot;rs&quot;</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">create_model_rs</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">start_predictors</span><span class="p">))</span>


        <span class="n">x_train</span><span class="p">,</span> <span class="n">x_val</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">trn_ind</span><span class="p">],</span> <span class="n">train</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">val_ind</span><span class="p">]</span>
        <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_targets</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">trn_ind</span><span class="p">],</span> <span class="n">train_targets</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">val_ind</span><span class="p">]</span>
        
        <span class="n">model</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="s1">&#39;../input/moa-5seed/Model_Weights&#39;</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">MODEL</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">fold</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">SEED</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.h5&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">MODEL</span> <span class="o">==</span> <span class="s2">&quot;rs&quot;</span><span class="p">:</span>
            <span class="n">x_train_</span><span class="p">,</span> <span class="n">x_val_</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">start_predictors</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">trn_ind</span><span class="p">],</span> <span class="n">train</span><span class="p">[</span><span class="n">start_predictors</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">val_ind</span><span class="p">]</span>
            <span class="n">oof_pred</span><span class="p">[</span><span class="n">val_ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">x_val</span><span class="p">,</span> <span class="n">x_val_</span><span class="p">])</span>
            <span class="n">test_pred</span> <span class="o">+=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">test</span><span class="p">[</span><span class="n">start_predictors</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">])</span> <span class="o">/</span> <span class="n">FOLDS</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">oof_pred</span><span class="p">[</span><span class="n">val_ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_val</span><span class="p">)</span>
            <span class="n">test_pred</span> <span class="o">+=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">/</span> <span class="n">FOLDS</span>

    <span class="n">oof_score</span> <span class="o">=</span> <span class="n">mean_log_loss</span><span class="p">(</span><span class="n">train_targets</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">oof_pred</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Our out of folds mean log loss score is </span><span class="si">{oof_score}</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">test_pred</span><span class="p">,</span> <span class="n">oof_pred</span>
    
    

<span class="c1"># Function to train our model with multiple seeds and average the predictions</span>
<span class="k">def</span> <span class="nf">run_multiple_seeds</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">start_predictors</span><span class="p">,</span> <span class="n">SEEDS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">123</span><span class="p">],</span> <span class="n">MODEL</span> <span class="o">=</span> <span class="s1">&#39;3l&#39;</span><span class="p">,</span> <span class="n">PATH</span> <span class="o">=</span> <span class="s1">&#39;../input/moa-3layer&#39;</span><span class="p">):</span>
    
    <span class="n">test_pred</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">oof_pred</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">SEED</span> <span class="ow">in</span> <span class="n">SEEDS</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Using model </span><span class="si">{MODEL}</span><span class="s1"> with seed </span><span class="si">{SEED}</span><span class="s1"> for inference&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Trained with {len(features)} features&#39;</span><span class="p">)</span>
        <span class="n">test_pred_</span><span class="p">,</span> <span class="n">oof_pred_</span> <span class="o">=</span> <span class="n">inference</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">start_predictors</span><span class="p">,</span> <span class="n">SEED</span> <span class="o">=</span> <span class="n">SEED</span><span class="p">,</span> <span class="n">MODEL</span> <span class="o">=</span> <span class="n">MODEL</span><span class="p">,</span> <span class="n">PATH</span> <span class="o">=</span> <span class="n">PATH</span><span class="p">)</span>
        <span class="n">test_pred</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_pred_</span><span class="p">)</span>
        <span class="n">oof_pred</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oof_pred_</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        
    <span class="n">test_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">test_pred</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">oof_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">oof_pred</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        
    <span class="n">seed_log_loss</span> <span class="o">=</span> <span class="n">mean_log_loss</span><span class="p">(</span><span class="n">train_targets</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">oof_pred</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Our out of folds log loss for our seed blend model is </span><span class="si">{seed_log_loss}</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">test_pred</span><span class="p">,</span> <span class="n">oof_pred</span>

<span class="k">def</span> <span class="nf">submission</span><span class="p">(</span><span class="n">test_pred</span><span class="p">):</span>
    <span class="n">sample_submission</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">train_targets</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_pred</span>
    <span class="n">sample_submission</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;cp_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">train_targets</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">sample_submission</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;submission.csv&#39;</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sample_submission</span>

<span class="c1"># Got this predictors from public kernels for the resnet type model</span>
<span class="n">start_predictors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;g-0&quot;</span><span class="p">,</span> <span class="s2">&quot;g-7&quot;</span><span class="p">,</span> <span class="s2">&quot;g-8&quot;</span><span class="p">,</span> <span class="s2">&quot;g-10&quot;</span><span class="p">,</span> <span class="s2">&quot;g-13&quot;</span><span class="p">,</span> <span class="s2">&quot;g-17&quot;</span><span class="p">,</span> <span class="s2">&quot;g-20&quot;</span><span class="p">,</span> <span class="s2">&quot;g-22&quot;</span><span class="p">,</span> <span class="s2">&quot;g-24&quot;</span><span class="p">,</span> <span class="s2">&quot;g-26&quot;</span><span class="p">,</span> <span class="s2">&quot;g-28&quot;</span><span class="p">,</span> <span class="s2">&quot;g-29&quot;</span><span class="p">,</span> <span class="s2">&quot;g-30&quot;</span><span class="p">,</span> <span class="s2">&quot;g-31&quot;</span><span class="p">,</span> <span class="s2">&quot;g-32&quot;</span><span class="p">,</span> <span class="s2">&quot;g-34&quot;</span><span class="p">,</span> <span class="s2">&quot;g-35&quot;</span><span class="p">,</span> <span class="s2">&quot;g-36&quot;</span><span class="p">,</span> <span class="s2">&quot;g-37&quot;</span><span class="p">,</span> <span class="s2">&quot;g-38&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;g-39&quot;</span><span class="p">,</span><span class="s2">&quot;g-41&quot;</span><span class="p">,</span> <span class="s2">&quot;g-46&quot;</span><span class="p">,</span> <span class="s2">&quot;g-48&quot;</span><span class="p">,</span> <span class="s2">&quot;g-50&quot;</span><span class="p">,</span> <span class="s2">&quot;g-51&quot;</span><span class="p">,</span> <span class="s2">&quot;g-52&quot;</span><span class="p">,</span> <span class="s2">&quot;g-55&quot;</span><span class="p">,</span> <span class="s2">&quot;g-58&quot;</span><span class="p">,</span> <span class="s2">&quot;g-59&quot;</span><span class="p">,</span> <span class="s2">&quot;g-61&quot;</span><span class="p">,</span> <span class="s2">&quot;g-62&quot;</span><span class="p">,</span> <span class="s2">&quot;g-63&quot;</span><span class="p">,</span> <span class="s2">&quot;g-65&quot;</span><span class="p">,</span> <span class="s2">&quot;g-66&quot;</span><span class="p">,</span> <span class="s2">&quot;g-67&quot;</span><span class="p">,</span> <span class="s2">&quot;g-68&quot;</span><span class="p">,</span> <span class="s2">&quot;g-70&quot;</span><span class="p">,</span> <span class="s2">&quot;g-72&quot;</span><span class="p">,</span> <span class="s2">&quot;g-74&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;g-75&quot;</span><span class="p">,</span> <span class="s2">&quot;g-79&quot;</span><span class="p">,</span> <span class="s2">&quot;g-83&quot;</span><span class="p">,</span> <span class="s2">&quot;g-84&quot;</span><span class="p">,</span> <span class="s2">&quot;g-85&quot;</span><span class="p">,</span> <span class="s2">&quot;g-86&quot;</span><span class="p">,</span> <span class="s2">&quot;g-90&quot;</span><span class="p">,</span> <span class="s2">&quot;g-91&quot;</span><span class="p">,</span> <span class="s2">&quot;g-94&quot;</span><span class="p">,</span> <span class="s2">&quot;g-95&quot;</span><span class="p">,</span> <span class="s2">&quot;g-96&quot;</span><span class="p">,</span> <span class="s2">&quot;g-97&quot;</span><span class="p">,</span> <span class="s2">&quot;g-98&quot;</span><span class="p">,</span> <span class="s2">&quot;g-100&quot;</span><span class="p">,</span> <span class="s2">&quot;g-102&quot;</span><span class="p">,</span> <span class="s2">&quot;g-105&quot;</span><span class="p">,</span> <span class="s2">&quot;g-106&quot;</span><span class="p">,</span> <span class="s2">&quot;g-112&quot;</span><span class="p">,</span> <span class="s2">&quot;g-113&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;g-114&quot;</span><span class="p">,</span> <span class="s2">&quot;g-116&quot;</span><span class="p">,</span> <span class="s2">&quot;g-121&quot;</span><span class="p">,</span> <span class="s2">&quot;g-123&quot;</span><span class="p">,</span> <span class="s2">&quot;g-126&quot;</span><span class="p">,</span> <span class="s2">&quot;g-128&quot;</span><span class="p">,</span> <span class="s2">&quot;g-131&quot;</span><span class="p">,</span> <span class="s2">&quot;g-132&quot;</span><span class="p">,</span> <span class="s2">&quot;g-134&quot;</span><span class="p">,</span> <span class="s2">&quot;g-135&quot;</span><span class="p">,</span> <span class="s2">&quot;g-138&quot;</span><span class="p">,</span> <span class="s2">&quot;g-139&quot;</span><span class="p">,</span> <span class="s2">&quot;g-140&quot;</span><span class="p">,</span> <span class="s2">&quot;g-142&quot;</span><span class="p">,</span> <span class="s2">&quot;g-144&quot;</span><span class="p">,</span> <span class="s2">&quot;g-145&quot;</span><span class="p">,</span> <span class="s2">&quot;g-146&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;g-147&quot;</span><span class="p">,</span> <span class="s2">&quot;g-148&quot;</span><span class="p">,</span> <span class="s2">&quot;g-152&quot;</span><span class="p">,</span> <span class="s2">&quot;g-155&quot;</span><span class="p">,</span> <span class="s2">&quot;g-157&quot;</span><span class="p">,</span> <span class="s2">&quot;g-158&quot;</span><span class="p">,</span> <span class="s2">&quot;g-160&quot;</span><span class="p">,</span> <span class="s2">&quot;g-163&quot;</span><span class="p">,</span> <span class="s2">&quot;g-164&quot;</span><span class="p">,</span> <span class="s2">&quot;g-165&quot;</span><span class="p">,</span> <span class="s2">&quot;g-170&quot;</span><span class="p">,</span> <span class="s2">&quot;g-173&quot;</span><span class="p">,</span> <span class="s2">&quot;g-174&quot;</span><span class="p">,</span> <span class="s2">&quot;g-175&quot;</span><span class="p">,</span> <span class="s2">&quot;g-177&quot;</span><span class="p">,</span> <span class="s2">&quot;g-178&quot;</span><span class="p">,</span> <span class="s2">&quot;g-181&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;g-183&quot;</span><span class="p">,</span> <span class="s2">&quot;g-185&quot;</span><span class="p">,</span> <span class="s2">&quot;g-186&quot;</span><span class="p">,</span> <span class="s2">&quot;g-189&quot;</span><span class="p">,</span> <span class="s2">&quot;g-192&quot;</span><span class="p">,</span> <span class="s2">&quot;g-194&quot;</span><span class="p">,</span> <span class="s2">&quot;g-195&quot;</span><span class="p">,</span> <span class="s2">&quot;g-196&quot;</span><span class="p">,</span> <span class="s2">&quot;g-197&quot;</span><span class="p">,</span> <span class="s2">&quot;g-199&quot;</span><span class="p">,</span> <span class="s2">&quot;g-201&quot;</span><span class="p">,</span> <span class="s2">&quot;g-202&quot;</span><span class="p">,</span> <span class="s2">&quot;g-206&quot;</span><span class="p">,</span> <span class="s2">&quot;g-208&quot;</span><span class="p">,</span> <span class="s2">&quot;g-210&quot;</span><span class="p">,</span> <span class="s2">&quot;g-213&quot;</span><span class="p">,</span> <span class="s2">&quot;g-214&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;g-215&quot;</span><span class="p">,</span> <span class="s2">&quot;g-220&quot;</span><span class="p">,</span> <span class="s2">&quot;g-226&quot;</span><span class="p">,</span> <span class="s2">&quot;g-228&quot;</span><span class="p">,</span> <span class="s2">&quot;g-229&quot;</span><span class="p">,</span> <span class="s2">&quot;g-235&quot;</span><span class="p">,</span> <span class="s2">&quot;g-238&quot;</span><span class="p">,</span> <span class="s2">&quot;g-241&quot;</span><span class="p">,</span> <span class="s2">&quot;g-242&quot;</span><span class="p">,</span> <span class="s2">&quot;g-243&quot;</span><span class="p">,</span> <span class="s2">&quot;g-244&quot;</span><span class="p">,</span> <span class="s2">&quot;g-245&quot;</span><span class="p">,</span> <span class="s2">&quot;g-248&quot;</span><span class="p">,</span> <span class="s2">&quot;g-250&quot;</span><span class="p">,</span> <span class="s2">&quot;g-251&quot;</span><span class="p">,</span> <span class="s2">&quot;g-254&quot;</span><span class="p">,</span> <span class="s2">&quot;g-257&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;g-259&quot;</span><span class="p">,</span> <span class="s2">&quot;g-261&quot;</span><span class="p">,</span> <span class="s2">&quot;g-266&quot;</span><span class="p">,</span> <span class="s2">&quot;g-270&quot;</span><span class="p">,</span> <span class="s2">&quot;g-271&quot;</span><span class="p">,</span> <span class="s2">&quot;g-272&quot;</span><span class="p">,</span> <span class="s2">&quot;g-275&quot;</span><span class="p">,</span> <span class="s2">&quot;g-278&quot;</span><span class="p">,</span> <span class="s2">&quot;g-282&quot;</span><span class="p">,</span> <span class="s2">&quot;g-287&quot;</span><span class="p">,</span> <span class="s2">&quot;g-288&quot;</span><span class="p">,</span> <span class="s2">&quot;g-289&quot;</span><span class="p">,</span> <span class="s2">&quot;g-291&quot;</span><span class="p">,</span> <span class="s2">&quot;g-293&quot;</span><span class="p">,</span> <span class="s2">&quot;g-294&quot;</span><span class="p">,</span> <span class="s2">&quot;g-297&quot;</span><span class="p">,</span> <span class="s2">&quot;g-298&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;g-301&quot;</span><span class="p">,</span> <span class="s2">&quot;g-303&quot;</span><span class="p">,</span> <span class="s2">&quot;g-304&quot;</span><span class="p">,</span> <span class="s2">&quot;g-306&quot;</span><span class="p">,</span> <span class="s2">&quot;g-308&quot;</span><span class="p">,</span> <span class="s2">&quot;g-309&quot;</span><span class="p">,</span> <span class="s2">&quot;g-310&quot;</span><span class="p">,</span> <span class="s2">&quot;g-311&quot;</span><span class="p">,</span> <span class="s2">&quot;g-314&quot;</span><span class="p">,</span> <span class="s2">&quot;g-315&quot;</span><span class="p">,</span> <span class="s2">&quot;g-316&quot;</span><span class="p">,</span> <span class="s2">&quot;g-317&quot;</span><span class="p">,</span> <span class="s2">&quot;g-320&quot;</span><span class="p">,</span> <span class="s2">&quot;g-321&quot;</span><span class="p">,</span> <span class="s2">&quot;g-322&quot;</span><span class="p">,</span> <span class="s2">&quot;g-327&quot;</span><span class="p">,</span> <span class="s2">&quot;g-328&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;g-329&quot;</span><span class="p">,</span> <span class="s2">&quot;g-332&quot;</span><span class="p">,</span> <span class="s2">&quot;g-334&quot;</span><span class="p">,</span> <span class="s2">&quot;g-335&quot;</span><span class="p">,</span> <span class="s2">&quot;g-336&quot;</span><span class="p">,</span> <span class="s2">&quot;g-337&quot;</span><span class="p">,</span> <span class="s2">&quot;g-339&quot;</span><span class="p">,</span> <span class="s2">&quot;g-342&quot;</span><span class="p">,</span> <span class="s2">&quot;g-344&quot;</span><span class="p">,</span> <span class="s2">&quot;g-349&quot;</span><span class="p">,</span> <span class="s2">&quot;g-350&quot;</span><span class="p">,</span> <span class="s2">&quot;g-351&quot;</span><span class="p">,</span> <span class="s2">&quot;g-353&quot;</span><span class="p">,</span> <span class="s2">&quot;g-354&quot;</span><span class="p">,</span> <span class="s2">&quot;g-355&quot;</span><span class="p">,</span> <span class="s2">&quot;g-357&quot;</span><span class="p">,</span> <span class="s2">&quot;g-359&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;g-360&quot;</span><span class="p">,</span> <span class="s2">&quot;g-364&quot;</span><span class="p">,</span> <span class="s2">&quot;g-365&quot;</span><span class="p">,</span> <span class="s2">&quot;g-366&quot;</span><span class="p">,</span> <span class="s2">&quot;g-367&quot;</span><span class="p">,</span> <span class="s2">&quot;g-368&quot;</span><span class="p">,</span> <span class="s2">&quot;g-369&quot;</span><span class="p">,</span> <span class="s2">&quot;g-374&quot;</span><span class="p">,</span> <span class="s2">&quot;g-375&quot;</span><span class="p">,</span> <span class="s2">&quot;g-377&quot;</span><span class="p">,</span> <span class="s2">&quot;g-379&quot;</span><span class="p">,</span> <span class="s2">&quot;g-385&quot;</span><span class="p">,</span> <span class="s2">&quot;g-386&quot;</span><span class="p">,</span> <span class="s2">&quot;g-390&quot;</span><span class="p">,</span> <span class="s2">&quot;g-392&quot;</span><span class="p">,</span> <span class="s2">&quot;g-393&quot;</span><span class="p">,</span> <span class="s2">&quot;g-400&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;g-402&quot;</span><span class="p">,</span> <span class="s2">&quot;g-406&quot;</span><span class="p">,</span> <span class="s2">&quot;g-407&quot;</span><span class="p">,</span> <span class="s2">&quot;g-409&quot;</span><span class="p">,</span> <span class="s2">&quot;g-410&quot;</span><span class="p">,</span> <span class="s2">&quot;g-411&quot;</span><span class="p">,</span> <span class="s2">&quot;g-414&quot;</span><span class="p">,</span> <span class="s2">&quot;g-417&quot;</span><span class="p">,</span> <span class="s2">&quot;g-418&quot;</span><span class="p">,</span> <span class="s2">&quot;g-421&quot;</span><span class="p">,</span> <span class="s2">&quot;g-423&quot;</span><span class="p">,</span> <span class="s2">&quot;g-424&quot;</span><span class="p">,</span> <span class="s2">&quot;g-427&quot;</span><span class="p">,</span> <span class="s2">&quot;g-429&quot;</span><span class="p">,</span> <span class="s2">&quot;g-431&quot;</span><span class="p">,</span> <span class="s2">&quot;g-432&quot;</span><span class="p">,</span> <span class="s2">&quot;g-433&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;g-434&quot;</span><span class="p">,</span> <span class="s2">&quot;g-437&quot;</span><span class="p">,</span> <span class="s2">&quot;g-439&quot;</span><span class="p">,</span> <span class="s2">&quot;g-440&quot;</span><span class="p">,</span> <span class="s2">&quot;g-443&quot;</span><span class="p">,</span> <span class="s2">&quot;g-449&quot;</span><span class="p">,</span> <span class="s2">&quot;g-458&quot;</span><span class="p">,</span> <span class="s2">&quot;g-459&quot;</span><span class="p">,</span> <span class="s2">&quot;g-460&quot;</span><span class="p">,</span> <span class="s2">&quot;g-461&quot;</span><span class="p">,</span> <span class="s2">&quot;g-464&quot;</span><span class="p">,</span> <span class="s2">&quot;g-467&quot;</span><span class="p">,</span> <span class="s2">&quot;g-468&quot;</span><span class="p">,</span> <span class="s2">&quot;g-470&quot;</span><span class="p">,</span> <span class="s2">&quot;g-473&quot;</span><span class="p">,</span> <span class="s2">&quot;g-477&quot;</span><span class="p">,</span> <span class="s2">&quot;g-478&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;g-479&quot;</span><span class="p">,</span> <span class="s2">&quot;g-484&quot;</span><span class="p">,</span> <span class="s2">&quot;g-485&quot;</span><span class="p">,</span> <span class="s2">&quot;g-486&quot;</span><span class="p">,</span> <span class="s2">&quot;g-488&quot;</span><span class="p">,</span> <span class="s2">&quot;g-489&quot;</span><span class="p">,</span> <span class="s2">&quot;g-491&quot;</span><span class="p">,</span> <span class="s2">&quot;g-494&quot;</span><span class="p">,</span> <span class="s2">&quot;g-496&quot;</span><span class="p">,</span> <span class="s2">&quot;g-498&quot;</span><span class="p">,</span> <span class="s2">&quot;g-500&quot;</span><span class="p">,</span> <span class="s2">&quot;g-503&quot;</span><span class="p">,</span> <span class="s2">&quot;g-504&quot;</span><span class="p">,</span> <span class="s2">&quot;g-506&quot;</span><span class="p">,</span> <span class="s2">&quot;g-508&quot;</span><span class="p">,</span> <span class="s2">&quot;g-509&quot;</span><span class="p">,</span> <span class="s2">&quot;g-512&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;g-522&quot;</span><span class="p">,</span> <span class="s2">&quot;g-529&quot;</span><span class="p">,</span> <span class="s2">&quot;g-531&quot;</span><span class="p">,</span> <span class="s2">&quot;g-534&quot;</span><span class="p">,</span> <span class="s2">&quot;g-539&quot;</span><span class="p">,</span> <span class="s2">&quot;g-541&quot;</span><span class="p">,</span> <span class="s2">&quot;g-546&quot;</span><span class="p">,</span> <span class="s2">&quot;g-551&quot;</span><span class="p">,</span> <span class="s2">&quot;g-553&quot;</span><span class="p">,</span> <span class="s2">&quot;g-554&quot;</span><span class="p">,</span> <span class="s2">&quot;g-559&quot;</span><span class="p">,</span> <span class="s2">&quot;g-561&quot;</span><span class="p">,</span> <span class="s2">&quot;g-562&quot;</span><span class="p">,</span> <span class="s2">&quot;g-565&quot;</span><span class="p">,</span> <span class="s2">&quot;g-568&quot;</span><span class="p">,</span> <span class="s2">&quot;g-569&quot;</span><span class="p">,</span> <span class="s2">&quot;g-574&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;g-577&quot;</span><span class="p">,</span> <span class="s2">&quot;g-578&quot;</span><span class="p">,</span> <span class="s2">&quot;g-586&quot;</span><span class="p">,</span> <span class="s2">&quot;g-588&quot;</span><span class="p">,</span> <span class="s2">&quot;g-590&quot;</span><span class="p">,</span> <span class="s2">&quot;g-594&quot;</span><span class="p">,</span> <span class="s2">&quot;g-595&quot;</span><span class="p">,</span> <span class="s2">&quot;g-596&quot;</span><span class="p">,</span> <span class="s2">&quot;g-597&quot;</span><span class="p">,</span> <span class="s2">&quot;g-599&quot;</span><span class="p">,</span> <span class="s2">&quot;g-600&quot;</span><span class="p">,</span> <span class="s2">&quot;g-603&quot;</span><span class="p">,</span> <span class="s2">&quot;g-607&quot;</span><span class="p">,</span> <span class="s2">&quot;g-615&quot;</span><span class="p">,</span> <span class="s2">&quot;g-618&quot;</span><span class="p">,</span> <span class="s2">&quot;g-619&quot;</span><span class="p">,</span> <span class="s2">&quot;g-620&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;g-625&quot;</span><span class="p">,</span> <span class="s2">&quot;g-628&quot;</span><span class="p">,</span> <span class="s2">&quot;g-629&quot;</span><span class="p">,</span> <span class="s2">&quot;g-632&quot;</span><span class="p">,</span> <span class="s2">&quot;g-634&quot;</span><span class="p">,</span> <span class="s2">&quot;g-635&quot;</span><span class="p">,</span> <span class="s2">&quot;g-636&quot;</span><span class="p">,</span> <span class="s2">&quot;g-638&quot;</span><span class="p">,</span> <span class="s2">&quot;g-639&quot;</span><span class="p">,</span> <span class="s2">&quot;g-641&quot;</span><span class="p">,</span> <span class="s2">&quot;g-643&quot;</span><span class="p">,</span> <span class="s2">&quot;g-644&quot;</span><span class="p">,</span> <span class="s2">&quot;g-645&quot;</span><span class="p">,</span> <span class="s2">&quot;g-646&quot;</span><span class="p">,</span> <span class="s2">&quot;g-647&quot;</span><span class="p">,</span> <span class="s2">&quot;g-648&quot;</span><span class="p">,</span> <span class="s2">&quot;g-663&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;g-664&quot;</span><span class="p">,</span> <span class="s2">&quot;g-665&quot;</span><span class="p">,</span> <span class="s2">&quot;g-668&quot;</span><span class="p">,</span> <span class="s2">&quot;g-669&quot;</span><span class="p">,</span> <span class="s2">&quot;g-670&quot;</span><span class="p">,</span> <span class="s2">&quot;g-671&quot;</span><span class="p">,</span> <span class="s2">&quot;g-672&quot;</span><span class="p">,</span> <span class="s2">&quot;g-673&quot;</span><span class="p">,</span> <span class="s2">&quot;g-674&quot;</span><span class="p">,</span> <span class="s2">&quot;g-677&quot;</span><span class="p">,</span> <span class="s2">&quot;g-678&quot;</span><span class="p">,</span> <span class="s2">&quot;g-680&quot;</span><span class="p">,</span> <span class="s2">&quot;g-683&quot;</span><span class="p">,</span> <span class="s2">&quot;g-689&quot;</span><span class="p">,</span> <span class="s2">&quot;g-691&quot;</span><span class="p">,</span> <span class="s2">&quot;g-693&quot;</span><span class="p">,</span> <span class="s2">&quot;g-695&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;g-701&quot;</span><span class="p">,</span> <span class="s2">&quot;g-702&quot;</span><span class="p">,</span> <span class="s2">&quot;g-703&quot;</span><span class="p">,</span> <span class="s2">&quot;g-704&quot;</span><span class="p">,</span> <span class="s2">&quot;g-705&quot;</span><span class="p">,</span> <span class="s2">&quot;g-706&quot;</span><span class="p">,</span> <span class="s2">&quot;g-708&quot;</span><span class="p">,</span> <span class="s2">&quot;g-711&quot;</span><span class="p">,</span> <span class="s2">&quot;g-712&quot;</span><span class="p">,</span> <span class="s2">&quot;g-720&quot;</span><span class="p">,</span> <span class="s2">&quot;g-721&quot;</span><span class="p">,</span> <span class="s2">&quot;g-723&quot;</span><span class="p">,</span> <span class="s2">&quot;g-724&quot;</span><span class="p">,</span> <span class="s2">&quot;g-726&quot;</span><span class="p">,</span> <span class="s2">&quot;g-728&quot;</span><span class="p">,</span> <span class="s2">&quot;g-731&quot;</span><span class="p">,</span> <span class="s2">&quot;g-733&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;g-738&quot;</span><span class="p">,</span> <span class="s2">&quot;g-739&quot;</span><span class="p">,</span> <span class="s2">&quot;g-742&quot;</span><span class="p">,</span> <span class="s2">&quot;g-743&quot;</span><span class="p">,</span> <span class="s2">&quot;g-744&quot;</span><span class="p">,</span> <span class="s2">&quot;g-745&quot;</span><span class="p">,</span> <span class="s2">&quot;g-749&quot;</span><span class="p">,</span> <span class="s2">&quot;g-750&quot;</span><span class="p">,</span> <span class="s2">&quot;g-752&quot;</span><span class="p">,</span> <span class="s2">&quot;g-760&quot;</span><span class="p">,</span> <span class="s2">&quot;g-761&quot;</span><span class="p">,</span> <span class="s2">&quot;g-764&quot;</span><span class="p">,</span> <span class="s2">&quot;g-766&quot;</span><span class="p">,</span> <span class="s2">&quot;g-768&quot;</span><span class="p">,</span> <span class="s2">&quot;g-770&quot;</span><span class="p">,</span> <span class="s2">&quot;g-771&quot;</span><span class="p">,</span> <span class="s2">&quot;c-0&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;c-1&quot;</span><span class="p">,</span> <span class="s2">&quot;c-2&quot;</span><span class="p">,</span> <span class="s2">&quot;c-3&quot;</span><span class="p">,</span> <span class="s2">&quot;c-4&quot;</span><span class="p">,</span> <span class="s2">&quot;c-5&quot;</span><span class="p">,</span> <span class="s2">&quot;c-6&quot;</span><span class="p">,</span> <span class="s2">&quot;c-7&quot;</span><span class="p">,</span> <span class="s2">&quot;c-8&quot;</span><span class="p">,</span> <span class="s2">&quot;c-9&quot;</span><span class="p">,</span> <span class="s2">&quot;c-10&quot;</span><span class="p">,</span> <span class="s2">&quot;c-11&quot;</span><span class="p">,</span> <span class="s2">&quot;c-12&quot;</span><span class="p">,</span> <span class="s2">&quot;c-13&quot;</span><span class="p">,</span> <span class="s2">&quot;c-14&quot;</span><span class="p">,</span> <span class="s2">&quot;c-15&quot;</span><span class="p">,</span> <span class="s2">&quot;c-16&quot;</span><span class="p">,</span> <span class="s2">&quot;c-17&quot;</span><span class="p">,</span> <span class="s2">&quot;c-18&quot;</span><span class="p">,</span> <span class="s2">&quot;c-19&quot;</span><span class="p">,</span> <span class="s2">&quot;c-20&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;c-21&quot;</span><span class="p">,</span> <span class="s2">&quot;c-22&quot;</span><span class="p">,</span> <span class="s2">&quot;c-23&quot;</span><span class="p">,</span> <span class="s2">&quot;c-24&quot;</span><span class="p">,</span> <span class="s2">&quot;c-25&quot;</span><span class="p">,</span> <span class="s2">&quot;c-26&quot;</span><span class="p">,</span> <span class="s2">&quot;c-27&quot;</span><span class="p">,</span> <span class="s2">&quot;c-28&quot;</span><span class="p">,</span> <span class="s2">&quot;c-29&quot;</span><span class="p">,</span> <span class="s2">&quot;c-30&quot;</span><span class="p">,</span> <span class="s2">&quot;c-31&quot;</span><span class="p">,</span> <span class="s2">&quot;c-32&quot;</span><span class="p">,</span> <span class="s2">&quot;c-33&quot;</span><span class="p">,</span> <span class="s2">&quot;c-34&quot;</span><span class="p">,</span> <span class="s2">&quot;c-35&quot;</span><span class="p">,</span> <span class="s2">&quot;c-36&quot;</span><span class="p">,</span> <span class="s2">&quot;c-37&quot;</span><span class="p">,</span> <span class="s2">&quot;c-38&quot;</span><span class="p">,</span> <span class="s2">&quot;c-39&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;c-40&quot;</span><span class="p">,</span> <span class="s2">&quot;c-41&quot;</span><span class="p">,</span> <span class="s2">&quot;c-42&quot;</span><span class="p">,</span> <span class="s2">&quot;c-43&quot;</span><span class="p">,</span> <span class="s2">&quot;c-44&quot;</span><span class="p">,</span> <span class="s2">&quot;c-45&quot;</span><span class="p">,</span> <span class="s2">&quot;c-46&quot;</span><span class="p">,</span> <span class="s2">&quot;c-47&quot;</span><span class="p">,</span> <span class="s2">&quot;c-48&quot;</span><span class="p">,</span> <span class="s2">&quot;c-49&quot;</span><span class="p">,</span> <span class="s2">&quot;c-50&quot;</span><span class="p">,</span> <span class="s2">&quot;c-51&quot;</span><span class="p">,</span> <span class="s2">&quot;c-52&quot;</span><span class="p">,</span> <span class="s2">&quot;c-53&quot;</span><span class="p">,</span> <span class="s2">&quot;c-54&quot;</span><span class="p">,</span> <span class="s2">&quot;c-55&quot;</span><span class="p">,</span> <span class="s2">&quot;c-56&quot;</span><span class="p">,</span> <span class="s2">&quot;c-57&quot;</span><span class="p">,</span> <span class="s2">&quot;c-58&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;c-59&quot;</span><span class="p">,</span> <span class="s2">&quot;c-60&quot;</span><span class="p">,</span> <span class="s2">&quot;c-61&quot;</span><span class="p">,</span> <span class="s2">&quot;c-62&quot;</span><span class="p">,</span> <span class="s2">&quot;c-63&quot;</span><span class="p">,</span> <span class="s2">&quot;c-64&quot;</span><span class="p">,</span> <span class="s2">&quot;c-65&quot;</span><span class="p">,</span> <span class="s2">&quot;c-66&quot;</span><span class="p">,</span> <span class="s2">&quot;c-67&quot;</span><span class="p">,</span> <span class="s2">&quot;c-68&quot;</span><span class="p">,</span> <span class="s2">&quot;c-69&quot;</span><span class="p">,</span> <span class="s2">&quot;c-70&quot;</span><span class="p">,</span> <span class="s2">&quot;c-71&quot;</span><span class="p">,</span> <span class="s2">&quot;c-72&quot;</span><span class="p">,</span> <span class="s2">&quot;c-73&quot;</span><span class="p">,</span> <span class="s2">&quot;c-74&quot;</span><span class="p">,</span> <span class="s2">&quot;c-75&quot;</span><span class="p">,</span> <span class="s2">&quot;c-76&quot;</span><span class="p">,</span> <span class="s2">&quot;c-77&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;c-78&quot;</span><span class="p">,</span> <span class="s2">&quot;c-79&quot;</span><span class="p">,</span> <span class="s2">&quot;c-80&quot;</span><span class="p">,</span> <span class="s2">&quot;c-81&quot;</span><span class="p">,</span> <span class="s2">&quot;c-82&quot;</span><span class="p">,</span> <span class="s2">&quot;c-83&quot;</span><span class="p">,</span> <span class="s2">&quot;c-84&quot;</span><span class="p">,</span> <span class="s2">&quot;c-85&quot;</span><span class="p">,</span> <span class="s2">&quot;c-86&quot;</span><span class="p">,</span> <span class="s2">&quot;c-87&quot;</span><span class="p">,</span> <span class="s2">&quot;c-88&quot;</span><span class="p">,</span> <span class="s2">&quot;c-89&quot;</span><span class="p">,</span> <span class="s2">&quot;c-90&quot;</span><span class="p">,</span> <span class="s2">&quot;c-91&quot;</span><span class="p">,</span> <span class="s2">&quot;c-92&quot;</span><span class="p">,</span> <span class="s2">&quot;c-93&quot;</span><span class="p">,</span> <span class="s2">&quot;c-94&quot;</span><span class="p">,</span> <span class="s2">&quot;c-95&quot;</span><span class="p">,</span> <span class="s2">&quot;c-96&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;c-97&quot;</span><span class="p">,</span> <span class="s2">&quot;c-98&quot;</span><span class="p">,</span> <span class="s2">&quot;c-99&quot;</span><span class="p">]</span>


<span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../input/lish-moa/train_features.csv&#39;</span><span class="p">)</span>
<span class="n">train_targets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../input/lish-moa/train_targets_scored.csv&#39;</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../input/lish-moa/test_features.csv&#39;</span><span class="p">)</span>
<span class="n">sample_submission</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../input/lish-moa/sample_submission.csv&#39;</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">mapping_and_filter</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">fe_stats</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">c_squared</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">fe_pca</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">n_components_g</span> <span class="o">=</span> <span class="mi">70</span><span class="p">,</span> <span class="n">n_components_c</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">SEED</span> <span class="o">=</span> <span class="mi">123</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">features</span> <span class="o">=</span> <span class="n">scaling</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span>

<span class="c1"># Inference time</span>
<span class="n">test_pred_5l</span><span class="p">,</span> <span class="n">oof_pred_5l</span> <span class="o">=</span> <span class="n">run_multiple_seeds</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">start_predictors</span><span class="p">,</span> <span class="n">SEEDS</span> <span class="o">=</span> <span class="n">SEEDS1</span><span class="p">,</span> <span class="n">MODEL</span> <span class="o">=</span> <span class="s1">&#39;5l&#39;</span><span class="p">,</span> <span class="n">PATH</span> <span class="o">=</span> <span class="s1">&#39;../input/moaaaaa/5l&#39;</span><span class="p">)</span>
<span class="n">test_pred_4l</span><span class="p">,</span> <span class="n">oof_pred_4l</span> <span class="o">=</span> <span class="n">run_multiple_seeds</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">start_predictors</span><span class="p">,</span> <span class="n">SEEDS</span> <span class="o">=</span> <span class="n">SEEDS2</span><span class="p">,</span> <span class="n">MODEL</span> <span class="o">=</span> <span class="s1">&#39;4l&#39;</span><span class="p">,</span> <span class="n">PATH</span> <span class="o">=</span> <span class="s1">&#39;../input/moaaaaa/4l&#39;</span><span class="p">)</span>
<span class="n">test_pred_3l</span><span class="p">,</span> <span class="n">oof_pred_3l</span> <span class="o">=</span> <span class="n">run_multiple_seeds</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">start_predictors</span><span class="p">,</span> <span class="n">SEEDS</span> <span class="o">=</span> <span class="n">SEEDS3</span><span class="p">,</span> <span class="n">MODEL</span> <span class="o">=</span> <span class="s1">&#39;3l&#39;</span><span class="p">,</span> <span class="n">PATH</span> <span class="o">=</span> <span class="s1">&#39;../input/moaaaaa/3l&#39;</span><span class="p">)</span>
<span class="n">test_pred_2l</span><span class="p">,</span> <span class="n">oof_pred_2l</span> <span class="o">=</span> <span class="n">run_multiple_seeds</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">start_predictors</span><span class="p">,</span> <span class="n">SEEDS</span> <span class="o">=</span> <span class="n">SEEDS4</span><span class="p">,</span> <span class="n">MODEL</span> <span class="o">=</span> <span class="s1">&#39;2l&#39;</span><span class="p">,</span> <span class="n">PATH</span> <span class="o">=</span> <span class="s1">&#39;../input/moaaaaa/2l&#39;</span><span class="p">)</span>
<span class="n">test_pred_rs</span><span class="p">,</span> <span class="n">oof_pred_rs</span> <span class="o">=</span> <span class="n">run_multiple_seeds</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">start_predictors</span><span class="p">,</span> <span class="n">SEEDS</span> <span class="o">=</span> <span class="n">SEEDS5</span><span class="p">,</span> <span class="n">MODEL</span> <span class="o">=</span> <span class="s1">&#39;rs&#39;</span><span class="p">,</span> <span class="n">PATH</span> <span class="o">=</span> <span class="s1">&#39;../input/moaaaaa/rs&#39;</span><span class="p">)</span>

<span class="c1"># Blend 5l, 4l, 3l and l2 dnn model</span>
<span class="n">oof_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">([</span><span class="n">oof_pred_5l</span><span class="p">,</span> <span class="n">oof_pred_4l</span><span class="p">,</span> <span class="n">oof_pred_3l</span><span class="p">,</span> <span class="n">oof_pred_2l</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">seed_log_loss</span> <span class="o">=</span> <span class="n">mean_log_loss</span><span class="p">(</span><span class="n">train_targets</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">oof_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Our final out of folds log loss for our classic dnn blend is </span><span class="si">{seed_log_loss}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">test_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">([</span><span class="n">test_pred_5l</span><span class="p">,</span> <span class="n">test_pred_4l</span><span class="p">,</span> <span class="n">test_pred_3l</span><span class="p">,</span> <span class="n">test_pred_2l</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Blend the result of the previous model with the dnn resnet type model</span>
<span class="n">oof_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">([</span><span class="n">oof_pred</span><span class="p">,</span> <span class="n">oof_pred_rs</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">seed_log_loss</span> <span class="o">=</span> <span class="n">mean_log_loss</span><span class="p">(</span><span class="n">train_targets</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">oof_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Our final out of folds log loss for our classic dnn + dnn resnet type model is </span><span class="si">{seed_log_loss}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">test_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">([</span><span class="n">test_pred</span><span class="p">,</span> <span class="n">test_pred_rs</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">sample_submission</span> <span class="o">=</span> <span class="n">submission</span><span class="p">(</span><span class="n">test_pred</span><span class="p">)</span>
<span class="n">sample_submission</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Using model 5l with seed 1 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.016378453981865597
--------------------------------------------------


Using model 5l with seed 2 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.01631455428742839
--------------------------------------------------


Using model 5l with seed 3 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.016383751293509698
--------------------------------------------------


Using model 5l with seed 4 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.016341391051434243
--------------------------------------------------


Using model 5l with seed 5 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.016335041319008474
--------------------------------------------------


Using model 5l with seed 6 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.01636065036790702
--------------------------------------------------


Using model 5l with seed 7 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.016313685032813025
--------------------------------------------------


Our out of folds log loss for our seed blend model is 0.016125606426116032
Using model 4l with seed 8 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.016257830919981394
--------------------------------------------------


Using model 4l with seed 9 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.0162738240727892
--------------------------------------------------


Using model 4l with seed 10 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.016283372931380973
--------------------------------------------------


Using model 4l with seed 11 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.01623109271099229
--------------------------------------------------


Using model 4l with seed 12 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.016254047439907306
--------------------------------------------------


Using model 4l with seed 13 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.016259025411483292
--------------------------------------------------


Using model 4l with seed 14 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.01623629563259146
--------------------------------------------------


Our out of folds log loss for our seed blend model is 0.01602095842123251
Using model 3l with seed 15 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.016205592033639644
--------------------------------------------------


Using model 3l with seed 16 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.016202519834006
--------------------------------------------------


Using model 3l with seed 17 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.016259370523701272
--------------------------------------------------


Using model 3l with seed 18 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.01621977108628496
--------------------------------------------------


Using model 3l with seed 19 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.01619816365082065
--------------------------------------------------


Using model 3l with seed 20 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.016175355719947625
--------------------------------------------------


Using model 3l with seed 21 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.016192119210498814
--------------------------------------------------


Our out of folds log loss for our seed blend model is 0.015873577849255218
Using model 2l with seed 22 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.016291559403368426
--------------------------------------------------


Using model 2l with seed 23 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.01630617004629646
--------------------------------------------------


Using model 2l with seed 24 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.01630552188067495
--------------------------------------------------


Using model 2l with seed 25 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.016317292444749325
--------------------------------------------------


Using model 2l with seed 26 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.01635457535628412
--------------------------------------------------


Using model 2l with seed 27 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.016279641173142623
--------------------------------------------------


Using model 2l with seed 28 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.016340157050879132
--------------------------------------------------


Our out of folds log loss for our seed blend model is 0.01613088113496503
Using model rs with seed 29 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.01744900179150992
--------------------------------------------------


Using model rs with seed 30 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.017439107873638532
--------------------------------------------------


Using model rs with seed 31 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.017374488063640354
--------------------------------------------------


Using model rs with seed 32 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.017427090306136577
--------------------------------------------------


Using model rs with seed 33 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.017379939326643865
--------------------------------------------------


Using model rs with seed 34 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.01745466219257567
--------------------------------------------------


Using model rs with seed 35 for inference
Trained with 1069 features
Our out of folds mean log loss score is 0.01749222032394513
--------------------------------------------------


Our out of folds log loss for our seed blend model is 0.016069716082359877
Our final out of folds log loss for our classic dnn blend is 0.015907055605443435
Our final out of folds log loss for our classic dnn + dnn resnet type model is 0.015692726167881827
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[68]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sig_id</th>
      <th>5-alpha_reductase_inhibitor</th>
      <th>11-beta-hsd1_inhibitor</th>
      <th>acat_inhibitor</th>
      <th>acetylcholine_receptor_agonist</th>
      <th>acetylcholine_receptor_antagonist</th>
      <th>acetylcholinesterase_inhibitor</th>
      <th>adenosine_receptor_agonist</th>
      <th>adenosine_receptor_antagonist</th>
      <th>adenylyl_cyclase_activator</th>
      <th>...</th>
      <th>tropomyosin_receptor_kinase_inhibitor</th>
      <th>trpv_agonist</th>
      <th>trpv_antagonist</th>
      <th>tubulin_inhibitor</th>
      <th>tyrosine_kinase_inhibitor</th>
      <th>ubiquitin_specific_protease_inhibitor</th>
      <th>vegfr_inhibitor</th>
      <th>vitamin_b</th>
      <th>vitamin_d_receptor_agonist</th>
      <th>wnt_inhibitor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id_0004d9e33</td>
      <td>0.001513</td>
      <td>0.001859</td>
      <td>0.002279</td>
      <td>0.020404</td>
      <td>0.017999</td>
      <td>0.004055</td>
      <td>0.002006</td>
      <td>0.005719</td>
      <td>0.000484</td>
      <td>...</td>
      <td>0.001485</td>
      <td>0.002162</td>
      <td>0.003885</td>
      <td>0.001054</td>
      <td>0.000431</td>
      <td>0.001170</td>
      <td>0.001395</td>
      <td>0.002437</td>
      <td>0.008220</td>
      <td>0.001906</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id_001897cda</td>
      <td>0.000343</td>
      <td>0.001332</td>
      <td>0.001724</td>
      <td>0.002167</td>
      <td>0.001375</td>
      <td>0.002855</td>
      <td>0.003778</td>
      <td>0.014143</td>
      <td>0.013055</td>
      <td>...</td>
      <td>0.001303</td>
      <td>0.000995</td>
      <td>0.005281</td>
      <td>0.000225</td>
      <td>0.005571</td>
      <td>0.000927</td>
      <td>0.001977</td>
      <td>0.000904</td>
      <td>0.004554</td>
      <td>0.005297</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id_002429b5b</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id_00276f245</td>
      <td>0.000949</td>
      <td>0.001028</td>
      <td>0.002463</td>
      <td>0.008348</td>
      <td>0.006329</td>
      <td>0.005210</td>
      <td>0.002541</td>
      <td>0.003042</td>
      <td>0.000664</td>
      <td>...</td>
      <td>0.000994</td>
      <td>0.000965</td>
      <td>0.003685</td>
      <td>0.019604</td>
      <td>0.007750</td>
      <td>0.000900</td>
      <td>0.001477</td>
      <td>0.002290</td>
      <td>0.001451</td>
      <td>0.004724</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id_0027f1083</td>
      <td>0.003512</td>
      <td>0.002060</td>
      <td>0.003531</td>
      <td>0.015215</td>
      <td>0.022168</td>
      <td>0.002367</td>
      <td>0.007736</td>
      <td>0.001748</td>
      <td>0.000734</td>
      <td>...</td>
      <td>0.001362</td>
      <td>0.000953</td>
      <td>0.007327</td>
      <td>0.002477</td>
      <td>0.001147</td>
      <td>0.001372</td>
      <td>0.003400</td>
      <td>0.002625</td>
      <td>0.000365</td>
      <td>0.001481</td>
    </tr>
  </tbody>
</table>
<p>5 rows  207 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[69]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sub3</span>  <span class="o">=</span> <span class="n">sample_submission</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[70]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">submission</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/kaggle/input/lish-moa/sample_submission.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The result shows that,</p>
<ul>
<li>Our out of folds log loss for our seed blend model is 0.016069716082359877</li>
<li>Our final out of folds log loss for our classic dnn blend is 0.015907055605443435</li>
<li>Our final out of folds log loss for our classic dnn + dnn resnet type model is 0.015692726167881827</li>
</ul>
<p>This is the best one among three models.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[71]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">public_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">submission</span><span class="p">[</span><span class="s1">&#39;sig_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">submission</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[71]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(3982, 207)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[72]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/kaggle/input/lish-moa/test_features.csv&#39;</span><span class="p">)</span>

<span class="n">test_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;sig_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">private_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">test_ids</span><span class="p">)</span><span class="o">-</span><span class="nb">set</span><span class="p">(</span><span class="n">public_ids</span><span class="p">))</span>

<span class="nb">len</span><span class="p">(</span><span class="n">private_ids</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[72]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[73]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predictions</span> <span class="o">=</span> <span class="p">[</span><span class="n">sub3</span><span class="p">,</span><span class="n">sub2</span><span class="p">,</span><span class="n">sub1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[74]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">target_columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">submission</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">target_columns</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;sig_id&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[75]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">y_pred</span><span class="p">[</span><span class="s1">&#39;sig_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;sig_id&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">target_columns</span><span class="p">:</span>
    <span class="n">column_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">)):</span>
        <span class="n">column_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">column</span><span class="p">])</span>
    <span class="n">y_pred</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">column_data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[75]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(3982, 207)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[76]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3345993850605896</span><span class="p">,</span> <span class="mf">0.33387592693072893</span><span class="p">,</span> <span class="mf">0.3315246880086815</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[77]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">weighted_y_pred</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">weighted_y_pred</span><span class="p">[</span><span class="s1">&#39;sig_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;sig_id&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">target_columns</span><span class="p">:</span>
    <span class="n">column_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">)):</span>
        <span class="n">column_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">column</span><span class="p">]</span> <span class="o">*</span> <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">weighted_y_pred</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">column_data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">weighted_y_pred</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[77]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(3982, 207)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[78]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">weighted_y_pred</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[79]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">submission</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="n">public_ids</span> <span class="o">+</span> <span class="n">private_ids</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">target_columns</span><span class="p">)</span>
<span class="n">submission</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;sig_id&#39;</span>

<span class="n">submission</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">submission</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">y_pred</span><span class="o">.</span><span class="n">sig_id</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">y_pred</span><span class="p">[</span><span class="n">target_columns</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">submission</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test</span><span class="p">[</span><span class="n">test</span><span class="o">.</span><span class="n">cp_type</span> <span class="o">==</span> <span class="s1">&#39;ctl_vehicle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sig_id</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">submission</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;submission.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
    </div>
  </div>
</body>

 


</html>
